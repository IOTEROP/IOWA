
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="images/iowa_logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.4">
    
    
      
        <title>Printable version - IOWA Reference</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2a4617e2.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/print-site.css">
    
      <link rel="stylesheet" href="css/print-site-material.css">
    
      <link rel="stylesheet" href="ioterop.css">
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"/":"/"),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      

    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="IOWA Reference" class="md-header__button md-logo" aria-label="IOWA Reference" data-md-component="logo">
      
  <img src="images/iowa_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IOWA Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Printable version
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="index.html" class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="Changelog.html" class="md-tabs__link">
      Changelog
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="LwM2MOverview.html" class="md-tabs__link">
        User Manual
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="baseline_client.html" class="md-tabs__link">
        Samples
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="AbstractionLayer.html" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="License.html" class="md-tabs__link">
        Licenses
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="print_page.html" class="md-tabs__link">
      Printable version
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="IOWA Reference" class="md-nav__button md-logo" aria-label="IOWA Reference" data-md-component="logo">
      
  <img src="images/iowa_logo.png" alt="logo">

    </a>
    IOWA Reference
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Changelog.html" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          User Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Manual" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          User Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="LwM2MOverview.html" class="md-nav__link">
        LwM2M Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Building.html" class="md-nav__link">
        Building Samples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Configuration.html" class="md-nav__link">
        IOWA Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Security.html" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multithread.html" class="md-nav__link">
        Multithread
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bootstrap.html" class="md-nav__link">
        Bootstrap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="DeviceUpdate.html" class="md-nav__link">
        Device Update
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CustomObject.html" class="md-nav__link">
        Custom Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Streamable.html" class="md-nav__link">
        Streamable Resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ApplicationStorage.html" class="md-nav__link">
        Application Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Network.html" class="md-nav__link">
        Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Porting.html" class="md-nav__link">
        Porting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="LoRaWAN.html" class="md-nav__link">
        LoRaWAN
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_14" type="checkbox" id="__nav_3_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_14">
          Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_14">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Object_Skeleton_Generator.html" class="md-nav__link">
        Object Skeleton Generator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Samples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Samples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Samples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="baseline_client.html" class="md-nav__link">
        LwM2M Client Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          LwM2M Objects Samples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LwM2M Objects Samples" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          LwM2M Objects Samples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="IPSO_client.html" class="md-nav__link">
        IPSO Object Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="bearer_selection_client.html" class="md-nav__link">
        Bearer Selection Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="mqtt_objects_client.html" class="md-nav__link">
        MQTT Objects
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          LwM2M Custom Objects Samples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LwM2M Custom Objects Samples" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          LwM2M Custom Objects Samples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_object_baseline.html" class="md-nav__link">
        Custom Object Basseline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_object_dynamic.html" class="md-nav__link">
        Dynamic Custom Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_object_multiple_instances.html" class="md-nav__link">
        Multiple Instance Custom Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_object_multiple_resource_instances.html" class="md-nav__link">
        Multiple Resource Custom Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="streamable_resource_client.html" class="md-nav__link">
        Streamable Resources Client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Firmware Update Samples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Firmware Update Samples" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Firmware Update Samples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fw_update_push_client.html" class="md-nav__link">
        Firmware Update Client "Push" Method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fw_update_pull_client.html" class="md-nav__link">
        Firmware Update Client "Pull" Method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fw_coap_download_client.html" class="md-nav__link">
        Firmware Update Client with CoAP Download
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fw_coap_block_client.html" class="md-nav__link">
        Firmware Update Client with CoAP Block-Wise Transfer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          LwM2M Advanced Client Samples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LwM2M Advanced Client Samples" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          LwM2M Advanced Client Samples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="secure_client_mbedtls3.html" class="md-nav__link">
        Secure Client with Mbed TLS 3.1.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="secure_client_mbedtls2.html" class="md-nav__link">
        Secure Client with Mbed TLS 2.28.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="secure_client_tinydtls.html" class="md-nav__link">
        Secure Client with tinydtls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="bootstrap_client.html" class="md-nav__link">
        Bootstrap Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="multithread_IPSO_client.html" class="md-nav__link">
        Multithreaded Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="device_info_client.html" class="md-nav__link">
        Device Info Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="websockets_client.html" class="md-nav__link">
        WebSocket Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="context_storage_client.html" class="md-nav__link">
        Context Storage Client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="baseline_server.html" class="md-nav__link">
        LwM2M Server Basics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="AbstractionLayer.html" class="md-nav__link">
        System Abstraction Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CommonAPI.html" class="md-nav__link">
        Common APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ClientAPI.html" class="md-nav__link">
        Client APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Empty.html" class="md-nav__link">
        Objects APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ServerAPI.html" class="md-nav__link">
        Server APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="BootstrapServerAPI.html" class="md-nav__link">
        Bootstrap Server APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CoapAPI.html" class="md-nav__link">
        CoAP APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="UtilsAPI.html" class="md-nav__link">
        Utils APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="SecurityAPI.html" class="md-nav__link">
        Security Implementation APIs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Licenses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Licenses" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Licenses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="License.html" class="md-nav__link">
        IOWA License
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="OpenSourceLicenses.html" class="md-nav__link">
        OpenSource Licenses
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Printable version
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="print_page.html" class="md-nav__link md-nav__link--active">
        Printable version
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    Changelog
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-user-manual" class="md-nav__link">
    User Manual
  </a>
  
    <nav class="md-nav" aria-label="User Manual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lwm2moverview" class="md-nav__link">
    LwM2M Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building" class="md-nav__link">
    Building Samples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    IOWA Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multithread" class="md-nav__link">
    Multithread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrap" class="md-nav__link">
    Bootstrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deviceupdate" class="md-nav__link">
    Device Update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customobject" class="md-nav__link">
    Custom Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamable" class="md-nav__link">
    Streamable Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applicationstorage" class="md-nav__link">
    Application Storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network" class="md-nav__link">
    Network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#porting" class="md-nav__link">
    Porting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lorawan" class="md-nav__link">
    LoRaWAN
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-samples" class="md-nav__link">
    Samples
  </a>
  
    <nav class="md-nav" aria-label="Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#baseline_client" class="md-nav__link">
    LwM2M Client Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#baseline_server" class="md-nav__link">
    LwM2M Server Basics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-api-reference" class="md-nav__link">
    API Reference
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstractionlayer" class="md-nav__link">
    System Abstraction Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commonapi" class="md-nav__link">
    Common APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clientapi" class="md-nav__link">
    Client APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty" class="md-nav__link">
    Objects APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serverapi" class="md-nav__link">
    Server APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrapserverapi" class="md-nav__link">
    Bootstrap Server APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coapapi" class="md-nav__link">
    CoAP APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilsapi" class="md-nav__link">
    Utils APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securityapi" class="md-nav__link">
    Security Implementation APIs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-licenses" class="md-nav__link">
    Licenses
  </a>
  
    <nav class="md-nav" aria-label="Licenses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    IOWA License
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensourcelicenses" class="md-nav__link">
    OpenSource Licenses
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    Changelog
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-user-manual" class="md-nav__link">
    User Manual
  </a>
  
    <nav class="md-nav" aria-label="User Manual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lwm2moverview" class="md-nav__link">
    LwM2M Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building" class="md-nav__link">
    Building Samples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    IOWA Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multithread" class="md-nav__link">
    Multithread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrap" class="md-nav__link">
    Bootstrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deviceupdate" class="md-nav__link">
    Device Update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customobject" class="md-nav__link">
    Custom Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streamable" class="md-nav__link">
    Streamable Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applicationstorage" class="md-nav__link">
    Application Storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network" class="md-nav__link">
    Network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#porting" class="md-nav__link">
    Porting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lorawan" class="md-nav__link">
    LoRaWAN
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-samples" class="md-nav__link">
    Samples
  </a>
  
    <nav class="md-nav" aria-label="Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#baseline_client" class="md-nav__link">
    LwM2M Client Basics
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#baseline_server" class="md-nav__link">
    LwM2M Server Basics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-api-reference" class="md-nav__link">
    API Reference
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstractionlayer" class="md-nav__link">
    System Abstraction Layer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commonapi" class="md-nav__link">
    Common APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clientapi" class="md-nav__link">
    Client APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty" class="md-nav__link">
    Objects APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serverapi" class="md-nav__link">
    Server APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrapserverapi" class="md-nav__link">
    Bootstrap Server APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coapapi" class="md-nav__link">
    CoAP APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilsapi" class="md-nav__link">
    Utils APIs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securityapi" class="md-nav__link">
    Security Implementation APIs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-licenses" class="md-nav__link">
    Licenses
  </a>
  
    <nav class="md-nav" aria-label="Licenses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    IOWA License
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensourcelicenses" class="md-nav__link">
    OpenSource Licenses
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              




                

<div id="print-site-page" class="print-site-enumerate-headings">
        <section id="print-site-cover-page">
            
<div>

    
        <h1>IOWA Reference</h1>
    

</div>


<table>

    

    

    

    
    <tr>
        <td>Copyright</td>
        <td>Copyright &copy; 2020-2022 IoTerop</td>
    </tr>
    

</table>





        </section>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="5">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><p><img alt="IOWA" src="images/iowa_logo.png#center" /></p>
<p style="text-align:center"><b>2022-05-Eval</b></p>

<p style="text-align:center">BY</p>

<p><img alt="IoTerop" src="images/ioterop_logo.png#center" /></p></section><section class="print-page" id="changelog"><h1 id="changelog-changelog">Changelog</h1>
<h2 id="changelog-2022-05">2022-05</h2>
<blockquote>
<p>This is a Long-Term Support release.</p>
<p><strong>Upcoming Breaking Change</strong></p>
<p>With the next release of IOWA, the configuration flags <a href="#configuration-IOWA_SECURITY_LAYER"><strong>IOWA_SECURITY_LAYER_TINYDTLS</strong></a>, <a href="#configuration-IOWA_SECURITY_LAYER"><strong>IOWA_SECURITY_LAYER_MBEDTLS</strong></a>, <a href="#configuration-IOWA_SECURITY_LAYER"><strong>IOWA_SECURITY_LAYER_MBEDTLS_PSK_ONLY</strong></a>, <a href="#configuration-IOWA_SECURITY_LAYER"><strong>IOWA_SECURITY_LAYER_MBEDTLS_OSCORE_ONLY</strong></a> will be deprecated. The configuration flag <a href="#configuration-IOWA_SECURITY_LAYER"><strong>IOWA_SECURITY_LAYER_USER</strong></a> will be the default.</p>
<p>The samples <a href="#secure_client_mbedtls3">secure_client_mbedtls3</a>, <a href="#secure_client_mbedtls2">secure_client_mbedtls2</a>, and <a href="#secure_client_tinydtls">secure_client_tinydtls</a> provides a feature equivalent integration with Mbed TLS and tinydtls. They also serve as a basis for integration with other TLS/DTLS libraries.</p>
</blockquote>
<p><strong>New Features</strong></p>
<ul>
<li>It is now possible to set the access rights of a LwM2M Server to all known Objects at once by calling <a href="#clientapi-iowa_client_acl_rights_server_set"><code>iowa_client_acl_rights_server_set()</code></a> with <strong>IOWA_LWM2M_ID_ALL</strong> as the Object ID.</li>
<li>Add a new API <a href="#clientapi-iowa_client_get_server_configuration"><code>iowa_client_get_server_configuration()</code></a> to retrieve a LwM2M Server setting.</li>
<li>More LwM2M Server settings are accessible, including the CoAP retransmission parameters. See <a href="#clientapi-iowa_server_setting_id_t"><code>iowa_server_setting_id_t</code></a>.</li>
<li>IOWA generates new events of type <strong>IOWA_EVENT_SERVER_SETTING_CHANGED</strong> when a LwM2M Server setting is modified by a LwM2M operation on the LwM2M Server Object. See <a href="#clientapi-iowa_event_t"><code>iowa_event_t</code></a>.</li>
<li>The provided implementations of the Location Object (ID: 6) and the IPSO Location Object (ID: 3336) have new APIs <a href="#objectlocation.md-iowa_client_location_update_with_time"><code>iowa_client_location_update_with_time()</code></a>, <a href="#objectlocation.md-iowa_client_location_update_full_with_time"><code>iowa_client_location_update_full_with_time()</code></a>, <a href="#objectgps.md-iowa_client_gps_update_location_with_time"><code>iowa_client_gps_update_location_with_time()</code></a>, and <a href="#objectgps.md-iowa_client_gps_update_location_full_with_time"><code>iowa_client_gps_update_location_full_with_time()</code></a> allowing the caller to specify the measurement timestamp.</li>
<li>Add a new API <a href="#coapapi-iowa_coap_peer_proxied_get">`iowa_coap_peer_proxied_get()</a> to perform a GET through a forward-proxy.</li>
</ul>
<p><strong>Breaking Change</strong></p>
<ul>
<li>The value <strong>IOWA_IPSO_LEVEL_CONTROL</strong> is no longer part of the enumeration <a href="#clientapi-iowa_ipso_id_t"><code>iowa_IPSO_ID_t</code></a>. To manipulate an IPSO level sensor, please use the <a href="#objectdimmer.md">IPSO Dimmer Object APIs</a>. Note that the IPSO Level Control Object was renamed "Dimmer" in the <a href="https://technical.openmobilealliance.org/OMNA/LwM2M/LwM2MRegistry.html">LwM2M Registry</a>.</li>
</ul>
<p><strong>Behavior Changes</strong></p>
<ul>
<li>When a Response is bigger than the connection MTU, and <a href="#configuration-additional-flags"><strong>IOWA_COAP_BLOCK_SUPPORT</strong></a> is defined, IOWA will now return the first block of the response instead of returning a 4.13 (Request Entity Too Large) code.</li>
<li>The <a href="#clientapi-iowa_server_info_t"><code>iowa_server_info_t</code></a> structure now contains the LwM2M protocol version used by the LwM2M Server.</li>
</ul>
<p><strong>SDK Changes</strong></p>
<ul>
<li>Some internal functions were renamed to avoid conflicts.</li>
<li>Add three new samples illustrating how to integrate with a DTLS/TLS security library, one using <a href="#secure_client_mbedtls3">Mbed TLS 3.1</a>, one using <a href="#secure_client_mbedtls2">Mbed TLS 2.28</a>, and one using <a href="#secure_client_tinydtls">tinydtls</a>.</li>
<li>The sample <a href="#custom_object_multiple_instances">custom_object_multiple_instances</a>, illustrating how to manage multiple instances of a custom LwM2M Object, was simplified and documented. </li>
</ul>
<p><strong>Bug Fixes</strong></p>
<ul>
<li>Fix a bug where corrupted data retrieved from the notification storage queues may lead to out-of-range memory accesses or value underflows.</li>
<li>Fix a bug where a Notification bigger than the connection MTU was not correctly sent as the first block of a CoAP Block-Transfer.</li>
<li>Fix a potential crash when handling a Observation on a multiple resource with no instance in Clients with no support of the Observe-Composite operation.</li>
<li>Fix a bug where IOWA was returning an error to the LwM2M Server cancelling the Firmware Update process. The Firmware Update process was however cancelled correctly.</li>
<li>Fix a bug where a Server lifetime or binding modified by calling <a href="#clientapi-iowa_client_set_server_configuration"><code>iowa_client_set_server_configuration()</code></a> was not automatically saved when <a href="#configuration-iowa_storage_context_automatic_backup"><strong>IOWA_STORAGE_CONTEXT_AUTOMATIC_BACKUP</strong></a> is defined.</li>
<li>Fix a bug where the Access Control List Object Instances where not correctly restored when loading a context. The saved access control rights were however still enforced.</li>
</ul></section>
                        <h1 class='nav-section-title' id='section-user-manual'>
                            User Manual <a class='headerlink' href='#section-user-manual' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="lwm2moverview"><h1 id="lwm2moverview-lwm2m-overview">LwM2M Overview</h1>
<p>The Lightweight Machine To Machine designed by the Open Mobile Alliance is a device management protocol for the Internet of Things (IoT).</p>
<h2 id="lwm2moverview-lwm2m-concepts">LwM2M Concepts</h2>
<h3 id="lwm2moverview-lwm2m-clientdevice">LwM2M Client/Device</h3>
<p>The LwM2M Client/Device is the entity being managed by the LwM2M Server. The LwM2M Client presents resources for the LwM2M Server to manipulate.</p>
<h3 id="lwm2moverview-lwm2m-server">LwM2M Server</h3>
<p>The LwM2M Server is the entity managing the LwM2M Devices. It can Read, Write, Execute, Create or Delete the Devices resources.</p>
<p>The LwM2M Server URI can have one of the following formats:</p>
<ul>
<li>"coap://{hostname}[:{port}]" for unsecure UDP transport</li>
<li>"coaps://{hostname}[:{port}]" for secure UDP transport (using DTLS)</li>
<li>"coap+tcp://{hostname}[:{port}]" for unsecure TCP transport</li>
<li>"coaps+tcp://{hostname}[:{port}]" for secure TCP transport (using TLS)</li>
<li>"sms://{msisdn number}" for SMS binding in binary mode</li>
<li>"lorawan://{FPort}" for LoRaWAN binding with FPort between 1 and 255</li>
</ul>
<p>For UDP and TCP transports, if <em>{port}</em> is not present, the default port is used:</p>
<ul>
<li><em>5683</em> for communication without security</li>
<li><em>5684</em> for secure communication</li>
</ul>
<h3 id="lwm2moverview-lwm2m-bootstrap-server">LwM2M Bootstrap Server</h3>
<p>The LwM2M Bootstrap Server is a special <a href="#lwm2moverview-lwm2m-server">LwM2M Server</a>. It is the only Server allowed to provision or delete Server Accounts on the LwM2M Devices. It can Read (LwM2M 1.1), Write, Create and Delete the Devices resources.</p>
<h3 id="lwm2moverview-lwm2m-endpoint-name">LwM2M Endpoint Name</h3>
<p>The endpoint name is the name presented by the LwM2M Client to the LwM2M Servers. A LwM2M Server or a LwM2M Bootstrap Server must be able to uniquely identify the LwM2M Client using this endpoint name. One possibility is to use an standard URN like:</p>
<ul>
<li>3GPP Mobile Equipment Identity (<a href="https://tools.ietf.org/html/rfc8464">RFC 8464</a>):
  <code>urn:3gpp2:meid:&lt;Manufacturer Code&gt;-&lt;Serial Number&gt;</code></li>
<li>GSMA International Mobile station Equipment Identity (<a href="https://tools.ietf.org/html/rfc7274">RFC 7274</a>):
  <code>urn:gsma:imei:&lt;Type Approval Code&gt;-&lt;Serial Number&gt;-&lt;Spare&gt;</code></li>
<li>Universally Unique Identifier (<a href="https://tools.ietf.org/html/rfc4122">RFC 4122</a>):
  <code>urn:uuid:&lt;UUID&gt;</code></li>
<li>MAC address (<a href="https://tools.ietf.org/html/rfc9039">RFC 9039</a>):
  <code>urn:dev:mac:&lt;EUI-64&gt;</code></li>
<li>Organization specific identifier (<a href="https://tools.ietf.org/html/rfc9039">RFC 9039</a>):
  <code>urn:dev:org:&lt;Enterprise Number&gt;-&lt;Anything&gt;</code></li>
<li>Organization serial number (<a href="https://tools.ietf.org/html/rfc9039">RFC 9039</a>):
  <code>urn:dev:os:&lt;Enterprise Number&gt;-&lt;Serial Number&gt;</code></li>
<li>Organization product and serial number (<a href="https://tools.ietf.org/html/rfc9039">RFC 9039</a>):
  <code>urn:dev:ops:&lt;Enterprise Number&gt;-&lt;Product Class&gt;-&lt;Serial Number&gt;</code></li>
</ul>
<h3 id="lwm2moverview-lwm2m-resource">LwM2M Resource</h3>
<p>A LwM2M Resource is a data item presented by the LwM2M Device. A resource has a data type, a list of allowed operations and a unique URI.</p>
<p>Data types are defined in Lightweight M2M as follows:</p>
<ul>
<li>signed integer,</li>
<li>unsigned integer,</li>
<li>float,</li>
<li>boolean,</li>
<li>UTF-8 string,</li>
<li>core link string,</li>
<li>opaque binary,</li>
<li>Unix time,</li>
<li>reference to a LwM2M Object.</li>
</ul>
<p>A resource can also be an array of the mentioned data types.</p>
<p>Operations on resources are Read, Write and Execute.</p>
<h3 id="lwm2moverview-lwm2m-objects">LwM2M Objects</h3>
<p>The LwM2M Objects are a group of Device resources essential for some Device features such as firmware update, connectivity monitoring, physical sensor, etc. Standardized LwM2M Objects contain mandatory resources to support and optional resources to implement.</p>
<p>A LwM2M Device can have several instances of the same LwM2M Object.</p>
<p>All the Device resources are part of a LwM2M Object.</p>
<h3 id="lwm2moverview-lwm2m-object-instance">LwM2M Object Instance</h3>
<p>Some LwM2M Objects are defined as multi-instance objects, meaning that a LwM2M Device can have several instances of the same LwM2M Object. These instances are identified by a numerical instance ID.</p>
<p>When a LwM2M Object is defined as a single-instance, the instance ID is always 0.</p>
<h3 id="lwm2moverview-lwm2m-uri">LwM2M URI</h3>
<p>Resources and Objects have well-known IDs. The URI to a LwM2M resource is in the form: Object_ID ["/" Object_Instance_ID ["/" Resource_ID ["/" Resource_Instance_ID]]]</p>
<p>An URI can address an object, an object instance, a resource or a resource instance (i.e. an element when the resource is an array).</p>
<h3 id="lwm2moverview-server-account">Server Account</h3>
<p>A Server Account is a set of data enabling a LwM2M Device to connect to a LwM2M Server. It includes the Server URI and the Security Keys to use.</p>
<h3 id="lwm2moverview-bootstrap">Bootstrap</h3>
<p>A Bootstrap is the process by which the Device retrieves the Server Accounts. The information can come from factory settings, a SmartCard, or a LwM2M Bootstrap Server.</p>
<h3 id="lwm2moverview-registration">Registration</h3>
<p>A LwM2M Server can only manage Devices registered with it.</p>
<p>When registering with the Bootstrap Server, the Device communicates only its unique <a href="#lwm2moverview-lwm2m-endpoint-name">endpoint name</a>.</p>
<p>When registering with the LwM2M Server, the Device can communicate:</p>
<ul>
<li>its unique <a href="#lwm2moverview-lwm2m-endpoint-name">endpoint name</a>,</li>
<li>its lifetime,</li>
<li>the list of LwM2M Objects implemented on the Device,</li>
<li>its MSISDN,</li>
<li>whether the Device requires Queue Mode or not.</li>
</ul>
<h3 id="lwm2moverview-observation">Observation</h3>
<p>The LwM2M Server can subscribe to one or several readable Device resources. When the value of the resource changes, the Device sends a Notification message to the Server containing the new value of the resource.</p>
<h3 id="lwm2moverview-lifetime">Lifetime</h3>
<p>The Lifetime is the validity period of a LwM2M Device registration to the LwM2M Server. When this lifetime expires, the Server should no longer try to manage the Device.</p>
<p>The Device sends Registration Update messages to the Server to renew its registration validity period.</p>
<h3 id="lwm2moverview-queue-mode">Queue Mode</h3>
<p>Devices may go in stand-by mode and thus not be reachable by the LwM2M Servers at any time. To cope with this, the Device requests the Server to operate in Queue Mode. In this mode, the Device will initiate the communication with the Server (when sending a Notification or a Registration Update message). In the meantime, the Server is expected to queue its requests (hence the name).</p>
<h3 id="lwm2moverview-sms-trigger">SMS Trigger</h3>
<p>A SMS Trigger is a special SMS sent to the Device. Upon reception of this SMS, the Device will either register to the Server or send a Registration Update message.</p>
<h2 id="lwm2moverview-lwm2m-operations-overview">LwM2M Operations Overview</h2>
<h3 id="lwm2moverview-bootstrap_1">Bootstrap</h3>
<p>When an endpoint is registered to a LwM2M Bootstrap Server, it can be managed by performing LwM2M operations on the endpoint's resources. The LwM2M operations are:</p>
<ul>
<li>Bootstrap Finish,</li>
<li>Bootstrap Read,</li>
<li>Bootstrap Write,</li>
<li>Bootstrap Delete,</li>
<li>Bootstrap Discover.</li>
</ul>
<h4 id="lwm2moverview-bootstrap-request">Bootstrap Request</h4>
<p>The first action of LwM2M Client is to connect to the LwM2M Bootstrap Server and ask a Bootstrap Request. The Bootstrap Request message contains an endpointâ€™s unique ID.</p>
<h4 id="lwm2moverview-bootstrap-finish">Bootstrap Finish</h4>
<p>A <strong>Bootstrap Finish</strong> operation is sent by the LwM2M Bootstrap Server. Upon reception of this operation, the LwM2M Client will perform a Bootstrap Consistency check to verify the Bootstrap information received from the LwM2M Bootstrap Server is valid. This means at least one LwM2M server is configured on the LwM2M Client.</p>
<h4 id="lwm2moverview-bootstrap-read">Bootstrap Read</h4>
<p>In LwM2M 1.1 or later, a <strong>Bootstrap Read</strong> operation can target the LwM2M Objects Access Control List or Server, or their LwM2M Object Instances. The endpoint returns data encoded in either TLV, JSON, SenML CBOR, or SenML JSON.</p>
<h4 id="lwm2moverview-bootstrap-write">Bootstrap Write</h4>
<p>A <strong>Bootstrap Write</strong> operation targets a LwM2M Object Instance. It contains data encoded in either TLV or JSON. The payload does not need to contain values for all the Object's resources.</p>
<p>In LwM2M 1.1 or in later version, it contains data encoded in either SenML CBOR or SenML JSON.</p>
<h4 id="lwm2moverview-bootstrap-delete">Bootstrap Delete</h4>
<p>A <strong>Bootstrap Delete</strong> operation can target the root path, a LwM2M Object or a LwM2M Instance Object.</p>
<h4 id="lwm2moverview-bootstrap-discover">Bootstrap Discover</h4>
<p>A <strong>Bootstrap Discover</strong> operation can target the root path or a LwM2M Object. The endpoint returns only the list of Objects and Object Instances with some attributes: LwM2M Enabler version ("lwm2m="), Short Server ID ("ssid="), and LwM2M Server URI ("uri=").</p>
<h3 id="lwm2moverview-registration_1">Registration</h3>
<h4 id="lwm2moverview-initial-registration">Initial Registration</h4>
<p>The first action of LwM2M Client is to register to the LwM2M Server. The registration message contains an <a href="#lwm2moverview-lwm2m-endpoint-name">endpoint name</a> and information about its capabilities (in the form of LwM2M Objects). The registration message also contains a <em>lifetime</em> parameter. When this <em>lifetime</em> expires, the LwM2M Server cancels the LwM2M Client registration.</p>
<p>The LwM2M Server replies with a "location". This location is a handle to the registration. The endpoint uses this handle to update or cancel its registration.</p>
<h4 id="lwm2moverview-registration-update">Registration Update</h4>
<p>To keep its registration active or in case the list of LwM2M Objects is modified, the endpoint sends a Registration Update message.</p>
<p>Upon reception of this message, the LwM2M Server resets its internal <em>lifetime</em> timer.</p>
<h4 id="lwm2moverview-de-registration">De-registration</h4>
<p>To cancel its registration, the LwM2M Client sends a De-registration message. The LwM2M Server may also automatically cancel an endpoint's registration if the registration <em>lifetime</em> expires.</p>
<h3 id="lwm2moverview-device-management-and-service-enablement">Device Management and Service Enablement</h3>
<p>When an endpoint is registered to a LwM2M Server, it can be managed by performing LwM2M operations on the endpoint's resources. The LwM2M operations are:</p>
<ul>
<li>Read,</li>
<li>Write,</li>
<li>Execute,</li>
<li>Discover,</li>
<li>Create,</li>
<li>Delete,</li>
<li>Read composite,</li>
<li>Write composite.</li>
</ul>
<h4 id="lwm2moverview-read">Read</h4>
<p>A <strong>Read</strong> operation can target a LwM2M Object, a LwM2M Object Instance or a LwM2M Resource. The endpoint returns data encoded in either TLV or JSON. For a single resource, a text encoding is possible.</p>
<p>In LwM2M 1.1 or later, the endpoint returns data encoded in either SenML CBOR or SenML JSON.</p>
<h4 id="lwm2moverview-write">Write</h4>
<p>A <strong>Write</strong> operation targets a LwM2M Object Instance. It contains data encoded in either TLV or JSON. The payload does not need to contain values for all the Object's resources.</p>
<p>In LwM2M 1.1 or in later version, it contains data encoded in either SenML CBOR or SenML JSON.</p>
<h4 id="lwm2moverview-execute">Execute</h4>
<p>An <strong>Execute</strong> operation can only target a LwM2M Resource.</p>
<h4 id="lwm2moverview-discover">Discover</h4>
<p>A <strong>Discover</strong> operation can target a LwM2M Object, a LwM2M Object Instance or a LwM2M Resource.</p>
<h4 id="lwm2moverview-create">Create</h4>
<p>A <strong>Create</strong> operation can target a LwM2M Object. It creates a new Object Instance.</p>
<h4 id="lwm2moverview-delete">Delete</h4>
<p>A <strong>Delete</strong> operation can target a LwM2M Object Instance. It deletes an Object Instance.</p>
<h4 id="lwm2moverview-read-composite">Read composite</h4>
<p>In LwM2M 1.1 or in later version, a <strong>Read composite</strong> operation can selectively Read a number of Resources, and/or Resource Instances of different Objects in a single request. The endpoint returns data encoded in either SenML CBOR,  SenML JSON, or LwM2M CBOR.</p>
<h4 id="lwm2moverview-write-composite">Write composite</h4>
<p>In LwM2M 1.1 or in later version, a <strong>Write composite</strong> operation can update values of a number of different Resources across different Instances of one or more Objects in a single request. It contains data encoded in either SenML CBOR , SenML JSON, or LwM2M CBOR.</p>
<h3 id="lwm2moverview-information-reporting">Information Reporting</h3>
<p>When a LwM2M Client is registered to a LwM2M Server, its resources can be observed. Whenever the value of the resource changes, the LwM2M Client sends a notification to the LwM2M Server. Moreover in LwM2M 1.1, the Client can send data to the LwM2M Server without initial solicitation. The LwM2M operations are:</p>
<ul>
<li>Observation,</li>
<li>Observation composite,</li>
<li>Cancel Observation,</li>
<li>Write attributes,</li>
<li>Send.</li>
</ul>
<h4 id="lwm2moverview-observation_1">Observation</h4>
<p>An observation can target a LwM2M Object, a LwM2M Object Instance or a LwM2M Resource.</p>
<h4 id="lwm2moverview-observe-composite">Observe composite</h4>
<p>In LwM2M 1.1 or in later version, a <strong>Observe composite</strong> operation can initiate observations or selectively read a group of Object, Object Instance, Resources, and/or Resource Instances of different Objects in a single request. The endpoint returns data encoded in either SenML CBOR or SenML JSON.</p>
<h4 id="lwm2moverview-notification">Notification</h4>
<p>When an observed resource's value changes, the endpoint sends a notification message to the LwM2M Server.</p>
<h4 id="lwm2moverview-cancel-observation">Cancel Observation</h4>
<p>The LwM2M Server can cancel an on-going observation.</p>
<h4 id="lwm2moverview-write-attributes">Write attributes</h4>
<p>The LwM2M Server can set the parameters of an observation. The possible attributes are:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pmin</td>
<td>Object, Object Instance, Resource</td>
<td>The minimum period in seconds to wait between notifications.</td>
</tr>
<tr>
<td>pmax</td>
<td>Object, Object Instance, Resource</td>
<td>The maximum period in seconds to wait between notifications.</td>
</tr>
<tr>
<td>gt</td>
<td>Numerical Resource</td>
<td>An upper threshold. A notification is sent when the resource value crosses this threshold.</td>
</tr>
<tr>
<td>lt</td>
<td>Numerical Resource</td>
<td>A lower threshold. A notification is sent when the resource value crosses this threshold.</td>
</tr>
<tr>
<td>st</td>
<td>Numerical Resource</td>
<td>A minimum difference in a resource value for a notification to be sent.</td>
</tr>
<tr>
<td>epmin</td>
<td>Object, Object Instance, Resource</td>
<td>The minimum sample time in seconds for the observed sensor in LwM2M 1.1 or in later version.</td>
</tr>
<tr>
<td>epmax</td>
<td>Object, Object Instance, Resource</td>
<td>The maximum sample time in seconds for the observed sensor in LwM2M 1.1 or in later version.</td>
</tr>
</tbody>
</table>
<p>Setting an attribute is in the form <code>Name "=" value</code> with some constraints:</p>
<ul>
<li><code>lt</code> value &lt; <code>gt</code> value</li>
<li><code>lt</code> value + 2 * <code>st</code> value &lt; <code>gt</code> value</li>
<li>If <code>pmax</code> &lt; <code>pmin</code>, <code>pmax</code> is ignored</li>
<li><code>epmax</code> &gt; <code>epmin</code></li>
</ul>
<p>Clearing an attribute is in the form <code>Name</code>.</p>
<h5 id="lwm2moverview-examples">Examples</h5>
<ul>
<li>
<p>Receiving a notification every minute at most even if the observed URI did not change: <code>"pmax=60"</code>.</p>
</li>
<li>
<p>Receiving only one notification per hour even if the observed URI changed several times per minute: <code>"pmin=3600"</code>.</p>
</li>
<li>
<p>Receiving exactly one notification every sixty seconds: <code>"pmin=59&amp;pmax=60"</code>.</p>
</li>
<li>
<p>Receiving a notification when the resource value exceeds 95 or falls below 10, and when the resource value returns below 95 or above 10: <code>"lt=10&amp;gt=95"</code>.</p>
</li>
<li>
<p>Clearing the previously set minimum period and setting a maximum period of five minutes: <code>"pmin&amp;pmax=300"</code>.</p>
</li>
</ul>
<h4 id="lwm2moverview-send">Send</h4>
<p>In LwM2M 1.1 or in later version, a <strong>Send</strong> operation is used by the LwM2M Client to send data to the LwM2M Server without an explicit request from that Server. It contains data encoded in either SenML CBOR, SenML JSON, or LwM2M CBOR.</p>
<p>Later in the documentation, the <strong>Send</strong> operation is called a Data Push.</p>
<h2 id="lwm2moverview-standardized-lwm2m-objects">Standardized LwM2M Objects</h2>
<p>The list of publics LwM2M Objects is available at the OMNA Registry:
<a href="http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html">http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html</a></p>
<h3 id="lwm2moverview-security-object">Security Object</h3>
<p><a href="https://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http://www.openmobilealliance.org/tech/profiles/LWM2M_Security-v1_1.xml">LwM2M Registry for Object 0</a></p>
<p>This object provides the keying material of a LwM2M Client appropriate to access a specified LwM2M Server. One Object Instance should address a LwM2M Bootstrap-Server.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>LwM2M Server URI</td>
<td></td>
<td>Yes</td>
<td>String</td>
<td>Uniquely identifies the LwM2M Server or LwM2M Bootstrap-Server. The format of the CoAP URI is defined in Section 6 of RFC 7252.</td>
</tr>
<tr>
<td>1</td>
<td>Bootstrap-Server</td>
<td></td>
<td>Yes</td>
<td>Boolean</td>
<td>Determines if the current instance concerns a LwM2M Bootstrap-Server (true) or a standard LwM2M Server (false).</td>
</tr>
<tr>
<td>2</td>
<td>Security Mode</td>
<td></td>
<td>Yes</td>
<td>Integer</td>
<td>Determines which UDP payload security mode is used.</td>
</tr>
<tr>
<td>3</td>
<td>Public Key or Identity</td>
<td></td>
<td>Yes</td>
<td>Opaque</td>
<td>Stores the LwM2M Clientâ€™s Certificate (Certificate mode), public key (RPK mode) or PSK Identity (PSK mode).</td>
</tr>
<tr>
<td>4</td>
<td>Server Public Key</td>
<td></td>
<td>Yes</td>
<td>Opaque</td>
<td>Stores the LwM2M Serverâ€™s or LwM2M Bootstrap-Serverâ€™s Certificate (Certificate mode), public key (RPK mode).</td>
</tr>
<tr>
<td>5</td>
<td>Secret Key</td>
<td></td>
<td>Yes</td>
<td>Opaque</td>
<td>Stores the secret key or private key of the security mode.</td>
</tr>
<tr>
<td>6</td>
<td>SMS Security Mode</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>Determines which SMS security mode is used.</td>
</tr>
<tr>
<td>7</td>
<td>SMS Binding Key Parameters</td>
<td></td>
<td>No</td>
<td>Opaque</td>
<td>Stores the KIc, KID, SPI and TAR.</td>
</tr>
<tr>
<td>8</td>
<td>SMS Binding Secret Key(s)</td>
<td></td>
<td>No</td>
<td>Opaque</td>
<td>Stores the values of the key(s) for the SMS binding.</td>
</tr>
<tr>
<td>9</td>
<td>LwM2M Server SMS Number</td>
<td></td>
<td>No</td>
<td>String</td>
<td>MSISDN used by the LwM2M Client to send messages to the LwM2M Server via the SMS binding.</td>
</tr>
<tr>
<td>10</td>
<td>Short Server ID</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>This identifier uniquely identifies each LwM2M Server configured for the LwM2M Client.</td>
</tr>
<tr>
<td>11</td>
<td>Client Hold Off Time</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>Relevant information for a Bootstrap-Server only.</td>
</tr>
<tr>
<td>12</td>
<td>Bootstrap-Server Account Timeout</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>The LwM2M Client MUST purge the LwM2M Bootstrap-Server Account after the timeout value given by this resource. The lowest timeout value is 1.</td>
</tr>
<tr>
<td>13</td>
<td>Matching Type</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The Matching Type Resource specifies how the certificate or raw public key in in the Server Public Key is presented.</td>
</tr>
<tr>
<td>14</td>
<td>SNI</td>
<td></td>
<td>No</td>
<td>String</td>
<td>This resource holds the value of the Server Name Indication (SNI) value to be used during the TLS handshake.</td>
</tr>
<tr>
<td>15</td>
<td>Certificate Usage</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The Certificate Usage Resource specifies the semantic of the certificate.</td>
</tr>
<tr>
<td>16</td>
<td>DTLS/TLS Ciphersuite</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>It instructs the TLS/DTLS client to propose the indicated ciphersuite(s) in the ClientHello of the handshake</td>
</tr>
<tr>
<td>17</td>
<td>OSCORE Security Mode</td>
<td></td>
<td>No</td>
<td>Object link</td>
<td>It provides a link to the OSCORE Object Instance.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-server-object">Server Object</h3>
<p><a href="https://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http://www.openmobilealliance.org/tech/profiles/LWM2M_Server-v1_1.xml">LwM2M Registry for Object 1</a></p>
<p>This object provides the data related to a LwM2M Server. A Bootstrap-Server has no such an Object Instance associated to it.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Short Server ID</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Used as link to associate server Object Instance.</td>
</tr>
<tr>
<td>1</td>
<td>Lifetime</td>
<td>RW</td>
<td>Yes</td>
<td>Integer</td>
<td>Specify the lifetime of the registration in seconds.</td>
</tr>
<tr>
<td>2</td>
<td>Default Minimum Period</td>
<td>RW</td>
<td>No</td>
<td>Integer</td>
<td>The default value the LwM2M Client should use for the Minimum Period of an Observation in the absence of this parameter being included in an Observation.</td>
</tr>
<tr>
<td>3</td>
<td>Default Maximum Period</td>
<td>RW</td>
<td>No</td>
<td>Integer</td>
<td>The default value the LwM2M Client should use for the Maximum Period of an Observation in the absence of this parameter being included in an Observation.</td>
</tr>
<tr>
<td>4</td>
<td>Disable</td>
<td>E</td>
<td>No</td>
<td></td>
<td>If this Resource is executed, this LwM2M Server Object is disabled for a certain period defined in the Disabled Timeout Resource.</td>
</tr>
<tr>
<td>5</td>
<td>Disable Timeout</td>
<td>RW</td>
<td>No</td>
<td>Integer</td>
<td>A period to disable the Server.</td>
</tr>
<tr>
<td>6</td>
<td>Notification Storing When Disabled or Offline</td>
<td>RW</td>
<td>Yes</td>
<td>Boolean</td>
<td>If true, the LwM2M Client stores "Notify" operations to the LwM2M Server while the LwM2M Server account is disabled or the LwM2M Client is offline.</td>
</tr>
<tr>
<td>7</td>
<td>Binding</td>
<td>RW</td>
<td>Yes</td>
<td>String</td>
<td>This Resource defines the transport binding configured for the LwM2M Client.</td>
</tr>
<tr>
<td>8</td>
<td>Registration Update Trigger</td>
<td>E</td>
<td>Yes</td>
<td></td>
<td>If this Resource is executed the LwM2M Client MUST perform an "Update" operation with this LwM2M Server using that transport for the Current Binding Mode.</td>
</tr>
<tr>
<td>9</td>
<td>Bootstrap-Request Trigger</td>
<td>E</td>
<td>No</td>
<td></td>
<td>If this Resource is executed the LwM2M Client MUST initiate a "Client Initiated Bootstrap" procedure in using the LwM2M Bootstrap-Server Account.</td>
</tr>
<tr>
<td>10</td>
<td>APN Link</td>
<td>RW</td>
<td>No</td>
<td>Object link</td>
<td>It provides a link to the APN connection profile Object Instance (OMNA registered Object ID:11) to be used to communicate with this server.</td>
</tr>
<tr>
<td>11</td>
<td>TLS-DTLS Alert Code</td>
<td>R</td>
<td>No</td>
<td>Unsigned Integer</td>
<td>It contains the most recent TLS / DTLS alert message received from the LwM2M Server.</td>
</tr>
<tr>
<td>12</td>
<td>Last Bootstrapped</td>
<td>R</td>
<td>No</td>
<td>Time</td>
<td>It represents the last time that the bootstrap server updated this LwM2M Server Account.</td>
</tr>
<tr>
<td>13</td>
<td>Registration Priority Order</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The LwM2M Client sequences the LwM2M Server registrations in increasing order of this value.</td>
</tr>
<tr>
<td>14</td>
<td>Initial Registration Delay Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay before registration is attempted for this LwM2M Server based upon the completion of registration of the previous LwM2M Server in the registration order.</td>
</tr>
<tr>
<td>15</td>
<td>Registration Failure Block</td>
<td></td>
<td>No</td>
<td>Boolean</td>
<td>Prevent or not the registration on the next LwM2M Server when the registration fails to connect with this LwM2M server.</td>
</tr>
<tr>
<td>16</td>
<td>Bootstrap on Registration Failure</td>
<td></td>
<td>No</td>
<td>Boolean</td>
<td>Initiate a Bootstrap Request or not when the registration fails to connect with this LwM2M server.</td>
</tr>
<tr>
<td>17</td>
<td>Communication Retry Count</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The number of successive communication attempts before which a communication sequence is considered as failed.</td>
</tr>
<tr>
<td>18</td>
<td>Communication Retry Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay between successive communication attempts in a communication sequence.</td>
</tr>
<tr>
<td>19</td>
<td>Communication Sequence Delay Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay between successive communication sequences.</td>
</tr>
<tr>
<td>20</td>
<td>Communication Sequence Retry Count</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The number of successive communication sequences before which a registration attempt is considered as failed.</td>
</tr>
<tr>
<td>21</td>
<td>Trigger</td>
<td>RW</td>
<td>No</td>
<td>Boolean</td>
<td>Using the Trigger Resource a LwM2M Client can indicate whether it is reachable over SMS (value set to 'true') or not (value set to 'false').</td>
</tr>
<tr>
<td>22</td>
<td>Preferred Transport</td>
<td>RW</td>
<td>No</td>
<td>String</td>
<td>When the LwM2M client supports multiple transports, it MAY use this transport to initiate a connection.</td>
</tr>
<tr>
<td>23</td>
<td>Mute Send</td>
<td>RW</td>
<td>No</td>
<td>Boolean</td>
<td>De-activated the LwM2M Client Send command capability.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-access-control-list-object">Access Control List Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Access_Control-v1_0_2.xml">LwM2M Registry for Object 2</a></p>
<p>This object is used to check whether the LwM2M Server has access right for performing an operation.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Object ID</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Used as link to associate Object which the access right is applicable.</td>
</tr>
<tr>
<td>1</td>
<td>Object Instance ID</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Used as link to associate Object Instance which the access right is applicable.</td>
</tr>
<tr>
<td>2</td>
<td>ACL</td>
<td>RW</td>
<td>No</td>
<td>Integer</td>
<td>Set the access right for the corresponding LwM2M Servers.</td>
</tr>
<tr>
<td>3</td>
<td>Access Control Owner</td>
<td>RW</td>
<td>Yes</td>
<td>Integer</td>
<td>Short Server ID of a LwM2M Server. Only this LwM2M Server can manage the Resources of this Object Instance.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-device-object">Device Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Device-v1_1.xml">LwM2M Registry for Object 3</a></p>
<p>This object contains the device information: model, manufacturer, serial number, power source type, battery level, etc... It also contains a resource allowing the Server to reboot the Device.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Manufacturer</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Human readable manufacturer name</td>
</tr>
<tr>
<td>1</td>
<td>Model Number</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>A model identifier (manufacturer specified string)</td>
</tr>
<tr>
<td>2</td>
<td>Serial Number</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Serial Number</td>
</tr>
<tr>
<td>3</td>
<td>Firmware Version</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Current firmware version of the Device.</td>
</tr>
<tr>
<td>4</td>
<td>Reboot</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Reboot the LwM2M Device.</td>
</tr>
<tr>
<td>5</td>
<td>Factory Reset</td>
<td>E</td>
<td>No</td>
<td>none</td>
<td>Perform factory reset of the LwM2M Device to make the LwM2M Device to go through initial deployment sequence where provisioning and bootstrap sequence is performed.</td>
</tr>
<tr>
<td>6</td>
<td>Available Power Sources</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>Available power sources of the Device.</td>
</tr>
<tr>
<td>7</td>
<td>Power Source Voltage</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>Present voltage for each Available Power Sources.</td>
</tr>
<tr>
<td>8</td>
<td>Power Source Current</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>Present current for each Available Power Sources.</td>
</tr>
<tr>
<td>9</td>
<td>Battery Level</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Contains the current battery level as a percentage.</td>
</tr>
<tr>
<td>10</td>
<td>Memory Free</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Estimated current available amount of storage space in the Device (expressed in kilobytes).</td>
</tr>
<tr>
<td>11</td>
<td>Error Code</td>
<td>R</td>
<td>Yes</td>
<td>Integer array</td>
<td>List of errors experienced by the Device.</td>
</tr>
<tr>
<td>12</td>
<td>Reset Error Code</td>
<td>E</td>
<td>No</td>
<td>none</td>
<td>Delete all error codes in the previous resource.</td>
</tr>
<tr>
<td>13</td>
<td>Current Time</td>
<td>R/W</td>
<td>No</td>
<td>Time</td>
<td>Current UNIX time of the LwM2M Client.</td>
</tr>
<tr>
<td>14</td>
<td>UTC Offset</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Indicates the UTC offset currently in effect for this LwM2M Device.</td>
</tr>
<tr>
<td>15</td>
<td>Timezone</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Indicates in which time zone the LwM2M Device is located.</td>
</tr>
<tr>
<td>16</td>
<td>Supported Bindings</td>
<td>R</td>
<td>Yes</td>
<td>String</td>
<td>Indicates which transports are supported by the Device.</td>
</tr>
<tr>
<td>17</td>
<td>Device Type</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Type of the device (manufacturer specified string).</td>
</tr>
<tr>
<td>18</td>
<td>Hardware Version</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Current hardware version of the device.</td>
</tr>
<tr>
<td>19</td>
<td>Software Version</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Current software version of the device.</td>
</tr>
<tr>
<td>20</td>
<td>Battery Status</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Status of the Device battery (normal, charging, etc...)</td>
</tr>
<tr>
<td>21</td>
<td>Memory Total</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Total amount of storage space in the Device (expressed in kilobytes).</td>
</tr>
<tr>
<td>22</td>
<td>ExtDevInfo</td>
<td>R</td>
<td>No</td>
<td>Object link</td>
<td>Reference to a vendor specific object containing device information.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-connectivity-monitoring-object">Connectivity Monitoring Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Connectivity_Monitoring-v1_2.xml">LwM2M Registry for Object 4</a></p>
<p>This object provides high-level information on the current network type, signal strength, IP address, etcâ€¦</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Network Bearer</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>The network bearer used for the current LwM2M communication session.</td>
</tr>
<tr>
<td>1</td>
<td>Available Network Bearer</td>
<td>R</td>
<td>Yes</td>
<td>Integer array</td>
<td>List of current available network bearer.</td>
</tr>
<tr>
<td>2</td>
<td>Radio Signal Strength</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>The average value of the received signal strength.</td>
</tr>
<tr>
<td>3</td>
<td>Link Quality</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The received link quality.</td>
</tr>
<tr>
<td>4</td>
<td>IP Addresses</td>
<td>R</td>
<td>Yes</td>
<td>String array</td>
<td>The IP addresses assigned to the connectivity interface.</td>
</tr>
<tr>
<td>5</td>
<td>Router IP Addresses</td>
<td>R</td>
<td>No</td>
<td>String array</td>
<td>The IP addresses of the next-hop IP routers.</td>
</tr>
<tr>
<td>6</td>
<td>Link Utilization</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The average utilization of the link in %.</td>
</tr>
<tr>
<td>7</td>
<td>APN</td>
<td>R</td>
<td>No</td>
<td>String array</td>
<td>Access Point Names in case Network Bearer Resource is a Cellular Network.</td>
</tr>
<tr>
<td>8</td>
<td>Cell ID</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Serving Cell ID in case Network Bearer Resource is a Cellular Network.</td>
</tr>
<tr>
<td>9</td>
<td>SMNC</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Serving Mobile Network Code.</td>
</tr>
<tr>
<td>10</td>
<td>SMCC</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Serving Mobile Country Code.</td>
</tr>
<tr>
<td>11</td>
<td>SignalSNR</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Signal to Interference plus Noise Ratio SINR is the ratio of the strength of the received signal to the strength of the received interference signal.</td>
</tr>
<tr>
<td>12</td>
<td>LAC</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Location Area Code in case Network Bearer Resource is a Cellular Network.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-firmware-update-object">Firmware Update Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Firmware_Update-v1_0_1.xml">LwM2M Registry for Object 5</a></p>
<p>This object allows to update the firmware of the device. The firmware package can either be pushed by the Server to the Device or the Device can download it using the provided URI.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Package</td>
<td>W</td>
<td>Yes</td>
<td>Opaque</td>
<td>The firmware package pushed by the Server.</td>
</tr>
<tr>
<td>1</td>
<td>Package URI</td>
<td>R/W</td>
<td>Yes</td>
<td>String</td>
<td>The URI from where the Device can download the firmware package.</td>
</tr>
<tr>
<td>2</td>
<td>Update</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Updates the Device firmware by using the firmware package.</td>
</tr>
<tr>
<td>3</td>
<td>State</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Indicates current state with respect to this firmware update.</td>
</tr>
<tr>
<td>5</td>
<td>Update Result</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Contains the result of downloading or updating the firmware.</td>
</tr>
<tr>
<td>6</td>
<td>PkgName</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>The name of the Firmware Package.</td>
</tr>
<tr>
<td>7</td>
<td>PkgVersion</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>The version of the Firmware package.</td>
</tr>
<tr>
<td>8</td>
<td>Firmware Update Protocol Support</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The download protocols the Device implements.</td>
</tr>
<tr>
<td>9</td>
<td>Firmware Update Delivery Method</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>The delivery methods the Device supports.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-location-object">Location Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Location-v1_0.xml">LwM2M Registry for Object 6</a></p>
<p>This object contains information on the device position and speed.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Latitude</td>
<td>R</td>
<td>Yes</td>
<td>Float</td>
<td>The decimal notation of latitude.</td>
</tr>
<tr>
<td>1</td>
<td>Longitude</td>
<td>R</td>
<td>Yes</td>
<td>Float</td>
<td>The decimal notation of longitude.</td>
</tr>
<tr>
<td>2</td>
<td>Altitude</td>
<td>R</td>
<td>No</td>
<td>Float</td>
<td>The decimal notation of altitude in meters above sea level.</td>
</tr>
<tr>
<td>3</td>
<td>Radius</td>
<td>R</td>
<td>No</td>
<td>Float</td>
<td>The size in meters of a circular area around a point of geometry.</td>
</tr>
<tr>
<td>4</td>
<td>Velocity</td>
<td>R</td>
<td>No</td>
<td>Opaque</td>
<td>The velocity in the Device.</td>
</tr>
<tr>
<td>5</td>
<td>Timestamp</td>
<td>R</td>
<td>No</td>
<td>Time</td>
<td>The timestamp of when the location measurement was performed.</td>
</tr>
<tr>
<td>6</td>
<td>Speed</td>
<td>R</td>
<td>No</td>
<td>Float</td>
<td>The speed of the Device in meters per second.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-connectivity-statistics-object">Connectivity Statistics Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Connectivity_Statistics-v1_0_1.xml">LwM2M Registry for Object 7</a></p>
<p>This object collects statistics on the network usage.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>SMS Tx Counter</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The total number of SMS successfully transmitted during the collection period.</td>
</tr>
<tr>
<td>1</td>
<td>SMS Rx Counter</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The total number of SMS successfully received during the collection period.</td>
</tr>
<tr>
<td>2</td>
<td>Tx Data</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The total amount of IP data transmitted during the collection period.</td>
</tr>
<tr>
<td>3</td>
<td>Rx Data</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The total amount of IP data received during the collection period.</td>
</tr>
<tr>
<td>4</td>
<td>Max Message Size</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The maximum IP message size that is used during the collection period.</td>
</tr>
<tr>
<td>5</td>
<td>Average Message Size</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>The average IP message size that is used during the collection period.</td>
</tr>
<tr>
<td>6</td>
<td>Start</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Start to collect information.</td>
</tr>
<tr>
<td>7</td>
<td>Stop</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Stop collecting information.</td>
</tr>
<tr>
<td>8</td>
<td>Collection Period</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>The default collection period in seconds.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-software-management-object">Software Management Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Software_Management-v1_0.xml">LwM2M Registry for Object 9</a></p>
<p>This object allows to update the software of the device. The software package can either be pushed by the Server to the Device or the Device can download it using the provided URI.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>PkgName</td>
<td>R</td>
<td>Yes</td>
<td>String</td>
<td>Name of the software package.</td>
</tr>
<tr>
<td>1</td>
<td>PkgVersion</td>
<td>R</td>
<td>Yes</td>
<td>String</td>
<td>Version of the software package.</td>
</tr>
<tr>
<td>2</td>
<td>Package</td>
<td>W</td>
<td>No</td>
<td>Opaque</td>
<td>The software package pushed by the Server.</td>
</tr>
<tr>
<td>3</td>
<td>Package URI</td>
<td>W</td>
<td>No</td>
<td>String</td>
<td>The URI from where the Device can download the software package.</td>
</tr>
<tr>
<td>4</td>
<td>Install</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Install the software package.</td>
</tr>
<tr>
<td>5</td>
<td>Checkpoint</td>
<td>R</td>
<td>No</td>
<td>Objlink</td>
<td>Link to a Checkpoint object which allows to specify conditions/dependencies for a software update.</td>
</tr>
<tr>
<td>6</td>
<td>Uninstall</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Uninstall the software package.</td>
</tr>
<tr>
<td>7</td>
<td>Update State</td>
<td>R/W</td>
<td>No</td>
<td>Boolean</td>
<td>Indicates current state with respect to this software update.</td>
</tr>
<tr>
<td>8</td>
<td>Update Supported Object</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Indicates if the LwM2M Client MUST inform the registered LwM2M Servers of Objects and Object Instances parameter by sending an Update or Registration message after the software update operation.</td>
</tr>
<tr>
<td>9</td>
<td>Update Result</td>
<td>R</td>
<td>Yes</td>
<td>Integer</td>
<td>Contains the result of downloading or updating the software.</td>
</tr>
<tr>
<td>10</td>
<td>Activate</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Activate the previously installed software package.</td>
</tr>
<tr>
<td>11</td>
<td>Deactivate</td>
<td>E</td>
<td>Yes</td>
<td>none</td>
<td>Deactivate the previously installed software package.</td>
</tr>
<tr>
<td>12</td>
<td>Activation State</td>
<td>R</td>
<td>Yes</td>
<td>Boolean</td>
<td>Indicate the current activation state of the software.</td>
</tr>
<tr>
<td>13</td>
<td>User Name</td>
<td>W</td>
<td>No</td>
<td>String</td>
<td>User name for access to software Update Package in pull mode.</td>
</tr>
<tr>
<td>14</td>
<td>Password</td>
<td>W</td>
<td>No</td>
<td>String</td>
<td>Password for access to software Update Package in pull mode.</td>
</tr>
<tr>
<td>15</td>
<td>Software Component Link</td>
<td>R</td>
<td>No</td>
<td>Objlink</td>
<td>Reference to SW Components downloaded and installed in scope of the present SW Update Package.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-cellular-connectivity-object">Cellular Connectivity Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Cellular_connectivity-v1_0.xml">LwM2M Registry for Object 10</a></p>
<p>This object is used to configure the cellular connectivity of the Device.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>11</td>
<td>Activated Profile Names</td>
<td>R</td>
<td>Yes</td>
<td>String array</td>
<td>Links to instances of the "APN connection profile" object.</td>
</tr>
<tr>
<td>0</td>
<td>SMSC address</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>E.164 address of SMSC.</td>
</tr>
<tr>
<td>1</td>
<td>Disable radio period</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Time period for which the device shall disconnect from cellular radio.</td>
</tr>
<tr>
<td>2</td>
<td>Module activation code</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>AT command to activate the module.</td>
</tr>
<tr>
<td>3</td>
<td>Vendor specific extensions</td>
<td>R</td>
<td>No</td>
<td>Object Link</td>
<td>Link to a vendor specific object.</td>
</tr>
<tr>
<td>4</td>
<td>PSM Timer</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Power saving mode timer.</td>
</tr>
<tr>
<td>5</td>
<td>Active Timer</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Active timer = T3324 as defined in [3GPP-TS_24.008].</td>
</tr>
<tr>
<td>6</td>
<td>Serving PLMN Rate control</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Maximum the number of allowed uplink PDU transmissions per 6 minute interval.</td>
</tr>
<tr>
<td>7</td>
<td>eDRX parameters for Iu mode</td>
<td>R/W</td>
<td>No</td>
<td>Opaque</td>
<td>Extended DRX parameters (Paging Time Window and eDRX value) for Iu mode.</td>
</tr>
<tr>
<td>8</td>
<td>eDRX parameters for WB-S1 mode</td>
<td>R/W</td>
<td>No</td>
<td>Opaque</td>
<td>Extended DRX parameters (Paging Time Window and eDRX value) for WB-S1 mode.</td>
</tr>
<tr>
<td>9</td>
<td>eDRX parameters for NB-S1 mode</td>
<td>R/W</td>
<td>No</td>
<td>Opaque</td>
<td>Extended DRX parameters (Paging Time Window and eDRX value) for NB-S1 mode.</td>
</tr>
<tr>
<td>10</td>
<td>eDRX parameters for A/Gb mode</td>
<td>R/W</td>
<td>No</td>
<td>Opaque</td>
<td>Extended DRX parameters (Paging Time Window and eDRX value) for A/Gb mode.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-apn-connection-profile-object">APN Connection Profile Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_APN_connection_profile-v1_0.xml">LwM2M Registry for Object 11</a></p>
<p>This object specifies resources to enable a device to connect to an APN.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Profile name</td>
<td>R/W</td>
<td>Yes</td>
<td>String</td>
<td>Human-readable identifier.</td>
</tr>
<tr>
<td>1</td>
<td>APN</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Presented to network during connection to PDN.</td>
</tr>
<tr>
<td>2</td>
<td>Auto select APN by device</td>
<td>R/W</td>
<td>No</td>
<td>Boolean</td>
<td>Enables the device to choose an APN according to a device specific algorithm.</td>
</tr>
<tr>
<td>3</td>
<td>Enable status</td>
<td>R/W</td>
<td>No</td>
<td>Boolean</td>
<td>Connection is activated or not.</td>
</tr>
<tr>
<td>4</td>
<td>Authentication Type</td>
<td>R/W</td>
<td>Yes</td>
<td>Integer</td>
<td>.</td>
</tr>
<tr>
<td>5</td>
<td>User Name</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>.</td>
</tr>
<tr>
<td>6</td>
<td>Secret</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>.</td>
</tr>
<tr>
<td>7</td>
<td>Reconnect Schedule</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Comma separated list of retry delay values in seconds.</td>
</tr>
<tr>
<td>8</td>
<td>Validity (MCC, MNC)</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Coma separated mobile country code, then mobile network code.</td>
</tr>
<tr>
<td>9</td>
<td>Connection establishment time</td>
<td>R</td>
<td>No</td>
<td>Time array</td>
<td>UTC time of connection request.</td>
</tr>
<tr>
<td>10</td>
<td>Connection establishment result</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>.</td>
</tr>
<tr>
<td>11</td>
<td>Connection establishment reject cause</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>Reject cause, see [3GPP-TS_24.008, 3GPP-TS_24.301].</td>
</tr>
<tr>
<td>12</td>
<td>Connection end time</td>
<td>R</td>
<td>No</td>
<td>Time array</td>
<td>UTC time of connection end.</td>
</tr>
<tr>
<td>13</td>
<td>TotalBytesSent</td>
<td>R</td>
<td>No</td>
<td>Integer array</td>
<td>Rolling counter for total number of bytes sent via this interface since last device reset.</td>
</tr>
<tr>
<td>14</td>
<td>TotalBytesReceived</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Rolling counter for total number of bytes received via this interface since last device reset.</td>
</tr>
<tr>
<td>15</td>
<td>IP address</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>IP addresses.</td>
</tr>
<tr>
<td>16</td>
<td>Prefix length</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Associated with IPv6 addresses.</td>
</tr>
<tr>
<td>17</td>
<td>Subnet mask</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Subnet masks.</td>
</tr>
<tr>
<td>18</td>
<td>Gateway</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Gateways.</td>
</tr>
<tr>
<td>19</td>
<td>Primary DNS address</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Primary DNS addresses.</td>
</tr>
<tr>
<td>20</td>
<td>Secondary DNS address</td>
<td>R/W</td>
<td>No</td>
<td>String array</td>
<td>Secondary DNS addresses.</td>
</tr>
<tr>
<td>21</td>
<td>QCI</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Quality of service Class Identifier.</td>
</tr>
<tr>
<td>22</td>
<td>Vendor specific extensions</td>
<td>R</td>
<td>No</td>
<td>Objlnk</td>
<td>Links to a vendor specific object.</td>
</tr>
<tr>
<td>23</td>
<td>TotalPacketsSent</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Rolling counter for total number of packets sent via this interface since last device reset.</td>
</tr>
<tr>
<td>24</td>
<td>PDN Type</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>.</td>
</tr>
<tr>
<td>25</td>
<td>APN Rate Control</td>
<td>R</td>
<td>No</td>
<td>Integer</td>
<td>Determines the number of allowed uplink PDU transmissions per time interval per APN.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-bearer-selection-object">Bearer selection Object</h3>
<p><a href="http://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_Bearer_selection-v1_0.xml">LwM2M Registry for Object 13</a></p>
<p>This object specifies resources to enable a device to choose a PLMN/network on which to attach/register and what type of bearer to then connect.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Preferred Communications Bearer</td>
<td>R/W</td>
<td>No</td>
<td>Integer array</td>
<td>Used in network selection and, if applicable, in subsequent mobility management procedures.</td>
</tr>
<tr>
<td>1</td>
<td>Acceptable RSSI (GSM)</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Provides guide to the application when performing manual network selection.</td>
</tr>
<tr>
<td>2</td>
<td>Acceptable RSCP (UMTS)</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Provides guide to the application when performing manual network selection.</td>
</tr>
<tr>
<td>3</td>
<td>Acceptable RSRP (LTE)</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Provides guide to the application when performing manual network selection.</td>
</tr>
<tr>
<td>4</td>
<td>Acceptable RSSI (1xEV-DO)</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Provides guide to the application when performing manual network selection.</td>
</tr>
<tr>
<td>5</td>
<td>Cell lock list</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Comma separated list of allowed Global Cell Identities.</td>
</tr>
<tr>
<td>6</td>
<td>Operator list</td>
<td>R/W</td>
<td>No</td>
<td>String</td>
<td>Comma separated list of MCC+MNC of operators, in priority order.</td>
</tr>
<tr>
<td>7</td>
<td>Operator list mode</td>
<td>R/W</td>
<td>No</td>
<td>Boolean</td>
<td>Indicates whether resource "operator list" represents the allowed operator list (white list), or, the preferred operator list.</td>
</tr>
<tr>
<td>8</td>
<td>List of available PLMNs</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Allows server to see results of network scan.</td>
</tr>
<tr>
<td>9</td>
<td>Vendor specific extensions</td>
<td>R</td>
<td>No</td>
<td>Object link</td>
<td>Links to a vendor specific object.</td>
</tr>
<tr>
<td>10</td>
<td>Acceptable RSRP (NB-IoT)</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Provides guide to the application when performing manual network selection.</td>
</tr>
<tr>
<td>11</td>
<td>Higher Priority PLMN Search Timer</td>
<td>R/W</td>
<td>No</td>
<td>Integer</td>
<td>Interval between periodic searches for higher priority PLMN.</td>
</tr>
<tr>
<td>12</td>
<td>Attach without PDN connection</td>
<td>R/W</td>
<td>No</td>
<td>Boolean</td>
<td>.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-software-component-object">Software Component Object</h3>
<p><a href="https://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=https%3a%2f%2fwww.openmobilealliance.org%2ftech%2fprofiles%2fLWM2M_Software_Component-v1_0.xml">LwM2M Registry for Object 14</a></p>
<p>This object provides the resources needed to activate/deactivate software components on the device.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Component Identity</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Name or identifier of the software component.</td>
</tr>
<tr>
<td>1</td>
<td>Component Pack</td>
<td>R</td>
<td>No</td>
<td>Opaque</td>
<td>Software components is stored in this resource.</td>
</tr>
<tr>
<td>2</td>
<td>Component Version</td>
<td>R</td>
<td>No</td>
<td>String</td>
<td>Version of the software component.</td>
</tr>
<tr>
<td>3</td>
<td>Activate</td>
<td>E</td>
<td>No</td>
<td>none</td>
<td>Activate the installed software component.</td>
</tr>
<tr>
<td>4</td>
<td>Deactivate</td>
<td>E</td>
<td>No</td>
<td>none</td>
<td>Deactivate the installed software component.</td>
</tr>
<tr>
<td>5</td>
<td>Activation State</td>
<td>R</td>
<td>No</td>
<td>Boolean</td>
<td>Indicate the current activation state of the software.</td>
</tr>
</tbody>
</table>
<h3 id="lwm2moverview-lwm2m-oscore">LwM2M OSCORE</h3>
<p><a href="https://devtoolkit.openmobilealliance.org/OEditor/LWMOView?url=http%3A%2F%2Fwww.openmobilealliance.org%2Ftech%2Fprofiles%2FLWM2M_OSCORE-v1_0_1.xml">LwM2M Registry for Object 21</a></p>
<p>This object provides the resources needed to activate/deactivate software components on the device.</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>OSCORE Master Secret</td>
<td></td>
<td>Yes</td>
<td>String</td>
<td>Store the pre-shared key used in LwM2M Client and LwM2M Server/Bootstrap-Server, called the Master Secret.</td>
</tr>
<tr>
<td>1</td>
<td>OSCORE Sender ID</td>
<td></td>
<td>Yes</td>
<td>String</td>
<td>Store an OSCORE identifier for the LwM2M Client called the Sender ID.</td>
</tr>
<tr>
<td>2</td>
<td>OSCORE Recipient ID</td>
<td></td>
<td>Yes</td>
<td>String</td>
<td>Store an OSCORE identifier for the LwM2M Client called the Recipient ID.</td>
</tr>
<tr>
<td>3</td>
<td>OSCORE AEAD Algorithm</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>Store the encoding of the AEAD Algorithm as defined in Table 10 of RFC 8152. The AEAD is used by OSCORE for encryption and integrity protection of CoAP message fields.</td>
</tr>
<tr>
<td>4</td>
<td>OSCORE HMAC Algorithm</td>
<td></td>
<td>No</td>
<td>Integer</td>
<td>Store the encoding of the HMAC Algorithm used in the HKDF. The encoding of HMAC algorithms are defined in Table 7 of RFC 8152. The HKDF is used to derive the security context used by OSCORE.</td>
</tr>
<tr>
<td>5</td>
<td>OSCORE Master Salt</td>
<td></td>
<td>No</td>
<td>String</td>
<td>Store a non-secret random value called the Master Salt. The Master Salt is used to derive the security context used by OSCORE.</td>
</tr>
</tbody>
</table></section><section class="print-page" id="building"><h1 id="building-samples-compilation">Samples Compilation</h1>
<h2 id="building-on-linux">On Linux</h2>
<p><strong>Prerequisites:</strong> An x86-64 computer with a Linux distribution installed, the <code>cmake</code> utility, the <code>make</code> utility and a C compiler.</p>
<ol>
<li>Create a build folder</li>
</ol>
<p><code>mkdir build</code></p>
<ol>
<li>Go to this folder</li>
</ol>
<p><code>cd build</code></p>
<ol>
<li>Launch cmake in debug mode</li>
</ol>
<p><code>cmake -DCMAKE_BUILD_TYPE=Debug ..</code></p>
<p>(the last parameter point to the folder containing the CMakeLists.txt file of your target. In this case the one at the root of the repo including all the samples)</p>
<ol>
<li>Build the client and the server</li>
</ol>
<p><code>make -j 4</code></p>
<p>( the <code>-j 4</code> parameter enables four parallel compilations)</p>
<p>After making some modifications to the code, only the step 4 is required.</p>
<h2 id="building-on-windows">On Windows</h2>
<h3 id="building-using-visual-studio-code">Using Visual Studio Code</h3>
<ol>
<li>Install the Microsoft C++ compiler as explained here: <a href="https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=vs-2019">https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=vs-2019</a></li>
<li>Select the "Build Tools for Visual Studio 2019".</li>
<li>In the Installer, make sure the following optional features are checked:<ul>
<li>MSVC v142 - VS 2019 C++ x64/x86 build tools (Note that the version may differ)</li>
<li>Windows 10 SDK</li>
<li>C++ CMake tools for Windows</li>
</ul>
</li>
<li>Install Visual Studio Code from <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></li>
<li>Launch Visual Studio Code.</li>
<li>Go to the "Extensions" panel (Ctrl+Shift+X) on the left side.</li>
<li>Install the "C/C++", "CMake", and "CMake Tools" extensions</li>
<li>Open the folder containing the IOWA Samples ("File" menu -&gt; "Open Folder..." or "Ctrl+K Ctrl+O")</li>
<li>Open the CMake panel on the left side.</li>
<li>On the top bar of the CMake panel, click on the icon "Configure All Projects".</li>
<li>When prompted to select a kit, choose one of the Visual Studio Build Tools.</li>
<li>On the top bar of the CMake panel, click on the icon "Build All Projects".</li>
<li>Click on the sample of your choice.</li>
<li>Right-click on the application and select "Run in terminal"</li>
</ol>
<h3 id="building-using-visual-studio-with-c-support">Using Visual Studio with C++ support.</h3>
<p>Visual Studio version must be at least 2017 for the CMake support.</p>
<ol>
<li>In the Visual Studio menu bar, go to "File", "Open", "Folder". Select the IOWA Samples folder.</li>
<li>In the "Solution Explorer" windows, right-click on "CMakeList.txt" and choose "Set as Startup Item".</li>
<li>In the Visual Studio menu bar, go to "Build", "Build All"</li>
</ol></section><section class="print-page" id="configuration"><h1 id="configuration-configuration">Configuration</h1>
<p>IOWA relies on the compilation flags described below to enable or disable features. These compilation flags can be set in the header file <code>iowa_config.h</code>. Every source file of IOWA includes this header file.</p>
<p>To create your product, a template is provided in the <code>include</code> folder.</p>
<h2 id="configuration-platform-configuration">Platform Configuration</h2>
<h3 id="configuration-lwm2m_big_endian-and-lwm2m_little_endian">LWM2M_BIG_ENDIAN and LWM2M_LITTLE_ENDIAN</h3>
<p>Define one and only one of these two to specify the endianness of your platform.</p>
<h3 id="configuration-iowa_buffer_size">IOWA_BUFFER_SIZE</h3>
<p>When using a packet switching transport (e.g. UDP), IOWA stores the received data in a static buffer. <strong>IOWA_BUFFER_SIZE</strong> defines the size in bytes of this static buffer. Note that for the WebSocket transport, IOWA uses a dynamically allocated buffer instead of a static one.</p>
<h3 id="configuration-iowa_use_snprintf">IOWA_USE_SNPRINTF</h3>
<p>When using a text content format, IOWA uses snprintf to serialize float which absolute value is greater than INT64_MAX.</p>
<h2 id="configuration-iowa-configuration">IOWA Configuration</h2>
<h3 id="configuration-transports">Transports</h3>
<p>IOWA can support various transports. These transports are enabled by defining the following:</p>
<dl>
<dt><strong>IOWA_UDP_SUPPORT</strong></dt>
<dd>Support for UDP transport. URI scheme is in the form "coap://" or "coaps://". This transport requires <a href="#configuration-IOWA_BUFFER_SIZE"><strong>IOWA_BUFFER_SIZE</strong></a> to be defined.</dd>
<dt><strong>IOWA_TCP_SUPPORT</strong></dt>
<dd>Support for TCP transport. URI scheme is in the form "coap+tcp://" or "coaps+tcp://".</dd>
<dt><strong>IOWA_WEBSOCKET_SUPPORT</strong></dt>
<dd>Support for WebSocket transport. URI scheme is in the form "coap+ws://" or "coaps+ws://". This transport requires <a href="#configuration-IOWA_BUFFER_SIZE"><strong>IOWA_BUFFER_SIZE</strong></a> to be defined. Note that this transport is not part of the LwM2M standard and may work only with <a href="https://ioterop.com/alaska/">IoTerop's ALASKA device management platform</a>.</dd>
<dt><strong>IOWA_SMS_SUPPORT</strong></dt>
<dd>Support for SMS transport. URI scheme is in the form "coap+sms://" for text SMS or "sms://" for binary SMS. This transport requires <a href="#configuration-IOWA_BUFFER_SIZE"><strong>IOWA_BUFFER_SIZE</strong></a> to be defined.</dd>
<dt><strong>IOWA_LORAWAN_SUPPORT</strong></dt>
<dd>Support for LoRaWAN transport. URI scheme is in the form "lorawan://". This transport requires <a href="#configuration-IOWA_BUFFER_SIZE"><strong>IOWA_BUFFER_SIZE</strong></a> to be defined.</dd>
</dl>
<h5 id="configuration-additional-flags">Additional Flags</h5>
<dl>
<dt><strong>IOWA_COAP_BLOCK_SUPPORT</strong></dt>
<dd>Support for full packet fragmentation at CoAP level as defined in RFC 7959 "Block-Wise Transfers in the Constrained Application Protocol (CoAP)".</dd>
<dt><strong>IOWA_COAP_BLOCK_MINIMAL_SUPPORT</strong></dt>
<dd>Support for reassembly of fragmented packets at CoAP level. Automatically defined with <strong>IOWA_COAP_BLOCK_SUPPORT</strong>. Useful for constrained devices using the "Push" method of <a href="#deviceupdate">Device Update</a>.</dd>
<dt><strong>IOWA_COAP_OSCORE_SUPPORT</strong></dt>
<dd>Support for security at the CoAP message level using Object Security for Constrained RESTful Environments (RFC 8613).</dd>
<dt><strong>IOWA_COAP_ACK_MEMORY_LIMIT</strong></dt>
<dd>Define a limit in bytes for the memory used by CoAP Acknowledgements stored for potential re-transmissions e.g. <code>#define IOWA_COAP_ACK_MEMORY_LIMIT 1024</code>. Useful for memory constrained devices. Note that CoAP Acknowledgements are stored only until <a href="https://tools.ietf.org/html/rfc7252#section-4.8.2">MAX_TRANSMIT_WAIT</a> has expired.</dd>
</dl>
<h3 id="configuration-iowa_abstraction_extension">IOWA_ABSTRACTION_EXTENSION</h3>
<p>IOWA will use the new system abstraction function <a href="#abstractionlayer-iowa_system_connection_open_server"><code>iowa_system_connection_open_server()</code></a> instead of <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</p>
<h3 id="configuration-iowa_security_layer">IOWA_SECURITY_LAYER</h3>
<p>IOWA can use different DTLS/TLS stacks to secure communication between LwM2M Clients and Servers. The possible values for this define are:</p>
<dl>
<dt><strong>IOWA_SECURITY_LAYER_NONE</strong></dt>
<dd>No security features can be used. This is the default value if <strong>IOWA_SECURITY_LAYER</strong> is not defined.</dd>
<dt><strong>IOWA_SECURITY_LAYER_USER</strong></dt>
<dd>To provide your security stack. Refer to the <a href="#security-providing-your-security-implementation">Providing your security implementation</a> section for details.</dd>
<dt><strong>IOWA_SECURITY_LAYER_MBEDTLS</strong></dt>
<dd>Use mbed TLS as the DTLS/TLS stack. The sources of mbed TLS are provided in the <code>externals/mbedtls</code> folder.</dd>
<dt><strong>IOWA_SECURITY_LAYER_MBEDTLS_OSCORE_ONLY</strong></dt>
<dd>Use mbed TLS as the cryptographic stack restricted to OSCORE mode. The sources of mbed TLS are provided in the <code>externals/mbedtls</code> folder.</dd>
<dt><strong>IOWA_SECURITY_LAYER_MBEDTLS_PSK_ONLY</strong></dt>
<dd>Use mbed TLS as the DTLS/TLS stack restricted to Pre-Shared Key mode. The sources of mbed TLS are provided in the <code>externals/mbedtls</code> folder.</dd>
<dt><strong>IOWA_SECURITY_LAYER_TINYDTLS</strong></dt>
<dd>Use tinydtls as the DTLS/TLS stack. The sources of tinydtls are provided in the <code>externals/mbedtls</code> folder. Note that tinydtls does not handle certificate based security modes.</dd>
</dl>
<p>If security is in use, the platform abstraction functions <a href="#abstractionlayer-iowa_system_security_data"><code>iowa_system_security_data()</code></a> and <a href="#abstractionlayer-iowa_system_random_vector_generator"><code>iowa_system_random_vector_generator()</code></a> must be implemented.</p>
<p>Be aware, security increases the ROM/RAM footprints. The mbed TLS or tinyDTLS layer have been configured to keep a good ratio between the ROM/RAM footprints and optimal security. But on constrained devices, the Flash used is small and designed to be optimal (fully used). Thus, if the security layer exceeds the footprints, additional defines can be set depending of the device. These defines are outside of the scope of IOWA.</p>
<p>For mbed TLS layer, the following defines can be set in <code>externals/mbedtls/include/mbedtls/config.h</code>:</p>
<ul>
<li><strong>MBEDTLS_AES_ROM_TABLES</strong>: Store the pre-computed AES tables in the ROM instead of the RAM. It can reduce RAM usage by ~8kb, but increase ROM usage by ~8kb.</li>
<li><strong>MBEDTLS_AES_FEWER_TABLES</strong>: Store a smaller pre-computed AES tables in the ROM/RAM. It can reduce the usage by ~6kb, and thus pre-computed AES tables cost only ~2kb.</li>
</ul>
<h3 id="configuration-iowa_log_level-and-iowa_log_part">IOWA_LOG_LEVEL and IOWA_LOG_PART</h3>
<p>These defines configure the traces provided by IOWA. Obviously, having more traces increase the code footprint of IOWA. Note that all traces are provided to the platform abstraction function <a href="#abstractionlayer-iowa_system_trace"><code>iowa_system_trace()</code></a>.</p>
<p><strong>IOWA_LOG_LEVEL</strong> possible values are:</p>
<ul>
<li><strong>IOWA_LOG_LEVEL_NONE</strong>: No traces are generated. This is the default value if <strong>IOWA_LOG_LEVEL</strong> is not defined.</li>
<li><strong>IOWA_LOG_LEVEL_ERROR</strong>: Only the most critical errors are reported like calling IOWA APIs with wrong parameters or memory allocation failures.</li>
<li><strong>IOWA_LOG_LEVEL_WARNING</strong>: Recoverable errors are also reported.</li>
<li><strong>IOWA_LOG_LEVEL_INFO</strong>: IOWA reports information on major steps of its execution. This is the recommended setting during integration.</li>
<li><strong>IOWA_LOG_LEVEL_TRACE</strong>: IOWA reports every step of its execution. It is advised to use this value only to provide details when contacting the support.</li>
</ul>
<p><strong>IOWA_LOG_PART</strong> is useful to restrict traces to some components of IOWA. It is a combination of the following:</p>
<ul>
<li><strong>IOWA_PART_BASE</strong> IOWA APIs and execution.</li>
<li><strong>IOWA_PART_COAP</strong> the CoAP layer.</li>
<li><strong>IOWA_PART_COMM</strong> the communication handling.</li>
<li><strong>IOWA_PART_DATA</strong> the serialization/deserialization payload packet handling.</li>
<li><strong>IOWA_PART_LWM2M</strong> the Lightweight M2M layer.</li>
<li><strong>IOWA_PART_OBJECT</strong> the object layer.</li>
<li><strong>IOWA_PART_SECURITY</strong> the security layer.</li>
<li><strong>IOWA_PART_SYSTEM</strong> the platform abstraction layer.</li>
</ul>
<p>Additionally, <strong>IOWA_PART_ALL</strong> is defined as enabling traces of all components. This is the default value if <strong>IOWA_LOG_PART</strong> is not defined.</p>
<h4 id="configuration-iowa_log_buffer_limit">IOWA_LOG_BUFFER_LIMIT</h4>
<p>By default, when logging a buffer, IOWA logs all the content. To limit the outputs, set this define to a numerical value, e.g.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define IOWA_LOG_BUFFER_LIMIT 512</span>
</code></pre></div>
<h3 id="configuration-iowa_thread_support">IOWA_THREAD_SUPPORT</h3>
<p>When using IOWA in a multithreaded system, defining <strong>IOWA_THREAD_SUPPORT</strong> enables thread safety in IOWA.</p>
<p>This feature requires the platform abstraction functions <a href="#abstractionlayer-iowa_system_connection_interrupt_select"><code>iowa_system_connection_interrupt_select()</code></a>, <a href="#abstractionlayer-iowa_system_mutex_lock"><code>iowa_system_mutex_lock()</code></a>, and <a href="#abstractionlayer-iowa_system_mutex_unlock"><code>iowa_system_mutex_unlock()</code></a> to be implemented.</p>
<h3 id="configuration-iowa_storage_context_support">IOWA_STORAGE_CONTEXT_SUPPORT</h3>
<p>IOWA can save and restore its context through the APIs <a href="#commonapi-iowa_save_context"><code>iowa_save_context()</code></a>, <a href="#commonapi-iowa_save_context_snapshot"><code>iowa_save_context_snapshot()</code></a> and <a href="#commonapi-iowa_load_context"><code>iowa_load_context()</code></a>. This feature requires this compilation flag to be set.</p>
<p>This feature allows external data to be saved and restored with the context through callback. Callbacks can be added and deleted through the APIs <a href="#commonapi-iowa_backup_register_callback"><code>iowa_backup_register_callback()</code></a> and <a href="#commonapi-iowa_backup_deregister_callback"><code>iowa_backup_deregister_callback()</code></a>.</p>
<p>This feature requires the platform abstraction functions <a href="#abstractionlayer-iowa_system_store_context"><code>iowa_system_store_context()</code></a> and <a href="#abstractionlayer-iowa_system_retrieve_context"><code>iowa_system_retrieve_context()</code></a> to be implemented.</p>
<h3 id="configuration-iowa_storage_context_automatic_backup">IOWA_STORAGE_CONTEXT_AUTOMATIC_BACKUP</h3>
<p>When this flag is set, IOWA would save the LwM2M Client context after every modification by a LwM2M Server or LwM2M Bootstrap Server. This feature does not save the server's runtime information. This is only relevant when IOWA is in Client mode and requires <strong>IOWA_STORAGE_CONTEXT_SUPPORT</strong> to be set.</p>
<h3 id="configuration-iowa_storage_context_manual_heartbeat_on_load">IOWA_STORAGE_CONTEXT_MANUAL_HEARTBEAT_ON_LOAD</h3>
<p>By default, <a href="#commonapi-iowa_load_context"><code>iowa_load_context()</code></a> automatically sends a Registration Update to loaded LwM2M Servers the Client is registered to. When this flag is enabled, <a href="#commonapi-iowa_load_context"><code>iowa_load_context()</code></a> only opens the connection to the registered LwM2M Servers. The application can decide to call either <a href="#clientapi-iowa_client_send_heartbeat"><code>iowa_client_send_heartbeat()</code></a> or <a href="#commonapi-iowa_clock_reset"><code>iowa_clock_reset()</code></a>.</p>
<h3 id="configuration-iowa_config_skip_system_function_check">IOWA_CONFIG_SKIP_SYSTEM_FUNCTION_CHECK</h3>
<p>This define allows disabling system function checks such as memory allocation. It assumes that system functions can not fail. This define is useful to reduce the code footprint.</p>
<h3 id="configuration-iowa_config_skip_args_check">IOWA_CONFIG_SKIP_ARGS_CHECK</h3>
<p>This define allows disabling check functions' arguments. It assumes that the functions' arguments are valid. This define is useful to reduce the code footprint.</p>
<h3 id="configuration-iowa_logger_user">IOWA_LOGGER_USER</h3>
<p>This define allows implementing your Logger's functions. If not defined, use the IOWA Logger implementation.</p>
<p>If this define is set, the platform abstraction functions <a href="#loggerapi.md-iowa_log"><code>iowa_log()</code></a>, <a href="#loggerapi.md-iowa_log_arg"><code>iowa_log_arg()</code></a>, <a href="#loggerapi.md-iowa_log_buffer"><code>iowa_log_buffer()</code></a> and <a href="#loggerapi.md-iowa_log_arg_buffer"><code>iowa_log_arg_buffer()</code></a> must be implemented.</p>
<h3 id="configuration-iowa_peer_identifier_size">IOWA_PEER_IDENTIFIER_SIZE</h3>
<p>This is only relevant when IOWA is in Server and/or Bootstrap Server mode. This define is used to set the maximum size of the peer identifier on the network. This is used when the endpoint name is not found in the registration payload and the stack calls <a href="#abstractionlayer-iowa_system_connection_get_peer_identifier"><code>iowa_system_connection_get_peer_identifier</code></a>.</p>
<h2 id="configuration-lwm2m-configuration">LwM2M Configuration</h2>
<h3 id="configuration-lwm2m-role">LwM2M Role</h3>
<p>Lightweight M2M defines three possible roles for the elements of a LwM2M system: Client, Server, or Bootstrap Server. You can define the role of your device by defining one of
<strong>LWM2M_CLIENT_MODE</strong>, <strong>LWM2M_SERVER_MODE</strong>, or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong>.</p>
<h3 id="configuration-lwm2m-version">LwM2M Version</h3>
<h4 id="configuration-lwm2m_version_1_0_remove">LWM2M_VERSION_1_0_REMOVE</h4>
<p>This disables the default Lightweight M2M version of this stack: LwM2M version 1.0.</p>
<h4 id="configuration-lwm2m_version_1_1_support">LWM2M_VERSION_1_1_SUPPORT</h4>
<p>This enables the support of the LwM2M version 1.1.</p>
<h3 id="configuration-lwm2m_bootstrap">LWM2M_BOOTSTRAP</h3>
<p>This is only relevant when IOWA is in Client mode. This allows the LwM2M Client to be configured by a LwM2M Bootstrap Server.</p>
<h3 id="configuration-lwm2m_bootstrap_pack_support">LWM2M_BOOTSTRAP_PACK_SUPPORT</h3>
<p>This is only relevant when IOWA is Bootstrap Server mode, or in Client mode with <strong>LWM2M_BOOTSTRAP</strong> set. This enables the Bootstrap-Pack operation defined in the LightweightM2M 1.2 specification. The Bootstrap-Pack operation allows to configure a LwM2M Client in a single exchange. In Client mode, when bootstrapping, IOWA will first send a Bootstrap-Pack request. If the request fails, IOWA will then initiate a Bootstrap sequence. </p>
<h3 id="configuration-lwm2m-data-encoding">LwM2M Data Encoding</h3>
<h4 id="configuration-lwm2m_support_json">LWM2M_SUPPORT_JSON</h4>
<p>This enables the support of JSON encoding for LwM2M payload. This support is optional for LwM2M Clients and mandatory for LwM2M Servers. Thus, the feature is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set. Note that JSON is a verbose encoding in LwM2M.</p>
<p>Note that JSON encoding is deprecated in LwM2M 1.1.</p>
<h4 id="configuration-lwm2m_support_senml_json">LWM2M_SUPPORT_SENML_JSON</h4>
<p>This enables the support of SenML JSON encoding for LwM2M 1.1 payload. This support is optional for LwM2M Clients and mandatory for LwM2M Servers:</p>
<ul>
<li>For LwM2M Clients, at least one of the following format must be supported: SenML CBOR or SenML JSON if <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is set.</li>
<li>For LwM2M Servers, the support is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set.</li>
</ul>
<p>Note that SenML JSON is a verbose encoding in LwM2M.</p>
<h4 id="configuration-lwm2m_support_cbor">LWM2M_SUPPORT_CBOR</h4>
<p>This enables the support of CBOR encoding for LwM2M 1.1 payloads containing a single resource value. This support is optional for LwM2M Clients and mandatory for LwM2M Servers. This support is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set.</p>
<h4 id="configuration-lwm2m_support_senml_cbor">LWM2M_SUPPORT_SENML_CBOR</h4>
<p>This enables the support of SenML CBOR encoding for LwM2M 1.1 payload. This support is optional for LwM2M Clients and mandatory for LwM2M Servers:</p>
<ul>
<li>For LwM2M Clients, at least one of the following format must be supported: SenML CBOR or SenML JSON if <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is set.</li>
<li>For LwM2M Servers, the support is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set.</li>
</ul>
<h4 id="configuration-lwm2m_support_lwm2m_cbor">LWM2M_SUPPORT_LWM2M_CBOR</h4>
<p>This enables the support of LwM2M CBOR encoding for LwM2M 1.2 payload. This support is optional for LwM2M Clients and mandatory for LwM2M Servers. For LwM2M Servers, the support is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set.</p>
<h4 id="configuration-lwm2m_support_tlv">LWM2M_SUPPORT_TLV</h4>
<p>This enables the support of TLV encoding for LwM2M payload.</p>
<p>This support is mandatory in LwM2M 1.0, this means that this feature is automatically set if <strong>LWM2M_VERSION_1_0_REMOVE</strong> is NOT set.</p>
<p>In LwM2M 1.1 and later, this support is optional for LwM2M Clients and mandatory for LwM2M Servers. Thus, the feature is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> are set if <strong>LWM2M_VERSION_1_0_REMOVE</strong> is set.</p>
<p>Note that TLV encoding is deprecated in LwM2M 1.1.</p>
<h3 id="configuration-lwm2m_storage_queue_support">LWM2M_STORAGE_QUEUE_SUPPORT</h3>
<p>When a LwM2M Server observing some resources is not reachable, the LwM2M Client stores the notifications until the connectivity is restored. By default, IOWA stores the last notifications in memory. When this flag is set, IOWA discharges the storage of these notifications to the platform.</p>
<p>This feature requires the system abstraction functions <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>, <a href="#abstractionlayer-iowa_system_queue_enqueue"><code>iowa_system_queue_enqueue()</code></a>, <a href="#abstractionlayer-iowa_system_queue_dequeue"><code>iowa_system_queue_dequeue()</code></a>, and <a href="#abstractionlayer-iowa_system_queue_delete"><code>iowa_system_queue_delete()</code></a> to be implemented.</p>
<h3 id="configuration-lwm2m_storage_queue_peek_support">LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</h3>
<p>When a LwM2M Server observing some resources is not reachable, the LwM2M Client stores the notifications until the connectivity is restored. By default, IOWA stores the last notifications in memory. When this flag is set, IOWA discharges the storage of these notifications to the platform. New version using a peek/remove mechanism instead of a dequeue mechanism.</p>
<p>This feature requires the system abstraction functions <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>, <a href="#abstractionlayer-iowa_system_queue_enqueue"><code>iowa_system_queue_enqueue()</code></a>, <a href="#abstractionlayer-iowa_system_queue_peek"><code>iowa_system_queue_peek()</code></a>, <a href="#abstractionlayer-iowa_system_queue_remove"><code>iowa_system_queue_remove()</code></a>, and <a href="#abstractionlayer-iowa_system_queue_delete"><code>iowa_system_queue_delete()</code></a> to be implemented.</p>
<h3 id="configuration-lwm2m_support_timestamp">LWM2M_SUPPORT_TIMESTAMP</h3>
<p>This enables the support of the timestamp for notifications. Timestamp can only be used with the following Content format:</p>
<ul>
<li>JSON with <a href="#configuration-lwm2m_support_json"><strong>LWM2M_SUPPORT_JSON</strong></a></li>
<li>SenML JSON with <a href="#configuration-lwm2m_support_senml_json"><strong>LWM2M_SUPPORT_SENML_JSON</strong></a></li>
<li>SenML CBOR with <a href="#configuration-lwm2m_support_senml_cbor"><strong>LWM2M_SUPPORT_SENML_CBOR</strong></a></li>
</ul>
<h3 id="configuration-lwm2m_altpath_support">LWM2M_ALTPATH_SUPPORT</h3>
<p>By default, the LwM2M Objects are located under the root path. However, devices might be hosting other CoAP Resources on an endpoint, and there may be the need to place LwM2M Objects under an alternate path.</p>
<p>This define allows the use of the Alternate Path. For LwM2M Servers, the support is enabled automatically when <strong>LWM2M_SERVER_MODE</strong> is set.</p>
<h3 id="configuration-lwm2m_client_incoming_connection_support">LWM2M_CLIENT_INCOMING_CONNECTION_SUPPORT</h3>
<p>This is only relevant when IOWA is in Client mode. When set, this define enables the <a href="#clientapi-iowa_client_new_incoming_connection"><code>iowa_client_new_incoming_connection()</code></a> API.</p>
<h3 id="configuration-lwm2m_client_asynchronous_operation_support">LWM2M_CLIENT_ASYNCHRONOUS_OPERATION_SUPPORT</h3>
<p>This is only relevant when IOWA is in Client mode. When this compilation flag is activated, operations on LwM2M Objects can be declared as asynchronous. See <a href="#clientapi-iowa_client_object_set_mode"><code>iowa_client_object_set_mode()</code></a>.</p>
<h3 id="configuration-composite-operations">Composite operations</h3>
<p>The composite operations are automatically enabled when <strong>LWM2M_SERVER_MODE</strong> and <strong>LWM2M_VERSION_1_1_SUPPORT</strong> are set.</p>
<p>Those features require that either <strong>LWM2M_SUPPORT_SENML_JSON</strong>, <strong>LWM2M_SUPPORT_SENML_CBOR</strong>, or <strong>LWM2M_SUPPORT_LWM2M_CBOR</strong> are set.</p>
<h4 id="configuration-lwm2m_read_composite_support">LWM2M_READ_COMPOSITE_SUPPORT</h4>
<p>This enables the support of the Read-Composite operation defined in LwM2M 1.1.</p>
<h4 id="configuration-lwm2m_observe_composite_support">LWM2M_OBSERVE_COMPOSITE_SUPPORT</h4>
<p>This enables the support of Observe-Composite operation and Read-Composite operation defined in LwM2M 1.1. This means that <strong>LWM2M_READ_COMPOSITE_SUPPORT</strong> will be automatically set.</p>
<h4 id="configuration-lwm2m_write_composite_support">LWM2M_WRITE_COMPOSITE_SUPPORT</h4>
<p>This enables the support of the Write-Composite operation defined in LwM2M 1.1.</p>
<h3 id="configuration-lwm2m_data_push_support">LWM2M_DATA_PUSH_SUPPORT</h3>
<p>This enables the support of data push operation defined in LwM2M 1.1. This feature requires that either <strong>LWM2M_SUPPORT_SENML_JSON</strong>, <strong>LWM2M_SUPPORT_SENML_CBOR</strong>, or <strong>LWM2M_SUPPORT_LWM2M_CBOR</strong> are set.</p>
<h3 id="configuration-non-standard-features-configuration">Non-Standard Features Configuration</h3>
<h4 id="configuration-iowa_verizon_operator_support">IOWA_VERIZON_OPERATOR_SUPPORT</h4>
<p>This enables the non-standard features required to interact with the Verizon LwM2M Servers. Namely:</p>
<ul>
<li>The out-of-band message (SMS Registration Update Trigger) can trigger a reboot or a factory reset in addition to the standard registration update.</li>
<li>If a LwM2M Server performs a Write operation on the Package URI Resource (ID: 1) of the Firmware Update object (ID: 5) while the state is Downloading or Updating, IOWA will reply with a 4.00 (Bad Request) error code.</li>
<li>IOWA will accept Write operations on the LwM2M Server Object's Resource Binding (/1/x/7). </li>
<li>The Server Object (ID: 1) presents a Resource with ID 30000 with two Resource Instances:</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Resource ID</th>
<th>Resource Instance ID</th>
<th>Operations</th>
<th>Default value</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>IsRegistered</td>
<td>30000</td>
<td>0</td>
<td>R/W</td>
<td>0</td>
<td>Integer</td>
<td>After the successful registration with the DM server, the device shall set IsRegistered = 1 to indicate the device is registered with the DM server.</td>
</tr>
<tr>
<td>ClientHoldOffTimer</td>
<td>30000</td>
<td>1</td>
<td>R</td>
<td>30 Sec</td>
<td>Integer</td>
<td>The time the device must wait before attempting registration with the DM server</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note that a LwM2M Client with this flag set will wait for the "ClientHoldOffTimer" to expire before trying to register to a LwM2M Server.</p>
</blockquote>
<h2 id="configuration-objects-configuration">Objects Configuration</h2>
<h3 id="configuration-oma-objects">OMA Objects</h3>
<h4 id="configuration-iowa_support_access_control_list_object">IOWA_SUPPORT_ACCESS_CONTROL_LIST_OBJECT</h4>
<p>This enables the support of Access Control List OMA Object. Refer to the <a href="#lwm2moverview-access-control-list-object">Access Control List Object</a> for details.</p>
<h4 id="configuration-iowa_support_bearer_selection_object">IOWA_SUPPORT_BEARER_SELECTION_OBJECT</h4>
<p>This enables the support of Bearer Selection OMA Object. Refer to the <a href="#lwm2moverview-bearer-selection-object">Bearer selection Object</a> for details.</p>
<h4 id="configuration-iowa_support_firmware_update_object">IOWA_SUPPORT_FIRMWARE_UPDATE_OBJECT</h4>
<p>This enables the support of Firmware Update OMA Object. Refer to the <a href="#lwm2moverview-firmware-update-object">Firmware Update Object</a> for details.</p>
<h4 id="configuration-iowa_firmware_update_max_block_interval">IOWA_FIRMWARE_UPDATE_MAX_BLOCK_INTERVAL</h4>
<p>When the LwM2M Client supports the "Push" method of <a href="#deviceupdate">Device Update</a>, and  <strong>IOWA_COAP_BLOCK_MINIMAL_SUPPORT</strong>, this defines the maximum time in seconds to wait between blocks before considering the connection as lost.</p>
<h4 id="configuration-iowa_support_software_component_object">IOWA_SUPPORT_SOFTWARE_COMPONENT_OBJECT</h4>
<p>This enables the support of Software Component OMA Object. Refer to the <a href="#lwm2moverview-software-component-object">Software Component Object</a> for details.</p>
<h4 id="configuration-iowa_support_software_management_object">IOWA_SUPPORT_SOFTWARE_MANAGEMENT_OBJECT</h4>
<p>This enables the support of Software Management OMA Object. Refer to the <a href="#lwm2moverview-software-management-object">Software Management Object</a> for details.</p>
<h3 id="configuration-object-resources">Object Resources</h3>
<p>By default, all the resources of an IOWA-implemented Object are enabled. The optional Resources can be removed by using the compilation flags in the form <code>IOWA_&lt;OBJECT&gt;_RSC_&lt;RESOURCE&gt;_REMOVE</code>.</p>
<h4 id="configuration-iowa_remove_all_optional_resources">IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</h4>
<p>This flag removes all the optional Resources in the IOWA-implemented Objects. Optional Ressources can be enabled by using the compilation flags in the form <code>IOWA_&lt;OBJECT&gt;_SUPPORT_RSC_&lt;RESOURCE&gt;</code>.</p>
<h4 id="configuration-apn-connection-profile">APN Connection Profile</h4>
<h5 id="configuration-default-mode">Default Mode</h5>
<ul>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_APN_REMOVE</strong>: Disable the resource "APN" (Id: 1)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_AUTO_SELECT_APN_DEVICE_REMOVE</strong>: Disable the resource "Auto select APN by device" (Id: 2)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_ENABLE_STATUS_REMOVE</strong>: Disable the resource "Enable status" (Id: 3)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_USER_NAME_REMOVE</strong>: Disable the resource "User Name" (Id: 5)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_SECRET_REMOVE</strong>: Disable the resource "Secret" (Id: 6)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_RECONNECT_SCHEDULE_REMOVE</strong>: Disable the resource "Reconnect Schedule" (Id: 7)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_VALIDITY_REMOVE</strong>: Disable the resource "Validity (MCC, MNC)" (Id: 8)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_CONN_ESTABLISHMENT_TIME_REMOVE</strong>: Disable the resource "Connection establishment time" (Id: 9)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_CONN_ESTABLISHMENT_RESULT_REMOVE</strong>: Disable the resource "Connection establishment result" (Id: 10)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_CONN_ESTABLISHMENT_REJECT_CAUSE_REMOVE</strong>: Disable the resource "Connection establishment reject cause" (Id: 11)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_CONNECTION_END_TIME_REMOVE</strong>: Disable the resource "Connection end time" (Id: 12)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_TOTAL_BYTES_SENT_REMOVE</strong>: Disable the resource "TotalBytesSent" (Id: 13)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_TOTAL_BYTES_RECEIVED_REMOVE</strong>: Disable the resource "TotalBytesReceived" (Id: 14)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_IP_ADDRESS_REMOVE</strong>: Disable the resource "IP address" (Id: 15)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_PREFIX_LENGTH_REMOVE</strong>: Disable the resource "Prefix length" (Id: 16)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_SUBNET_MASK_REMOVE</strong>: Disable the resource "Subnet mask" (Id: 17)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_GATEWAY_REMOVE</strong>: Disable the resource "Gateway" (Id: 18)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_PRIMARY_DNS_ADDRESS_REMOVE</strong>: Disable the resource "Primary DNS address" (Id: 19)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_SECONDARY_DNS_ADDRESS_REMOVE</strong>: Disable the resource "Secondary DNS address" (Id: 20)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_QCI_REMOVE</strong>: Disable the resource "QCI" (Id: 21)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_TOTAL_PACKETS_SENT_REMOVE</strong>: Disable the resource "TotalPacketsSent" (Id: 23)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_PDN_TYPE_REMOVE</strong>: Disable the resource "PDN Type" (Id: 24)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_RSC_APN_RATE_CONTROL_REMOVE</strong>: Disable the resource "APN Rate Control" (Id: 25)</li>
</ul>
<h5 id="configuration-remove-all-mode">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_APN</strong>: Enable the resource "APN" (Id: 1)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_AUTO_SELECT_APN_DEVICE</strong>: Enable the resource "Auto select APN by device" (Id: 2)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_ENABLE_STATUS</strong>: Enable the resource "Enable status" (Id: 3)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_USER_NAME</strong>: Enable the resource "User Name" (Id: 5)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_SECRET</strong>: Enable the resource "Secret" (Id: 6)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_RECONNECT_SCHEDULE</strong>: Enable the resource "Reconnect Schedule" (Id: 7)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_VALIDITY</strong>: Enable the resource "Validity (MCC, MNC)" (Id: 8)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_CONN_ESTABLISHMENT_TIME</strong>: Enable the resource "Connection establishment time" (Id: 9)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_CONN_ESTABLISHMENT_RESULT</strong>: Enable the resource "Connection establishment result" (Id: 10)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_CONN_ESTABLISHMENT_REJECT_CAUSE</strong>: Enable the resource "Connection establishment reject cause" (Id: 11)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_CONNECTION_END_TIME</strong>: Enable the resource "Connection end time" (Id: 12)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_TOTAL_BYTES_SENT</strong>: Enable the resource "TotalBytesSent" (Id: 13)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_TOTAL_BYTES_RECEIVED</strong>: Enable the resource "TotalBytesReceived" (Id: 14)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_IP_ADDRESS</strong>: Enable the resource "IP address" (Id: 15)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_PREFIX_LENGTH</strong>: Enable the resource "Prefix length" (Id: 16)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_SUBNET_MASK</strong>: Enable the resource "Subnet mask" (Id: 17)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_GATEWAY</strong>: Enable the resource "Gateway" (Id: 18)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_PRIMARY_DNS_ADDRESS</strong>: Enable the resource "Primary DNS address" (Id: 19)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_SECONDARY_DNS_ADDRESS</strong>: Enable the resource "Secondary DNS address" (Id: 20)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_QCI</strong>: Enable the resource "QCI" (Id: 21)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_TOTAL_PACKETS_SENT</strong>: Enable the resource "TotalPacketsSent" (Id: 23)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_PDN_TYPE</strong>: Enable the resource "PDN Type" (Id: 24)</li>
<li><strong>IOWA_APN_CONNECTION_PROFILE_SUPPORT_RSC_APN_RATE_CONTROL</strong>: Enable the resource "APN Rate Control" (Id: 25)</li>
</ul>
<h4 id="configuration-bearer-selection">Bearer Selection</h4>
<p>Those defines are only relevant if <strong>IOWA_SUPPORT_BEARER_SELECTION_OBJECT</strong> is set.</p>
<h5 id="configuration-default-mode_1">Default Mode</h5>
<ul>
<li><strong>IOWA_BEARER_SELECTION_RSC_PREFERRED_COMM_BEARER_REMOVE</strong>: Disable the resource "Preferred Communications Bearer" (Id: 0)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ACCEPTABLE_RSSI_GSM_REMOVE</strong>: Disable the resource "Acceptable RSSI (GSM)" (Id: 1)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ACCEPTABLE_RSCP_UMTS_REMOVE</strong>: Disable the resource "Acceptable RSCP (UMTS)" (Id: 2)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ACCEPTABLE_RSRP_LTE_REMOVE</strong>: Disable the resource "Acceptable RSRP (LTE)" (Id: 3)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ACCEPTABLE_RSSI_EV_DO_REMOVE</strong>: Disable the resource "Acceptable RSSI (1xEV-DO)" (Id: 4)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_CELL_LOCK_LIST_REMOVE</strong>: Disable the resource "Cell lock list" (Id: 5)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_OPERATOR_LIST_REMOVE</strong>: Disable the resource "Operator list" (Id: 6)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_OPERATOR_LIST_MODE_REMOVE</strong>: Disable the resource "Operator list mode" (Id: 7)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_AVAILABLE_PLMNS_REMOVE</strong>: Disable the resource "List of available PLMNs" (Id: 8)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ACCEPTABLE_RSRP_NB_IOT_REMOVE</strong>: Disable the resource "Acceptable RSRP (NB-IoT" (Id: 10)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_PLMN_SEARCH_TIMER_REMOVE</strong>: Disable the resource "Higher Priority PLMN Search Timer" (Id: 11)</li>
<li><strong>IOWA_BEARER_SELECTION_RSC_ATTACH_WO_PDN_CONNECTION_REMOVE</strong>: Disable the resource "Attach without PDN connection" (Id: 12)</li>
</ul>
<h5 id="configuration-remove-all-mode_1">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<p>At least one of these defines must be set as this Object composed of only optional Resources.</p>
<ul>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_PREFERRED_COMM_BEARER</strong>: Enable the resource "Preferred Communications Bearer" (Id: 0)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ACCEPTABLE_RSSI_GSM</strong>: Enable the resource "Acceptable RSSI (GSM)" (Id: 1)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ACCEPTABLE_RSCP_UMTS</strong>: Enable the resource "Acceptable RSCP (UMTS)" (Id: 2)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ACCEPTABLE_RSRP_LTE</strong>: Enable the resource "Acceptable RSRP (LTE)" (Id: 3)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ACCEPTABLE_RSSI_EV_DO</strong>: Enable the resource "Acceptable RSSI (1xEV-DO)" (Id: 4)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_CELL_LOCK_LIST</strong>: Enable the resource "Cell lock list" (Id: 5)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_OPERATOR_LIST</strong>: Enable the resource "Operator list" (Id: 6)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_OPERATOR_LIST_MODE</strong>: Enable the resource "Operator list mode" (Id: 7)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_AVAILABLE_PLMNS</strong>: Enable the resource "List of available PLMNs" (Id: 8)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ACCEPTABLE_RSRP_NB_IOT</strong>: Enable the resource "Acceptable RSRP (NB-IoT" (Id: 10)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_PLMN_SEARCH_TIMER</strong>: Enable the resource "Higher Priority PLMN Search Timer" (Id: 11)</li>
<li><strong>IOWA_BEARER_SELECTION_SUPPORT_RSC_ATTACH_WO_PDN_CONNECTION</strong>: Enable the resource "Attach without PDN connection" (Id: 12)</li>
</ul>
<h4 id="configuration-cellular-connectivity">Cellular Connectivity</h4>
<h5 id="configuration-default-mode_2">Default Mode</h5>
<ul>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_SMSC_ADDRESS_REMOVE</strong>: Disable the resource "SMSC address" (Id: 0)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_DISABLE_RADIO_PERIOD_REMOVE</strong>: Disable the resource "Disable radio period" (Id: 1)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_MODULE_ACTIVATION_CODE_REMOVE</strong>: Disable the resource "Module activation code" (Id: 2)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_PSM_TIMER_REMOVE</strong>: Disable the resource "PSM Timer" (Id: 4)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_ACTIVE_TIMER_REMOVE</strong>: Disable the resource "Active Timer" (Id: 5)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_PLMN_RATE_CONTROL_REMOVE</strong>: Disable the resource "Serving PLMN Rate control" (Id: 6)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_EDRX_PARAM_IU_MODE_REMOVE</strong>: Disable the resource "eDRX parameters for Iu mode" (Id: 7)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_EDRX_PARAM_WB_S1_MODE_REMOVE</strong>: Disable the resource "eDRX parameters for WB-S1 mode" (Id: 8)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_EDRX_PARAM_NB_S1_MODE_REMOVE</strong>: Disable the resource "eDRX parameters for NB-S1 mode" (Id: 9)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_RSC_EDRX_PARAM_A_GB_MODE_REMOVE</strong>: Disable the resource "eDRX parameters for A/Gb mode" (Id: 10)</li>
</ul>
<h5 id="configuration-remove-all-mode_2">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_SMSC_ADDRESS</strong>: Enable the resource "SMSC address" (Id: 0)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_DISABLE_RADIO_PERIOD</strong>: Enable the resource "Disable radio period" (Id: 1)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_MODULE_ACTIVATION_CODE</strong>: Enable the resource "Module activation code" (Id: 2)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_PSM_TIMER</strong>: Enable the resource "PSM Timer" (Id: 4)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_ACTIVE_TIMER</strong>: Enable the resource "Active Timer" (Id: 5)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_PLMN_RATE_CONTROL</strong>: Enable the resource "Serving PLMN Rate control" (Id: 6)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_EDRX_PARAM_IU_MODE</strong>: Enable the resource "eDRX parameters for Iu mode" (Id: 7)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_EDRX_PARAM_WB_S1_MODE</strong>: Enable the resource "eDRX parameters for WB-S1 mode" (Id: 8)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_EDRX_PARAM_NB_S1_MODE</strong>: Enable the resource "eDRX parameters for NB-S1 mode" (Id: 9)</li>
<li><strong>IOWA_CELLULAR_CONNECTIVITY_SUPPORT_RSC_EDRX_PARAM_A_GB_MODE</strong>: Enable the resource "eDRX parameters for A/Gb mode" (Id: 10)</li>
</ul>
<h4 id="configuration-connectivity-monitoring">Connectivity Monitoring</h4>
<h5 id="configuration-default-mode_3">Default Mode</h5>
<ul>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_LINK_QUALITY_REMOVE</strong>: Disable the resource "Link Quality" (Id: 3)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_ROUTER_IP_ADDR_REMOVE</strong>: Disable the resource "Router IP Addresses" (Id: 5)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_LINK_USAGE_REMOVE</strong>: Disable the resource "Link Utilization" (Id: 6)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_APN_REMOVE</strong>: Disable the resource "APN" (Id: 7)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_CELL_ID_REMOVE</strong>: Disable the resource "Cell ID" (Id: 8)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_SMNC_REMOVE</strong>: Disable the resource "SMNC" (Id: 9)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_RSC_SMCC_REMOVE</strong>: Disable the resource "SMCC" (Id: 10)</li>
</ul>
<h5 id="configuration-remove-all-mode_3">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_LINK_QUALITY</strong>: Disable the resource "Link Quality" (Id: 3)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_ROUTER_IP_ADDR</strong>: Disable the resource "Router IP Addresses" (Id: 5)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_LINK_USAGE</strong>: Disable the resource "Link Utilization" (Id: 6)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_APN</strong>: Disable the resource "APN" (Id: 7)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_CELL_ID</strong>: Disable the resource "Cell ID" (Id: 8)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_SMNC</strong>: Disable the resource "SMNC" (Id: 9)</li>
<li><strong>IOWA_CONNECTIVITY_MONITORING_SUPPORT_RSC_SMCC</strong>: Disable the resource "SMCC" (Id: 10)</li>
</ul>
<h4 id="configuration-device">Device</h4>
<h5 id="configuration-default-mode_4">Default Mode</h5>
<ul>
<li><strong>IOWA_DEVICE_RSC_MANUFACTURER_REMOVE</strong>: Disable the resource "Manufacturer" (Id: 0)</li>
<li><strong>IOWA_DEVICE_RSC_MODEL_NUMBER_REMOVE</strong>: Disable the resource "Model Number" (Id: 1)</li>
<li><strong>IOWA_DEVICE_RSC_SERIAL_NUMBER_REMOVE</strong>: Disable the resource "Serial Number" (Id: 2)</li>
<li><strong>IOWA_DEVICE_RSC_FIRMWARE_VERSION_REMOVE</strong>: Disable the resource "Firmware Version" (Id: 3)</li>
<li><strong>IOWA_DEVICE_RSC_FACTORY_RESET_REMOVE</strong>: Disable the resource "Factory Reset" (Id: 5)</li>
<li><strong>IOWA_DEVICE_RSC_POWER_SOURCE_REMOVE</strong>: Disable the resources "Available Power Sources" (Id: 6), "Power Source Voltage" (Id: 7) and "Power Source Current" (Id: 8)</li>
<li><strong>IOWA_DEVICE_RSC_BATTERY_REMOVE</strong>: Disable the resources "Battery Level" (Id: 9) and "Battery Status" (Id: 20)</li>
<li><strong>IOWA_DEVICE_RSC_RESET_ERROR_REMOVE</strong>: Disable the resource "Reset Error Code" (Id: 12)</li>
<li><strong>IOWA_DEVICE_RSC_CURRENT_TIME_REMOVE</strong>: Disable the resource "Current Time" (Id: 13)</li>
<li><strong>IOWA_DEVICE_RSC_UTC_OFFSET_REMOVE</strong>: Disable the resource "UTC Offset" (Id: 14)</li>
<li><strong>IOWA_DEVICE_RSC_TIMEZONE_REMOVE</strong>: Disable the resource "Timezone" (Id: 15)</li>
<li><strong>IOWA_DEVICE_RSC_DEVICE_TYPE_REMOVE</strong>: Disable the resource "Device Type" (Id: 17)</li>
<li><strong>IOWA_DEVICE_RSC_HARDWARE_VERSION_REMOVE</strong>: Disable the resource "Hardware Version" (Id: 18)</li>
<li><strong>IOWA_DEVICE_RSC_SOFTWARE_VERSION_REMOVE</strong>: Disable the resource "Software Version" (Id: 19)</li>
<li><strong>IOWA_DEVICE_RSC_MEMORY_TOTAL_REMOVE</strong>: Disable the resource "Memory Total" (Id: 21)</li>
<li><strong>IOWA_DEVICE_RSC_MEMORY_FREE_REMOVE</strong>: Disable the resource "Memory Free" (Id: 10)</li>
<li><strong>IOWA_DEVICE_RSC_EXTERNAL_INFO_REMOVE</strong>: Disable the resource "ExtDevInfo" (Id: 22)</li>
</ul>
<h5 id="configuration-remove-all-mode_4">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_MANUFACTURER</strong>: Enable the resource "Manufacturer" (Id: 0)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_MODEL_NUMBER</strong>: Enable the resource "Model Number" (Id: 1)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_SERIAL_NUMBER</strong>: Enable the resource "Serial Number" (Id: 2)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_FIRMWARE_VERSION</strong>: Enable the resource "Firmware Version" (Id: 3)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_FACTORY_RESET</strong>: Enable the resource "Factory Reset" (Id: 5)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong>: Enable the resources "Available Power Sources" (Id: 6), "Power Source Voltage" (Id: 7) and "Power Source Current" (Id: 8)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_BATTERY</strong>: Enable the resources "Battery Level" (Id: 9) and "Battery Status" (Id: 20)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_RESET_ERROR</strong>: Enable the resource "Reset Error Code" (Id: 12)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_CURRENT_TIME</strong>: Enable the resource "Current Time" (Id: 13)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_UTC_OFFSET</strong>: Enable the resource "UTC Offset" (Id: 14)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_TIMEZONE</strong>: Enable the resource "Timezone" (Id: 15)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_DEVICE_TYPE</strong>: Enable the resource "Device Type" (Id: 17)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_HARDWARE_VERSION</strong>: Enable the resource "Hardware Version" (Id: 18)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_SOFTWARE_VERSION</strong>: Enable the resource "Software Version" (Id: 19)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_MEMORY_TOTAL</strong>: Enaable the resource "Memory Total" (Id: 21)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_MEMORY_FREE</strong>: Enable the resource "Memory Free" (Id: 10)</li>
<li><strong>IOWA_DEVICE_SUPPORT_RSC_EXTERNAL_INFO</strong>: Enable the resource "ExtDevInfo" (Id: 22)</li>
</ul>
<h4 id="configuration-server">Server</h4>
<h5 id="configuration-default-mode_5">Default Mode</h5>
<ul>
<li><strong>IOWA_SERVER_RSC_DISABLE_TIMEOUT_REMOVE</strong>: Disable resources "Disable" (Id: 4) and "Disable Timeout" (Id: 5)</li>
<li><strong>IOWA_SERVER_RSC_DEFAULT_PERIODS_REMOVE</strong>: Disable resources "Default Minimum Period" (Id: 2) and "Default Maximum Period" (Id: 3)</li>
<li><strong>IOWA_SERVER_RSC_BOOTSTRAP_TRIGGER_REMOVE</strong>: Disable the resource "Bootstrap-Request Trigger" (Id: 9). This resource is also disabled when <strong>LWM2M_BOOTSTRAP</strong> is not defined.</li>
<li><strong>IOWA_SERVER_RSC_REGISTRATION_BEHAVIOUR_REMOVE</strong>: Disable resources "Registration Priority Order" (Id: 13), "Initial Registration Delay Timer" (Id: 14), "Registration Failure Block" (Id: 15) and "Bootstrap on Registration Failure" (Id: 16). These resources are also disabled when <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is not defined.</li>
<li><strong>IOWA_SERVER_RSC_COMMUNICATION_ATTEMPTS_REMOVE</strong>: Disable resources "Communication Retry Count" (Id: 17), "Communication Retry Timer" (Id: 18), "Communication Sequence Delay Timer" (Id: 19) and "Communication Sequence Retry Count" (Id: 20). These resources are also disabled when <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is not defined.</li>
<li><strong>IOWA_SERVER_RSC_MUTE_SEND_REMOVE</strong>: Disable resources "Mute Send" (Id: 23). Only relevant when LWM2M_DATA_PUSH_SUPPORT is set.</li>
</ul>
<h5 id="configuration-remove-all-mode_5">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_SERVER_SUPPORT_RSC_DISABLE_TIMEOUT</strong>: Enable resources "Disable" (Id: 4) and "Disable Timeout" (Id: 5)</li>
<li><strong>IOWA_SERVER_SUPPORT_RSC_DEFAULT_PERIODS</strong>: Enable resources "Default Minimum Period" (Id: 2) and "Default Maximum Period" (Id: 3)</li>
<li><strong>IOWA_SERVER_SUPPORT_RSC_BOOTSTRAP_TRIGGER</strong>: Enable the resource "Bootstrap-Request Trigger" (Id: 9). This resource is available only if <strong>LWM2M_BOOTSTRAP</strong> is defined.</li>
<li><strong>IOWA_SERVER_SUPPORT_RSC_REGISTRATION_BEHAVIOUR</strong>: Enable resources "Registration Priority Order" (Id: 13), "Initial Registration Delay Timer" (Id: 14), "Registration Failure Block" (Id: 15) and "Bootstrap on Registration Failure" (Id: 16). These resources are available only if <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is defined.</li>
<li><strong>IOWA_SERVER_SUPPORT_RSC_COMMUNICATION_ATTEMPTS</strong>: Enable resources "Communication Retry Count" (Id: 17), "Communication Retry Timer" (Id: 18), "Communication Sequence Delay Timer" (Id: 19) and "Communication Sequence Retry Count" (Id: 20). These resources are available only if <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is defined.</li>
<li><strong>IOWA_SERVER_SUPPORT_RSC_MUTE_SEND</strong>: Enable resources "Mute Send" (Id: 23). This resource is available only if <strong>LWM2M_DATA_PUSH_SUPPORT</strong> is defined.</li>
</ul>
<h5 id="configuration-default-values">Default Values</h5>
<p>As well, some resources contain default value which can be updated using the following defines:</p>
<ul>
<li><strong>IOWA_SERVER_RSC_DISABLE_TIMEOUT_DEFAULT_VALUE</strong>: Update default resource value of "Disable Timeout" (Id: 5). Only relevant if <strong>IOWA_SERVER_SUPPORT_RSC_DISABLE_TIMEOUT</strong> is defined.</li>
<li><strong>IOWA_SERVER_RSC_STORING_DEFAULT_VALUE</strong>: Update default resource value of "Notification Storing When Disabled or Offline" (Id: 6)</li>
<li><strong>IOWA_SERVER_RSC_MUTE_SEND_DEFAULT_VALUE</strong>: Update default resource value of "Mute Send" (Id: 23). Only relevant if <strong>IOWA_SERVER_SUPPORT_RSC_MUTE_SEND</strong> is defined.</li>
</ul>
<h4 id="configuration-light-control">Light Control</h4>
<h5 id="configuration-default-mode_6">Default Mode</h5>
<ul>
<li><strong>IOWA_LIGHT_CONTROL_RSC_DIMMER_REMOVE</strong>: Disable the resource "Dimmer" (Id: 5851)</li>
<li><strong>IOWA_LIGHT_CONTROL_RSC_ON_TIME_REMOVE</strong>: Disable the resource "On time" (Id: 5852)</li>
<li><strong>IOWA_LIGHT_CONTROL_RSC_CUMULATIVE_ACTIVE_POWER_REMOVE</strong>: Disable the resource "Cumulative active power" (Id: 5805)</li>
<li><strong>IOWA_LIGHT_CONTROL_RSC_POWER_FACTOR_REMOVE</strong>: Disable the resource "Power factor" (Id: 5820)</li>
<li><strong>IOWA_LIGHT_CONTROL_RSC_COLOUR_REMOVE</strong>: Disable the resources "Colour" (Id: 5706) and "Sensor Units" (Id: 5701)</li>
</ul>
<h5 id="configuration-remove-all-mode_6">Remove All Mode</h5>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined.</p>
<ul>
<li><strong>IOWA_LIGHT_CONTROL_SUPPORT_RSC_DIMMER</strong>: Enable the resource "Dimmer" (Id: 5851)</li>
<li><strong>IOWA_LIGHT_CONTROL_SUPPORT_RSC_ON_TIME</strong>: Enable the resource "On time" (Id: 5852)</li>
<li><strong>IOWA_LIGHT_CONTROL_SUPPORT_RSC_CUMULATIVE_ACTIVE_POWER</strong>: Enable the resource "Cumulative active power" (Id: 5805)</li>
<li><strong>IOWA_LIGHT_CONTROL_SUPPORT_RSC_POWER_FACTOR</strong>: Enable the resource "Power factor" (Id: 5820)</li>
<li><strong>IOWA_LIGHT_CONTROL_SUPPORT_RSC_COLOUR</strong>: Enable the resources "Colour" (Id: 5706) and "Sensor Units" (Id: 5701)</li>
</ul></section><section class="print-page" id="security"><h1 id="security-security">Security</h1>
<p>Please refer to <a href="#securityapi">Security Implementation APIs</a></p>
<blockquote>
<p>This feature is detailled only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="multithread"><h1 id="multithread-iowa-multithread-environment">IOWA Multithread Environment</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="bootstrap"><h1 id="bootstrap-bootstrap">Bootstrap</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="deviceupdate"><h1 id="deviceupdate-device-update">Device Update</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="customobject"><h1 id="customobject-custom-object">Custom Object</h1>
<p>IOWA abstracts lot of objects for the LwM2M Client through dedicated API. But additional object can be provided to the stack by using the following functions:</p>
<ul>
<li><a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object</code></a></li>
<li><a href="#clientapi-iowa_client_remove_custom_object"><code>iowa_client_remove_custom_object</code></a></li>
<li><a href="#clientapi-iowa_client_object_resource_changed"><code>iowa_client_object_resource_changed</code></a></li>
<li><a href="#clientapi-iowa_client_object_instance_changed"><code>iowa_client_object_instance_changed</code></a></li>
</ul>
<p>Below some examples described how to use these APIs to implement your objects.</p>
<h2 id="customobject-controlling-a-power-switch">Controlling a Power Switch</h2>
<p>Letâ€™s consider that the device containing the IOWA Client is connected to a power switch. You want to be able to monitor and control this power switch from a LwM2M Server.</p>
<p>The first step is to determine the best layout of the LwM2M Object describing the power switch. Fortunately, the IPSO Alliance defined the Power Control Object (ID: 3312) which suits our needs. By re-using a standardized Object, we do not need to provide the LwM2M Servers with the layout of our Object. A server already knows the Object 3312 which contains the following resources:</p>
<table>
<thead>
<tr>
<th>Resource Name</th>
<th>Resource ID</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>On/Off</td>
<td>5850</td>
<td>R, W</td>
<td>Mandatory</td>
<td>Boolean</td>
<td>On/off control, 0=OFF, 1=ON.</td>
</tr>
<tr>
<td>Dimmer</td>
<td>5851</td>
<td>R, W</td>
<td>Optional</td>
<td>Integer</td>
<td>Proportional control, integer value between 0 and 100 as a percentage.</td>
</tr>
<tr>
<td>On Time</td>
<td>5852</td>
<td>R, W</td>
<td>Optional</td>
<td>Integer</td>
<td>The time in seconds that the power relay has been on. Writing a value of 0 resets the counter.</td>
</tr>
<tr>
<td>Cumulative active power</td>
<td>5805</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The cumulative active power since the last cumulative energy reset or device start.</td>
</tr>
<tr>
<td>Power factor</td>
<td>5820</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The power factor of the load.</td>
</tr>
<tr>
<td>Application Type</td>
<td>5750</td>
<td>R, W</td>
<td>Optional</td>
<td>String</td>
<td>The application type of the sensor or actuator as a string, for instance, "Air Pressure".</td>
</tr>
</tbody>
</table>
<p>The On/Off resource is mandatory to implement and is used to both control and monitor our power switch.</p>
<p>The Dimmer resource is not relevant to our use case. As it is optional, we do not implement it.</p>
<p>The On Time is optional but interesting for this example unlike the Cumulative active power, Power factor and Application Type resources.</p>
<p>To implement this Object in our device, in our main(), after initializing the IOWA context (see above), we declare an array describing the two resources:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">resources</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="mi">5850</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_BOOLEAN</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_DM_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_DM_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_MANDATORY</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5852</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_DM_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_DM_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_OPTIONAL</span><span class="p">}</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>Note that the header file "iowa_IPSO_ID.h" in the "include" folder contains defines for the ID, type and operations of the Reusable Resources defined by the IPSO Alliance. Using these macros, we can write the equivalent code as:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">resources</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="n">IPSO_RSC_ID_ON_OFF</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_TYPE_ON_OFF</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_OP_ON_OFF</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_MANDATORY</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="n">IPSO_RSC_ID_ON_TIME</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_TYPE_ON_TIME</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_OP_ON_TIME</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_OPTIONAL</span><span class="p">}</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>Instance-wise, we only have one power switch to control and it makes no sense that the LwM2M Server could create new instances or delete some and the object does not used resources that can be multiple. The <em>instanceCallback</em> and the <em>resInstanceCallback</em> can be omitted and we declare a single instance with ID 0:</p>
<div class="highlight"><pre><span></span><code><span class="kt">uint16_t</span><span class="w"> </span><span class="n">singleInstanceID</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">3312</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">singleInstanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">powerSwitchCallback</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Now the Power Control Object is presented to the LwM2M Servers by the IOWA stack.</p>
<p>When a Server performs a command on one of its resources (or the whole Object), the <code>powerSwitchCallback</code> function is called.</p>
<p>Letâ€™s assume our device provides two functions <code>switch_on()</code> and <code>switch_off()</code> to control the power switch and three interruptions to handle:</p>
<ul>
<li><code>SWITCH_ON</code> when the power switch is set to On,</li>
<li><code>SWITCH_OFF</code> when the power switch is set to Off</li>
<li><code>TIMER</code> when a second had elapsed.</li>
</ul>
<p>We first define two global variables to store the power switch state:</p>
<div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="n">switchState</span><span class="p">;</span><span class="w"></span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">onTime</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>In the interrupt handler, we modify these variables to be in sync with the actual power switch state (pseudo-code):</p>
<div class="highlight"><pre><span></span><code><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">interrupt</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="k">case</span><span class="w"> </span><span class="nl">SWITCH_ON</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">switchState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="k">case</span><span class="w"> </span><span class="nl">SWITCH_OFF</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">switchState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="k">case</span><span class="w"> </span><span class="nl">TIMER</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">switchState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">onTime</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Now the <code>powerSwitchCallback</code> function can be implemented:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">powerSwitchCallback</span><span class="p">(</span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="n">iowa_lwm2m_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">dataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">numData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nl">IOWA_DM_READ</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resourceID</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">5850</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBoolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">switchState</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">5852</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asInteger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onTime</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Already handled by IOWA stack</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nl">IOWA_DM_WRITE</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resourceID</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">5850</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBoolean</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">switch_on</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">switch_off</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">5852</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asInteger</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">onTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">IOWA_COAP_406_NOT_ACCEPTABLE</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">            </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Already handled by IOWA stack</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Already handled by IOWA stack</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Here we assume that the <code>switch_on()</code> and <code>switch_off()</code> functions will trigger an interrupt and the <code>switchState</code> variable is updated by the interrupt handler.</p>
<p>A LwM2M Server can write only <code>0</code> as the new value of the On Time resource hence the check.</p>
<p>If you test this code, you will notice that you can control the power switch remotely and check its state. However the LwM2M Server will not receive notifications when observing the Object resources.</p>
<p>To correct this, we need to inform the IOWA stack of the changes not triggered by a LwM2M Server. This is done by calling the API <a href="#clientapi-iowa_client_object_resource_changed"><code>iowa_client_object_resource_changed()</code></a> whenever a change occurs.</p>
<p>A correct interrupt handler is then:</p>
<div class="highlight"><pre><span></span><code><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">interrupt</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="k">case</span><span class="w"> </span><span class="nl">SWITCH_ON</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">switchState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">3312</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5850</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">switchState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="k">case</span><span class="w"> </span><span class="nl">SWITCH_OFF</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">switchState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">3312</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5850</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">switchState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="k">case</span><span class="w"> </span><span class="nl">TIMER</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">switchState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">onTime</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">3312</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5852</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Note that the calls to <a href="#clientapi-iowa_client_notification_lock"><code>iowa_client_notification_lock()</code></a> are not necessary but are here as an example.</p>
<h2 id="customobject-monitoring-the-temperature-during-a-period">Monitoring the temperature during a period</h2>
<p>Letâ€™s consider that the device containing the IOWA Client is connected to a temperature sensor. You want to be able to monitor this sensor from a LwM2M Server. Monitored value will be reported with the time at which the value was taken.</p>
<p>The following example can be implemented with <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor</code></a> and <a href="#clientapi-iowa_client_IPSO_update_values"><code>iowa_client_IPSO_update_values</code></a>. But we will instead implement our own Custom Object to understand how monitored values with timestamp can be sent to a LwM2M Server.</p>
<p>The first step is to determine the best layout of the LwM2M Object describing the temperature sensor. Fortunately, the IPSO Alliance defined the Temperature Object (ID: 3303) which suits our needs. By re-using a standardized Object, we do not need to provide the LwM2M Servers with the layout of our Object. A server already knows the Object 3303 which contains the following resources:</p>
<table>
<thead>
<tr>
<th>Resource Name</th>
<th>Resource ID</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sensor Value</td>
<td>5700</td>
<td>R</td>
<td>Mandatory</td>
<td>Float</td>
<td>Last or Current Measured Value from the Sensor.</td>
</tr>
<tr>
<td>Min Measured Value</td>
<td>5601</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The minimum value measured by the sensor since power ON or reset.</td>
</tr>
<tr>
<td>Max Measured Value</td>
<td>5602</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The maximum value measured by the sensor since power ON or reset.</td>
</tr>
<tr>
<td>Min Range Value</td>
<td>5603</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The minimum value that can be measured by the sensor.</td>
</tr>
<tr>
<td>Max Range Value</td>
<td>5604</td>
<td>R</td>
<td>Optional</td>
<td>Float</td>
<td>The maximum value that can be measured by the sensor.</td>
</tr>
<tr>
<td>Sensor Units</td>
<td>5701</td>
<td>R</td>
<td>Optional</td>
<td>String</td>
<td>Measurement Units Definition e.g. "Cel" for Temperature in Celsius.</td>
</tr>
<tr>
<td>Reset Min and Max Measured Values</td>
<td>5605</td>
<td>E</td>
<td>Optional</td>
<td></td>
<td>Reset the Min and Max Measured Values to Current Value.</td>
</tr>
</tbody>
</table>
<p>The Sensor Value resource is mandatory to implement and is used to monitor the temperature value.</p>
<p>All the others resources are not relevant to our use case. As they are optional, we do not implement them.</p>
<p>To implement this Object in our device, in our main(), after initializing the IOWA context (see above), we declare an array describing resource:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">resources</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="mi">5700</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_FLOAT</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_DM_READ</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_MANDATORY</span><span class="p">}</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>Note that the header file "iowa_IPSO_ID.h" in the "include" folder contains defines for the ID, type and operations of the Reusable Resources defined by the IPSO Alliance. Using these macros, we can write the equivalent code as:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">resources</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="n">IPSO_RSC_ID_SENSOR_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_TYPE_SENSOR_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">IPSO_RSC_OP_SENSOR_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_MANDATORY</span><span class="p">}</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>Instance-wise, we only have one temperature sensor to monitor and it makes no sense that the LwM2M Server could create new instances or delete some and the object does not used resources that can be multiple. The <em>instanceCallback</em> and the <em>resInstanceCallback</em> can be omitted and we declare a single instance with ID 0:</p>
<div class="highlight"><pre><span></span><code><span class="kt">uint16_t</span><span class="w"> </span><span class="n">singleInstanceID</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">3303</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">singleInstanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">tempSensorCallback</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Now the Temperature Object is presented to the LwM2M Servers by the IOWA stack.</p>
<p>When a Server performs a command on one of its resources (or the whole Object), the <code>tempSensorCallback</code> function is called.</p>
<p>We want to inform to the LwM2M Server the last values taken with the timestamp associated to each value.</p>
<p>Letâ€™s assume our device provides two functions <code>get_time()</code> and <code>get_temperature()</code> to monitor the temperature value and one interruption to handle:</p>
<ul>
<li><code>NEW_TEMP</code> when a new temperature value is available.</li>
</ul>
<p>We first define a new structure and two global variables to store the temperature values. The temperature values will be stored inside a circular buffer:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define NB_VALUE 10</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w">   </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">temp_value_t</span><span class="p">;</span><span class="w"></span>

<span class="n">temp_value_t</span><span class="w"> </span><span class="n">valuesList</span><span class="p">[</span><span class="n">NB_VALUE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">currentIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>In the interrupt handler, we modify these variables to store the temperature values (pseudo-code):</p>
<div class="highlight"><pre><span></span><code><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">interrupt</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="k">case</span><span class="w"> </span><span class="nl">NEW_TEMP</span><span class="p">:</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">valuesList</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_time</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">valuesList</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_temperature</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">currentIndex</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentIndex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NB_VALUE</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">currentIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Now the <code>tempSensorCallback</code> function can be implemented:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">tempSensorCallback</span><span class="p">(</span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="n">iowa_lwm2m_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">dataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">numData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nl">IOWA_DM_READ</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resourceID</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="mi">5700</span><span class="o">:</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">// On a Read operation, provides all the timestamp values</span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="c1">// No value added yet</span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="c1">// Loop on next element</span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="c1">// Find the latest timestamp not currently added</span>
<span class="w">                </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentIndex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">currentIndex</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="n">j</span><span class="mi">-1</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="n">NB_VALUE</span><span class="mi">-1</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>

<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">].</span><span class="n">timestamp</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>

<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NB_VALUE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="k">else</span><span class="w"></span>
<span class="w">                        </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="n">j</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valuesList</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valuesList</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">timestamp</span><span class="p">;</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="n">j</span><span class="mi">-1</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="c1">// Changed result to be called again in the callback</span>
<span class="w">                        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_COAP_231_CONTINUE</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valuesList</span><span class="p">[</span><span class="n">NB_VALUE</span><span class="mi">-1</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="c1">// Changed result to be called again in the callback</span>
<span class="w">                    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_COAP_231_CONTINUE</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">            </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">                </span><span class="c1">// Already handled by IOWA stack</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Already handled by IOWA stack</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Pay attention that the timestamp must be absolute and not relative to the current time, means negative values are not accepted. If the timestamp is zero, it's ignored.</p>
<p>If you test this code, you will notice that you can retrieve the current temperature value. However the LwM2M Server will not receive notifications when observing the Object resources.</p>
<p>To correct this, we need to inform the IOWA stack of the changes not triggered by a LwM2M Server. This is done by calling the API <a href="#clientapi-iowa_client_object_resource_changed"><code>iowa_client_object_resource_changed()</code></a> whenever a change occurs.</p>
<p>A correct interrupt handler is then:</p>
<div class="highlight"><pre><span></span><code><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">interrupt</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="k">case</span><span class="w"> </span><span class="nl">NEW_TEMP</span><span class="p">:</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">valuesList</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="n">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_time</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">valuesList</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_temperature</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">currentIndex</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentIndex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NB_VALUE</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">currentIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">3303</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5700</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">(...)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The diagram of the above example can be:</p>
<p><img alt="Timestamped Notifications" src="images/timestamped_notifications.png" /></p>
<ul>
<li>The Server sends first an Observation on /3303/0/5700.</li>
<li>At this time the LwM2M Client has only one value to send back, and so the return value of the callback is 0.00 (No Error).</li>
<li>Then the LwM2M Client retrieves the temperature values and call <a href="#clientapi-iowa_client_object_resource_changed"><code>iowa_client_object_resource_changed</code></a> for each new value. The Object callback has the possibility to return multiple values by returning the 2.31 (Continue) code.</li>
</ul>
<p>On first round, the application has to provide the first value, the callback is called with:</p>
<ul>
<li><em>numData</em>: 1</li>
<li><em>dataP[0]</em>:<ul>
<li><em>dataP[0].objectID</em>: 3303, <em>dataP[0].instanceID</em>: 0, <em>dataP[0].resourceID</em>: 5700, <em>dataP[0].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[0].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[0].value.asFloat</em>: 0.0</li>
<li><em>dataP[0].timestamp</em>: 0</li>
</ul>
</li>
</ul>
<p>On second round, the application has to provide the second value, the callback is called with:</p>
<ul>
<li><em>numData</em>: 2</li>
<li><em>dataP[0]</em>:<ul>
<li><em>dataP[0].objectID</em>: 3303, <em>dataP[0].instanceID</em>: 0, <em>dataP[0].resourceID</em>: 5700, <em>dataP[0].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[0].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[0].value.asFloat</em>: <strong>FIRST_VALUE</strong></li>
<li><em>dataP[0].timestamp</em>: <strong>FIRST_TIMESTAMP</strong></li>
</ul>
</li>
<li><em>dataP[1]</em>:<ul>
<li><em>dataP[1].objectID</em>: 3303, <em>dataP[1].instanceID</em>: 0, <em>dataP[1].resourceID</em>: 5700, <em>dataP[1].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[1].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[1].value.asFloat</em>: 0.0</li>
<li><em>dataP[1].timestamp</em>: 0</li>
</ul>
</li>
</ul>
<p>On third round, the application has to provide the third value, the callback is called with:</p>
<ul>
<li><em>numData</em>: 3</li>
<li><em>dataP[0]</em>:<ul>
<li><em>dataP[0].objectID</em>: 3303, <em>dataP[0].instanceID</em>: 0, <em>dataP[0].resourceID</em>: 5700, <em>dataP[0].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[0].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[0].value.asFloat</em>: <strong>FIRST_VALUE</strong></li>
<li><em>dataP[0].timestamp</em>: <strong>FIRST_TIMESTAMP</strong></li>
</ul>
</li>
<li><em>dataP[1]</em>:<ul>
<li><em>dataP[1].objectID</em>: 3303, <em>dataP[1].instanceID</em>: 0, <em>dataP[1].resourceID</em>: 5700, <em>dataP[1].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[1].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[1].value.asFloat</em>: <strong>SECOND_VALUE</strong></li>
<li><em>dataP[1].timestamp</em>: <strong>SECOND_TIMESTAMP</strong></li>
</ul>
</li>
<li><em>dataP[2]</em>:<ul>
<li><em>dataP[2].objectID</em>: 3303, <em>dataP[2].instanceID</em>: 0, <em>dataP[2].resourceID</em>: 5700, <em>dataP[2].resInstanceID</em>: 65535 (IOWA_LWM2M_ID_ALL)</li>
<li><em>dataP[2].type</em>: IOWA_LWM2M_TYPE_FLOAT, <em>dataP[2].value.asFloat</em>: 0.0</li>
<li><em>dataP[2].timestamp</em>: 0</li>
</ul>
</li>
</ul>
<p>And so on, until the last value is provided and the return value of the callback is 0.00 (No Error).</p></section><section class="print-page" id="streamable"><h1 id="streamable-custom-object-streaming-apis">Custom Object Streaming APIs</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="applicationstorage"><h1 id="applicationstorage-application-storage">Application storage</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="network"><h1 id="network-iowa-network-environment">IOWA Network environment</h1>
<h2 id="network-network-reliability">Network reliability</h2>
<h3 id="network-behind-the-transport">Behind the transport</h3>
<p>Network reliability is a real issue when a system is deployed in an environment. Some networks can be reliable, when others do not guarantee the transmission of a message from one side to another.</p>
<p>IOWA supports the following transports:</p>
<ul>
<li>User Datagram Protocol (aka UDP)</li>
<li>Transmission Control Protocol (aka TCP)</li>
<li>LoRaWAN</li>
<li>Short Message Service (aka SMS)</li>
</ul>
<p>For each transport, a set of constants is defined to maximize the chances that message is received. These constants can be simplified into two parts: a retransmission counter and an initial timeout.
The retransmission counter is the number of attempts to send until the communication is considered as failed. The initial timeout is the number of second to wait for a response before resending the message.</p>
<p>The algorithm is as follows: when the initial timeout is triggered and the retransmission counter is less than the maximum retransmission number, the message is retransmitted, the retransmission counter is incremented, and the timeout is doubled. If the retransmission counter reaches the maximum retransmission number on a timeout, then the attempt to transmit the message is canceled and the application process is notified of the failure. On the other hand, if the endpoint receives a response in time, transmission is considered successful.</p>
<p>In IOWA, it means:</p>
<ul>
<li>On server side: when an operation is performed, such as for a LwM2M Server a Read operation, if the message is not received by the client, the callback <a href="#serverapi-iowa_result_callback_t"><code>iowa_result_callback_t</code></a> will be called with <em>status</em> sets to IOWA_COAP_503_SERVICE_UNAVAILABLE.</li>
<li>On client side: if a Confirmable message is not acknowledged by the LwM2M Server such as the registration message, the registration update message, or a confirmable notification, the connection is considered lost. In case of registration or registration update, the callback <a href="#clientapi-iowa_event_callback_t"><code>iowa_event_callback_t</code></a> will be called with <em>eventP-&gt;eventType</em> sets to IOWA_EVENT_REG_FAILED and the function <a href="#commonapi-iowa_step"><code>iowa_step</code></a> will exit by returning IOWA_COAP_503_SERVICE_UNAVAILABLE. On the other hand, if a confirmable notification is not acknowledged, the LwM2M Client deactivates the Server Account until the connection is reestablished, that is, an Acknowledge is received on a Confirmable message.</li>
<li>On both side: if the Platform layer returns a negative value on <a href="#abstractionlayer-iowa_system_connection_send"><code>iowa_system_connection_send</code></a>, <a href="#abstractionlayer-iowa_system_connection_recv"><code>iowa_system_connection_recv</code></a> or <a href="#abstractionlayer-iowa_system_connection_select"><code>iowa_system_connection_select</code></a>, the connection will be considered lost.</li>
</ul>
<h3 id="network-client-registration-in-lwm2m-11">Client Registration in LwM2M 1.1</h3>
<p>In LwM2M 1.0 the registration procedure is very simple: either the registration is successful or it failed.</p>
<p>In LwM2M 1.1 a new registration procedure was introduced with multiple registration attempts and a increasing delay between attempts. For more details, see the section 6.2.1.1. "Bootstrap and LwM2M Server Registration Mechanisms" of the <a href="https://www.openmobilealliance.org/release/LightweightM2M/V1_1_1-20190617-A/OMA-TS-LightweightM2M_Core-V1_1_1-20190617-A.pdf">LwM2M 1.1 Core TS</a>.</p>
<p>The default number of attempts is set to 5. The default timer between attempts is set to 60 seconds and doubles after each failed registration.</p>
<p>There are three different ways to configure it:</p>
<ol>
<li>at IOWA build time.</li>
</ol>
<p>You can completely remove this behavior by setting the compilation flags <a href="#configuration-server"><strong>IOWA_SERVER_RSC_REGISTRATION_BEHAVIOUR_REMOVE</strong></a> and <a href="#configuration-server"><strong>IOWA_SERVER_RSC_COMMUNICATION_ATTEMPTS_REMOVE</strong></a>.</p>
<p>You can also change the default values <strong>IOWA_SERVER_ACCOUNT_DEFAULT_COMM_RETRY_COUNT_VALUE</strong>, <strong>IOWA_SERVER_ACCOUNT_DEFAULT_COMM_RETRY_TIMER_VALUE</strong>, <strong>IOWA_SERVER_ACCOUNT_DEFAULT_COMM_SEQUENCE_DELAY_VALUE</strong>, and <strong>IOWA_SERVER_ACCOUNT_DEFAULT_COMM_SEQUENCE_COUNT_VALUE</strong> defined in iowa_client.h</p>
<ol>
<li>from the application.</li>
</ol>
<p>The APIs <a href="#clientapi-iowa_client_set_server_registration_behaviour"><code>iowa_client_set_server_registration_behaviour()</code></a> and <a href="#clientapi-iowa_client_set_server_communication_attempts"><code>iowa_client_set_server_communication_attempts()</code></a> are controlling the registration settings.</p>
<ol>
<li>by the LwM2M Server (or the LwM2M Bootstrap Server).</li>
</ol>
<p>The LwM2M Server can write in the LwM2M Server Object (ID: 1) the resources 14 to 20 detailed below:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Resource Name</th>
<th>Access Type</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>14</td>
<td>Initial Registration Delay Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay before registration is attempted for this LwM2M Server based upon the completion of registration of the previous LwM2M Server in the registration order.</td>
</tr>
<tr>
<td>15</td>
<td>Registration Failure Block</td>
<td></td>
<td>No</td>
<td>Boolean</td>
<td>Prevent or not the registration on the next LwM2M Server when the registration fails to connect with this LwM2M server.</td>
</tr>
<tr>
<td>16</td>
<td>Bootstrap on Registration Failure</td>
<td></td>
<td>No</td>
<td>Boolean</td>
<td>Initiate a Bootstrap Request or not when the registration fails to connect with this LwM2M server.</td>
</tr>
<tr>
<td>17</td>
<td>Communication Retry Count</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The number of successive communication attempts before which a communication sequence is considered as failed.</td>
</tr>
<tr>
<td>18</td>
<td>Communication Retry Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay between successive communication attempts in a communication sequence.</td>
</tr>
<tr>
<td>19</td>
<td>Communication Sequence Delay Timer</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The delay between successive communication sequences.</td>
</tr>
<tr>
<td>20</td>
<td>Communication Sequence Retry Count</td>
<td></td>
<td>No</td>
<td>Unsigned Integer</td>
<td>The number of successive communication sequences before which a registration attempt is considered as failed.</td>
</tr>
</tbody>
</table>
<h3 id="network-sms-specific-behaviors">SMS specific behaviors</h3>
<h4 id="network-msisdn-fallback">MSISDN Fallback</h4>
<p>There is a MSISDN fallback for the Client when the connection can't be established on a Registration message or a Registration Update message is not acknowledged.</p>
<p>This fallback can be activated with the define <a href="#configuration-transports"><code>IOWA_SMS_SUPPORT</code></a> and by providing the LwM2M Server MSISDN number with <a href="#clientapi-iowa_client_set_server_msisdn"><code>iowa_client_set_server_msisdn</code></a>. In that case, if the LwM2M Client cannot reach a LwM2M Server, IOWA will close the current connection before opening a new SMS connection to try to register with this transport. On this second attempt, if the LwM2M Client has again no response from the LwM2M Server, <a href="#commonapi-iowa_step"><code>iowa_step</code></a> will exit by returning IOWA_COAP_503_SERVICE_UNAVAILABLE.</p>
<p><img alt="MSISDN Fallback" src="images/msisdn_fallback.png" /></p>
<h4 id="network-registration-update-trigger-message">Registration Update Trigger message</h4>
<p>On the LwM2M Server side when an operation is not acknowledged by the LwM2M Client, the Server can generate a Registration Update Trigger message with <a href="#serverapi-iowa_server_create_registration_update_trigger_message"><code>iowa_server_create_registration_update_trigger_message</code></a>. This message has to be sent by SMS to the Client.</p>
<p>For this purpose, the Client must at least on its Registration message give its MSISDN number. This MSISDN number can be provided to IOWA when calling <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure</code></a> and setting <em>infoP-&gt;msisdn</em>. Last but not least, the Client has to listen on incoming SMS messages. If a message is received out of bound, the Client has to call <a href="#clientapi-iowa_client_new_incoming_connection"><code>iowa_client_new_incoming_connection</code></a>. If the message received is a Registration Update Trigger, IOWA will automatically sends a Registration Update using the Client preferred binding.</p>
<p><img alt="Registration Update Trigger" src="images/registration_update_trigger.png" /></p>
<h2 id="network-network-reachability">Network reachability</h2>
<p>The LwM2M Server should always be present. But this is not the case for the LwM2M Client. There are multiple reasons for a LwM2M Client not to be available.</p>
<ol>
<li>
<p>A LwM2M Server can deactivate the connection with a LwM2M Client for a certain period. This mechanism can be triggered by executing the resource Disable (ID: 4) of the <a href="#lwm2moverview-server-object"><code>Server Object</code></a>. The LwM2M Server Account will be disabled for a certain period defined in the Disabled Timeout Resource (ID: 5).
After receiving the Execute operation, LwM2M Client must perform the deregistration process, and underlying network connection between the LwM2M Client and LwM2M Server must be disconnected to disable the LwM2M Server account. After the above process, the LwM2M Client must not send any message to the Server and ignore all the messages from the LwM2M Server for the period.
Once the disabled timeout expires, the client restarts the registration process to reconnect to the LwM2M Server.</p>
</li>
<li>
<p>In LwM2M, there is a mechanism called Queue Mode which offers functionality for a LwM2M Client to inform the LwM2M Server that it may be disconnected for an extended period and when it becomes reachable again.
When the LwM2M Client is not reachable, the LwM2M Server does not immediately send downlink requests, but instead waits until the LwM2M Client becomes reachable again.</p>
</li>
</ol>
<h3 id="network-flow">Flow</h3>
<p><img alt="Device Management with Queue Mode" src="images/dm_se_interface_exchanges_queue_mode.png" /></p>
<p>A typical Queue Mode sequence follows the steps listed below:</p>
<ul>
<li>The LwM2M Client registers to the LwM2M Server and requests the LwM2M Server to run in Queue mode.</li>
<li>The LwM2M Client should use the CoAP constant MAX_TRANSMIT_WAIT (93 seconds) to set a timer for how long it shall stay awake after sending a message to the LwM2M Server. After the timeout expires without any messages from the LwM2M Server, the LwM2M Client enters sleep mode.</li>
<li>At some point in time the LwM2M Client wakes up again and transmits a registration update message. Note: During the time the LwM2M Client has been sleeping the IP address assigned to it may have been released and/or existing NAT bindings may have been released. If this is the case, then the client needs to re-run the TLS/DTLS handshake with the LwM2M Server since an IP address and/or port number change will destroy the existing security context.</li>
<li>When the LwM2M Server receives a message from the Client, it determines if any messages need to be sent to the LwM2M Client, as instructed by the Application Server.</li>
</ul>
<h3 id="network-iowa-api">IOWA API</h3>
<p>IOWA introduces two APIs to handle the Queue Mode: <a href="#commonapi-iowa_flush_before_pause"><code>iowa_flush_before_pause</code></a> and <a href="#clientapi-iowa_client_send_heartbeat"><code>iowa_client_send_heartbeat</code></a>.</p>
<p><a href="#commonapi-iowa_flush_before_pause"><code>iowa_flush_before_pause</code></a> is used to inform the LwM2M stack that the device will pause. <code>iowa_flush_before_pause()</code> performs all the pending and required operations of the LwM2M stack engine before returning. It means that if the registration lifetime expires during the device sleep, IOWA will send a registration update before returning from this function. When waking up, the LwM2M Client is connected again to the LwM2M Server.
This function also returns a parameter <em>delayP</em> to indicate when the next scheduled IOWA operation is.</p>
<p><a href="#clientapi-iowa_client_send_heartbeat"><code>iowa_client_send_heartbeat</code></a> is used to send an heartbeat message to a LwM2M Server. Depending of the transport, the heartbeat sent can be a CoAP Empty message on LoRaWAN, or a registration update message for others transports.</p>
<p>Below an example in pseudo-code to use these APIs:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;iowa_client.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">     * Initialization</span>
<span class="cm">     */</span><span class="w"></span>

<span class="w">    </span><span class="n">iowaH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IOWA_Sample_QM_Client&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="mi">1234</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;coap://localhost:5683&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="n">IOWA_SEC_NONE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">     * &quot;Main loop&quot;</span>
<span class="cm">     */</span><span class="w"></span>

<span class="w">    </span><span class="k">do</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">iowaDelay</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Run for 93 seconds</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">93</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Prepare to stand by for 60 minutes</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_flush_before_pause</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">3600</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">iowaDelay</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iowaDelay</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3600</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">STAND_BY</span><span class="p">(</span><span class="n">iowaDelay</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">STAND_BY</span><span class="p">(</span><span class="mi">3600</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_client_send_heartbeat</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_remove_server</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">(</span><span class="n">iowaH</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>In the above example, after calling <a href="#commonapi-iowa_flush_before_pause"><code>iowa_flush_before_pause</code></a>, there are two possibilities:</p>
<ul>
<li><em>iowaDelay</em> is inferior to the requested stand by time. It means that on next <a href="#commonapi-iowa_step"><code>iowa_step</code></a> call, IOWA will send to the Server a message such as notification, registration update, etc. So, the Server will notice the device wake up and send back any buffered requests.</li>
<li>Or, <em>iowaDelay</em> is equal to the requested stand by time. In that case, IOWA has nothing to send on next iowa_step() turn. To inform the Server that the device is awake, <a href="#clientapi-iowa_client_send_heartbeat"><code>iowa_client_send_heartbeat</code></a> needs to be called.</li>
</ul></section><section class="print-page" id="porting"><h1 id="porting-porting-iowa">Porting IOWA</h1>
<p>IOWA has been designed to be easily ported to a new platform. All functions contained in the <a href="#abstractionlayer"><code>System Abstraction Layer</code></a> are specific to a platform:</p>
<ul>
<li>Allocating / Freeing memory,</li>
<li>Getting the time,</li>
<li>Rebooting,</li>
<li>Sending / Receiving network messages,</li>
<li>Storing and retrieving the security keys,</li>
<li>And, so on.</li>
</ul>
<p>FreeRTOS will be used here to explain the porting of IOWA on a platform.</p>
<h2 id="porting-freertos-configuration">FreeRTOS configuration</h2>
<p>FreeRTOS has multiple levels to handle the memory allocation:</p>
<ul>
<li>Heap 1: The basic memory allocation, does not permit a free,</li>
<li>Heap 2: Permits memory to be freed, but without coalescence adjacent free blocks,</li>
<li>Heap 3: Works in the same way as malloc and free and handles thread safety,</li>
<li>Heap 4: Includes the coalescence adjacent free blocks,</li>
<li>Heap 5: Adds the ability to span the heap across multiple non-adjacent memory areas.</li>
</ul>
<p>Since IOWA needs to allocate and deallocate memory, the heap 2 is the minimum requirement. But the recommended heap to use with IOWA is heap 4.</p>
<p>Moreover, the recommended configuration of <code>FreeRTOSConfig.h</code> is (not all the defines are provided):</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define configUSE_16_BIT_TICKS           0</span>
<span class="cp">#define configUSE_MUTEXES                1</span>
<span class="cp">#define configSUPPORT_STATIC_ALLOCATION  0</span>
<span class="cp">#define configSUPPORT_DYNAMIC_ALLOCATION 1</span>
<span class="cp">#define configTOTAL_HEAP_SIZE            ((size_t)14000)</span>
<span class="cp">#define configAPPLICATION_ALLOCATED_HEAP 0</span>

<span class="cp">#define INCLUDE_vTaskDelay 1</span>
</code></pre></div>
<h2 id="porting-first-step">First step</h2>
<p>To begin, create an empty FreeRTOS project with just the main task to start the scheduler:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;FreeRTOS.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;task.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;semphr.h&quot;</span><span class="cp"></span>

<span class="cp">#define INFINITE_LOOP() while (1);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Start the scheduler</span>
<span class="w">    </span><span class="n">vTaskStartScheduler</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// We should never get here as control is now taken by the scheduler</span>
<span class="w">    </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Generally, IOWA needs two threads to have a working LwM2M Client, but depending of the use case, more threads can be added:</p>
<ul>
<li>The first thread is dedicated to run IOWA and let it handle the LwM2M / CoAP stacks,</li>
<li>The other threads are dedicated for the system tasks: measurement, actuator, etc.</li>
</ul>
<p>You can refer to the part of the documentation <a href="#multithread"><code>IOWA Multithread Environment</code></a> to have additional information about how IOWA behaves in a multithread environment.</p>
<h2 id="porting-platform-abstraction">Platform abstraction</h2>
<p>Before continuing the IOWA platform functions have to be implemented:</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SemaphoreHandle_t</span><span class="w"> </span><span class="n">globalMutex</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">platform_user_data_t</span><span class="p">;</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">initPlatform</span><span class="p">(</span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">platformUserDataP</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">platformUserDataP</span><span class="o">-&gt;</span><span class="n">globalMutex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xSemaphoreCreateMutex</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">platformUserDataP</span><span class="o">-&gt;</span><span class="n">globalMutex</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pvPortMalloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vPortFree</span><span class="p">(</span><span class="n">pointer</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int32_t</span><span class="w"> </span><span class="nf">iowa_system_gettime</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_reboot</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant or can be a stub function</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_trace</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">va_list</span><span class="w"> </span><span class="n">varArgs</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant or can be a stub function</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_connection_open</span><span class="p">(</span><span class="n">iowa_connection_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_close</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_send</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_recv</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">connArray</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">connCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_interrupt_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Platform dependant</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_lock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">platformUserDataP</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">platformUserDataP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userData</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">platformUserDataP</span><span class="o">-&gt;</span><span class="n">globalMutex</span><span class="p">,</span><span class="w"> </span><span class="n">portMAX_DELAY</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_unlock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">platformUserDataP</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">platformUserDataP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userData</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">platformUserDataP</span><span class="o">-&gt;</span><span class="n">globalMutex</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="porting-tasks-management">Tasks management</h2>
<p>We can now update the main function to create our two tasks:</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SemaphoreHandle_t</span><span class="w"> </span><span class="n">initMutex</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">tempSensorId</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_user_data_t</span><span class="p">;</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_task</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Task dedicated for IOWA operations</span>
<span class="w">    </span><span class="n">iowa_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">iowaUserDataP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">platform_user_data_t</span><span class="w"> </span><span class="n">platformUserData</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">initPlatform</span><span class="p">(</span><span class="o">&amp;</span><span class="n">platformUserData</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowaUserDataP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">argument</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialize the IOWA context</span>
<span class="w">    </span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_init</span><span class="p">(</span><span class="n">platformUserData</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialize the Client context</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IOWA_Client_FreeRTOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Add a server</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;coap://127.0.0.1:5683&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3600</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_SEC_NONE</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Add a sensor object</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_IPSO_add_sensor</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_IPSO_TEMPERATURE</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cel&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mf">-20.0</span><span class="p">,</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">tempSensorId</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">xSemaphoreGive</span><span class="p">(</span><span class="n">iowaUserData</span><span class="o">-&gt;</span><span class="n">initMutex</span><span class="p">);</span><span class="w"> </span><span class="c1">// Synchronization</span>

<span class="w">    </span><span class="c1">// Start the IOWA step</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// We should never get here as control is now taken by IOWA</span>
<span class="w">    </span><span class="n">INFINITE_LOOP</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">system_task</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Task dedicated for system operations</span>
<span class="w">    </span><span class="n">iowa_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">iowaUserDataP</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">iowaUserDataP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_user_data_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">argument</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">xSemaphoreTake</span><span class="p">(</span><span class="n">iowaUserData</span><span class="o">-&gt;</span><span class="n">initMutex</span><span class="p">,</span><span class="w"> </span><span class="n">portMAX_DELAY</span><span class="p">);</span><span class="w"> </span><span class="c1">// Synchronization</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">newValue</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">newValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GET_TEMPERATURE_VALUE</span><span class="p">();</span><span class="w"></span>

<span class="w">        </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">iowa_client_IPSO_update_value</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">tempSensorId</span><span class="p">,</span><span class="w"> </span><span class="n">newValue</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">vTaskDelay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_user_data_t</span><span class="w"> </span><span class="n">iowaUserData</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create the init semaphore</span>
<span class="w">    </span><span class="n">iowaUserData</span><span class="o">-&gt;</span><span class="n">initMutex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xSemaphoreCreateMutex</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create the tasks for IOWA</span>
<span class="w">    </span><span class="n">xTaskCreate</span><span class="p">((</span><span class="n">TaskFunction_t</span><span class="p">)</span><span class="n">iowa_task</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;iowa&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">iowaUserData</span><span class="p">,</span><span class="w"> </span><span class="n">tskIDLE_PRIORITY</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">xTaskCreate</span><span class="p">((</span><span class="n">TaskFunction_t</span><span class="p">)</span><span class="n">system_task</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;system&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">iowaUserData</span><span class="p">,</span><span class="w"> </span><span class="n">tskIDLE_PRIORITY</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Start the scheduler</span>
<span class="w">    </span><span class="n">vTaskStartScheduler</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// We should never get here as control is now taken by the scheduler</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Infinite loop</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="porting-error-handling">Error handling</h2>
<p>Now everything is working, error handling have to put in place in case something went wrong:</p>
<ul>
<li>Failed to initialize the IOWA stack,</li>
<li>Failed to connect to a LwM2M Server,</li>
<li>And, so on.</li>
</ul>
<p>IOWA can report events to the Application to inform about internal states such as connection to a LwM2M, new observation started or removed, etc.</p>
<p>These events are reported through the callback <a href="#clientapi-iowa_event_callback_t"><code>iowa_event_callback_t</code></a>, this callback is given when calling the API <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">eventCb</span><span class="p">(</span><span class="n">iowa_event_t</span><span class="o">*</span><span class="w"> </span><span class="n">eventP</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">eventP</span><span class="o">-&gt;</span><span class="n">eventType</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nl">IOWA_EVENT_REG_FAILED</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Remove then re-add the Server in case the Client wasn&#39;t able to reach it</span>
<span class="w">        </span><span class="n">iowa_client_remove_server</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;coap://127.0.0.1:5683&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3600</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_SEC_NONE</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">default</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Do nothing for the other events</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_task</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="k">const</span><span class="o">*</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaUserDataP</span><span class="o">-&gt;</span><span class="n">contextP</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IOWA_Client_FreeRTOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">eventCb</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></section><section class="print-page" id="lorawan"><h1 id="lorawan-iowa-over-lorawan">IOWA over LoRaWAN</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section>
                        <h2 class='nav-section-title' id='section-tools'>
                            Tools <a class='headerlink' href='#section-tools' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="object_skeleton_generator"><h1 id="object_skeleton_generator-object-skeleton-generator">Object Skeleton Generator</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: Tools</h1><h1 class='nav-section-title-end'>Ended: User Manual</h1>
                        <h1 class='nav-section-title' id='section-samples'>
                            Samples <a class='headerlink' href='#section-samples' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="baseline_client"><h1 id="baseline_client-baseline-client">Baseline Client</h1>
<p>This is a minimal LwM2M Client connecting to one LwM2M Server and featuring only the mandatory LwM2M Objects.</p>
<p>The following API will be explained:</p>
<ul>
<li><code>iowa_init()</code></li>
<li><code>iowa_close()</code></li>
<li><code>iowa_client_configure()</code></li>
<li><code>iowa_client_add_server()</code></li>
<li><code>iowa_client_remove_server()</code></li>
<li><code>iowa_step()</code></li>
</ul>
<h2 id="baseline_client-usage">Usage</h2>
<p>To compile this sample, follow the instructions in the top-level README.</p>
<blockquote>
<p><em>baseline_client</em> outputs traces in <code>stderr</code>.</p>
</blockquote>
<p>At launch, <em>baseline_client</em> displays the URI of the LwM2M Server it connects to, and the Endpoint Name it uses.</p>
<div class="highlight"><pre><span></span><code>$ ./Evaluation_SDK_Samples/01-baseline_client/baseline_client
This a simple LwM2M Client.

Registering to the LwM2M server at &quot;coap://iowa-server.ioterop.com&quot; under the Endpoint name &quot;IOWA_sample_client_8323329&quot;.
Use Ctrl-C to stop.
</code></pre></div>
<p>It then registers to the LwM2M Server. You should see it in the "Clients List" of the Server:</p>
<p><img alt="Client registered" src="images/baseline_client.jpg" /></p>
<blockquote>
<p>We are using IoTerop's <a href="https://iowa-server.ioterop.com/">CONNECTicut</a> testing server. The procedures are similar using other servers.</p>
</blockquote>
<p>Two LwM2M Objects are visible to the LwM2M Server: the Server Object (ID: 1) configuring parameters associated to the LwM2M Server, and the Device Object (ID: 3) describing the device.</p>
<p>From here, you can perform Discover, Read, and Write-Attributes operations, or set Observations on the Objects, Object Instances, and Resources. You can perform Write operations on some of the Server Object's Resources.</p>
<p>You can also perform an Execute operation on the Reboot Resource of the Device Object (URI: /3/0/4). Note that will make <em>baseline_client</em> exit.</p>
<p>After two minutes, <em>baseline_client</em> unregisters from the LwM2M Server.</p>
<h2 id="baseline_client-breakdown">Breakdown</h2>
<h3 id="baseline_client-client-pseudo-code">Client Pseudo Code</h3>
<p>This is the pseudo code of Client main function:</p>
<div class="highlight"><pre><span></span><code><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Initialization</span>
<span class="w">    </span><span class="n">iowa_init</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Client configuration</span>
<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">CLIENT_NAME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Server declaration</span>
<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// &quot;Main loop&quot;</span>
<span class="w">    </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">120</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Cleanup</span>
<span class="w">    </span><span class="n">iowa_client_remove_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="baseline_client-initialization">Initialization</h3>
<p>IOWA does not use any global variables. All its internal data are stored in an context. Thus the first step of  the LwM2M Client application is to create a new IOWA context by calling the API <code>iowa_init()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">;</span><span class="w"></span>

<span class="n">iowaH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<blockquote>
<p>The argument to <code>iowa_init()</code> is an user defined pointer passed to the system abstraction function. For more information, look at the <em>abstraction_layer</em> folder.</p>
</blockquote>
<h3 id="baseline_client-lwm2m-client-configuration">LwM2M Client Configuration</h3>
<p>The second step is to configure our LwM2M Client with <code>iowa_client_configure()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kt">char</span><span class="w"> </span><span class="n">endpoint_name</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span><span class="w"></span>
<span class="n">iowa_device_info_t</span><span class="w"> </span><span class="n">devInfo</span><span class="p">;</span><span class="w"></span>
<span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="n">prv_generate_unique_name</span><span class="p">(</span><span class="n">endpoint_name</span><span class="p">);</span><span class="w"></span>

<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">devInfo</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">iowa_device_info_t</span><span class="p">));</span><span class="w"></span>
<span class="n">devInfo</span><span class="p">.</span><span class="n">manufacturer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://ioterop.com&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">devInfo</span><span class="p">.</span><span class="n">deviceType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IOWA sample from https://github.com/IOTEROP/IOWA&quot;</span><span class="p">;</span><span class="w"></span>
<span class="n">devInfo</span><span class="p">.</span><span class="n">modelNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1-simple_client&quot;</span><span class="p">;</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">endpoint_name</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">devInfo</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>The first argument is the IOWA context created in the previous step.</p>
<p>The second argument is the LwM2M Client endpoint name. As this sample does not use security, the LwM2M Server relies only on this endpoint name to identify the LwM2M Client. In this sample, the function <code>prv_generate_unique_name()</code> generates such an unique name from the computer ID on Linux or from the "C:" volume serial number on Windows.</p>
<p>The third argument may contain the values of the resources exposed by the Client in its LwM2M Device Object (ID: 3). This argument is optional. If this argument is not present or if some of its members are not set, the matching Resources will not be presented by the Client to the LwM2M Server.</p>
<p>The last argument is an optional event callback explained in another sample.</p>
<h3 id="baseline_client-lwm2m-server-declaration">LwM2M Server Declaration</h3>
<p>Finally, to configure a LwM2M Server on the Client, the API <code>iowa_client_add_server()</code> has to be called.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#define SERVER_SHORT_ID 1234</span>
<span class="cp">#define SERVER_LIFETIME   50</span>
<span class="cp">#define SERVER_URI      &quot;coap:</span><span class="c1">//iowa-server.ioterop.com&quot;</span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_SEC_NONE</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>The first argument is the IOWA context created in the first step.</p>
<p>The second argument is an numeric identifier of the LwM2M Server. This identifier is named "Short Server ID" in the LwM2M protocol. Other IOWA APIs use this identifier to reference the LwM2M Server.</p>
<p>The third argument is the LwM2M Server URI. By default the baseline Client has been configured to use IoTerop's <a href="https://iowa-server.ioterop.com/">CONNECTicut</a> testing server. You can change the URI to point to other LwM2M Servers like the Eclipse's <a href="https://leshan.eclipseprojects.io/#/clients">Leshan test server sandbox</a>, or a locally deployed LwM2M Server.</p>
<p>The fourth argument is the registration lifetime in seconds. The LwM2M lifetime is the validity period of a LwM2M Client registration to the LwM2M Server. When this lifetime expires, the Server considers the Client as unreachable. Regularly, the Client sends Registration Update messages to the Server to renew its registration validity period.</p>
<p>The fifth argument is composed of flags enabling advanced features which are explained in other samples.</p>
<p>The last argument is the security mode used to communicate with the LwM2M Server. See the security sample for more details.</p>
<h3 id="baseline_client-main-loop">"Main Loop"</h3>
<p>IOWA operates only when the function <code>iowa_step()</code> is called.</p>
<p><code>iowa_step()</code> manages the Finite State Machine of the LwM2M and CoAP stacks.</p>
<p>On first loop, IOWA will create a new socket and use it to transmit the registration message.</p>
<div class="highlight"><pre><span></span><code><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument is the IOWA context created in the first step.</p>
<p>The second argument is the time allowed to IOWA to run. Until this time expires, or an error occurs, the <code>iowa_step()</code> function does not return. Here we let IOWA run for two minutes before stopping the Client. The other samples have more realistic usage of this argument.</p>
<h3 id="baseline_client-cleanup">Cleanup</h3>
<p>When the Client has to be closed, the IOWA context must be freed to prevent memory leaks.</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_client_remove_server</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_SHORT_ID</span><span class="p">);</span><span class="w"></span>
<span class="n">iowa_close</span><span class="p">(</span><span class="n">iowaH</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>First, the Server can be removed with <code>iowa_client_remove_server()</code>. Calling this API will automatically send a deregistration message to the Server even if the IOWA step is not running. Here we use the LwM2M Server identifier passed in <code>iowa_client_add_server()</code>.</p>
<p>Finally, the IOWA context can be closed with <code>iowa_close()</code>.</p>
<h2 id="baseline_client-next-steps">Next Steps</h2>
<p>To fulfill real-world needs, a LwM2M Client needs application LwM2M Objects. You can look at the <a href="#ipso_client">IPSO_client</a> sample to learn how to add IPSO sensors, or at the <a href="#custom_object_baseline">custom_object_baseline</a> sample to learn how to add a custom LwM2M Object to your Client.</p></section>
                        <h2 class='nav-section-title' id='section-lwm2m-objects-samples'>
                            LwM2M Objects Samples <a class='headerlink' href='#section-lwm2m-objects-samples' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="ipso_client"><h1 id="ipso_client-ipso-object-client">IPSO Object Client</h1>
<p>This is the <a href="#baseline_client">Baseline Client</a> featuring an additional IPSO Temperature Object (ID: 3303).</p>
<p>Among the IPSO-defined Objects, several of them, representing ambient sensors, have the same Resources. IOWA provides a single set of APIs to manipulate these Objects.</p>
<p>The following API will be explained:</p>
<ul>
<li><code>iowa_client_IPSO_add_sensor()</code></li>
<li><code>iowa_client_IPSO_update_value()</code></li>
<li><code>iowa_client_IPSO_remove_sensor()</code></li>
</ul>
<h2 id="ipso_client-usage">Usage</h2>
<p>The usage is the same as the Baseline Client sample.</p>
<p>When registered to the LwM2M Server, you will notice that the <em>IPSO_client</em> features an additional LwM2M IPSO Temperature Object (ID: 3303). This Temperature Object presents several Resources:</p>
<p><img alt="IPSO Temperature" src="images/IPSO_client.jpg" /></p>
<p><em>IPSO_client</em> updates the "Sensor Value" each three seconds, cycling between the values 20, 21, 22, and 23.</p>
<p>If you set up an Observation on this Object, the basic view will present such a graph:</p>
<p><img alt="IPSO Temperature graph" src="images/IPSO_client_graph.jpg" /></p>
<p>After two minutes, <em>IPSO_client</em> unregisters from the LwM2M Server.</p>
<h2 id="ipso_client-breakdown">Breakdown</h2>
<h3 id="ipso_client-client-pseudo-code">Client Pseudo Code</h3>
<p>This is the pseudo code of Client main function:</p>
<div class="highlight"><pre><span></span><code><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Initialization</span>
<span class="w">    </span><span class="n">iowa_init</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Client configuration</span>
<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">CLIENT_NAME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// IPSO Temperature Object enabling</span>
<span class="w">    </span><span class="n">iowa_client_IPSO_add_sensor</span><span class="p">(</span><span class="n">IOWA_IPSO_TEMPERATURE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Server declaration</span>
<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// &quot;Main loop&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="mi">120</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_IPSO_update_value</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Cleanup</span>
<span class="w">    </span><span class="n">iowa_client_remove_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="ipso_client-initialization">Initialization</h3>
<p>This step is the same as in the Baseline Client sample.</p>
<h3 id="ipso_client-lwm2m-client-configuration">LwM2M Client Configuration</h3>
<p>This step is the same as in the Baseline Client sample.</p>
<h3 id="ipso_client-ipso-temperature-object-enabling">IPSO Temperature Object Enabling</h3>
<p>Here we add a Temperature sensor to the LwM2M Client.</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">sensorId</span><span class="p">;</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_IPSO_add_sensor</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_IPSO_TEMPERATURE</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Test Temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">-20.0</span><span class="p">,</span><span class="w"> </span><span class="mf">50.0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sensorId</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument is the IOWA context created in the Initialization step.</p>
<p>The second argument is the type of the sensor.</p>
<p>The third argument is the initial value of the sensor. Depending on the sensor type, it is interpreted as a floating-point value, an integer, or a boolean.</p>
<p>The fourth argument is an optional human readable representation of the unit used by the sensor. It has not impact on the behavior of the Object.</p>
<p>The fifth argument is also an optional human readable string known as the "Application Type". It is useful for the LwM2M Server to discriminate between the sensors if the Client features several sensors of the same type. Note that not all sensor Objects feature this resource.</p>
<p>The sixth and seventh arguments are the minimum and maximum values that can be measured by the sensor. This arguments are also optional. If they are both set to zero, the matching resources are not exposed by the Temperature Object Instance.</p>
<p>The last argument is used to store the sensor identifier generated by IOWA. This identifier is used in other APIs.</p>
<h3 id="ipso_client-lwm2m-server-declaration">LwM2M Server Declaration</h3>
<p>This step is the same as in the Baseline Client sample.</p>
<h3 id="ipso_client-main-loop">"Main Loop"</h3>
<p>The Baseline Client sample was letting IOWA run for two minutes before exiting. Here, during these two minutes, we let IOWA run for three seconds then we update the sensor value.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_IPSO_update_value</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">sensorId</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The call to <code>iowa_step()</code> is the same as in the Simple Client sample with a different time value.</p>
<p>The call to <code>iowa_client_IPSO_update_value()</code> informs IOWA that the value measured by the sensor has changed.</p>
<p>As always, the first argument is the IOWA context created in the Initialization step.</p>
<p>The second argument is the identifier of the sensor, retrieved from the call to <code>iowa_client_IPSO_add_sensor()</code>.</p>
<p>The last argument is the value measured by the sensor. Depending on the sensor type, it is interpreted as a floating-point value, an integer, or a boolean. Here we are using a simulated value.</p>
<p>IOWA takes care of all the operations performed by the LwM2M Server on the Object Instance: Read, Write and Observations.</p>
<h3 id="ipso_client-cleanup">Cleanup</h3>
<p>This step is the same as in the Baseline Client sample with one additional function call:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">sensorId</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument is the IOWA context created in the Initialization step.</p>
<p>The second argument is the identifier of the sensor, retrieved from the call to <code>iowa_client_IPSO_add_sensor()</code>.</p>
<h2 id="ipso_client-next-steps">Next Steps</h2>
<p>IOWA implements a lot of LwM2M Objects natively and provides high-level APIS to feature them in your LwM2M Client. Samples for these can be found among the full SDK samples.</p>
<p>If you want to implement your own LwM2M Objects, look at the Custom Object samples.</p></section><section class="print-page" id="bearer_selection_client"><h1 id="bearer_selection_client-bearer-selection-client">Bearer Selection Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="mqtt_objects_client"><h1 id="mqtt_objects_client-mqtt-objects-client">MQTT Objects Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: LwM2M Objects Samples</h1>
                        <h2 class='nav-section-title' id='section-lwm2m-custom-objects-samples'>
                            LwM2M Custom Objects Samples <a class='headerlink' href='#section-lwm2m-custom-objects-samples' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="custom_object_baseline"><h1 id="custom_object_baseline-custom-object-baseline">Custom Object Baseline</h1>
<p>This is the <a href="#baseline_client">baseline_client</a> featuring an additional LwM2M Object with the following definition:</p>
<p><em>ID:</em> <em>3200</em></p>
<p><em>Single instance</em></p>
<p><em>Resources:</em></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Type</th>
<th>Operations</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>5500</td>
<td>Boolean</td>
<td>R</td>
<td>Single</td>
<td>A read-only boolean value</td>
</tr>
<tr>
<td>5750</td>
<td>String</td>
<td>R/W</td>
<td>Single</td>
<td>A writable string</td>
</tr>
<tr>
<td>5503</td>
<td>Integer</td>
<td>R/W</td>
<td>Single</td>
<td>A writable integer value</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In the LightweigthM2M protocol, the Objects and the Resources are only characterized by their ID and there is no metadata exchanges between the LwM2M Clients and the LwM2M Server. This means that the LwM2M Server must know the layout of the Object and the characteristics of their Resources. (Note that the LwM2M Server can perform a Discovery operation on the Object that will return the list of <strong>instantiated</strong> Resources in each Object Instance.)</p>
<p>When designing a custom Object for your application, you must communicate your Object definition to the LwM2M Server out-of-band. One way to achieve this is by registering your Object to the <a href="https://openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html">OMNA LwM2M Repository</a>.</p>
<p>In this sample we reuse a registered Object: Digital Input (ID: 3200) to make sure it is known by the LwM2M Server we are testing with. In a real-world application needing this specific IPSO Object, you can use the <code>iowa_client_IPSO_add_sensor()</code> API.</p>
</blockquote>
<p>The following API will be explained:</p>
<ul>
<li><code>iowa_client_add_custom_object()</code></li>
<li><code>iowa_client_remove_custom_object()</code></li>
</ul>
<h2 id="custom_object_baseline-usage">Usage</h2>
<p>The usage is the same as the Baseline Client sample.</p>
<p>When registered to the LwM2M Server, you will notice that the <em>custom_object_baseline_client</em> features the additional LwM2M Object described above:</p>
<p><img alt="Custom Object Baseline Client" src="images/custom_object_baseline_client.jpg" /></p>
<p>The Resource names displayed by the LwM2M Server are the names registered for the Object with this specific ID at the <a href="https://openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html">OMNA LwM2M Repository</a>. As explained, we are using this Object ID to make sure it is known by the LwM2M Server. Of course, the Resources do not reflect any real process.</p>
<p>From here, you can test the LwM2M operations on the Resources. You will notice that you can not write the "Digital Input State" Resource (URI: /3200/0/5500).</p>
<p>If you set an Observation on the Object or the Object Instance, when you write a new value for the "Digital Input Debounce" Resource (URI: /3200/0/5503) or the "Application Type" Resource (URI: /3200/0/5750), you will receive a notification.</p>
<p>After two minutes, <em>custom_object_baseline_client</em> unregisters from the LwM2M Server.</p>
<h2 id="custom_object_baseline-breakdown">Breakdown</h2>
<h3 id="custom_object_baseline-client-pseudo-code">Client Pseudo Code</h3>
<p>This is the pseudo code of Client main function:</p>
<div class="highlight"><pre><span></span><code><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Initialization</span>
<span class="w">    </span><span class="n">iowa_init</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Client configuration</span>
<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">CLIENT_NAME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Custom Object addition</span>
<span class="w">    </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">resourceDescription</span><span class="p">,</span><span class="w"> </span><span class="n">dataCallback</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Server declaration</span>
<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// &quot;Main loop&quot;</span>
<span class="w">    </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">120</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Cleanup</span>
<span class="w">    </span><span class="n">iowa_client_remove_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and the pseudo code of the Object data callback:</p>
<div class="highlight"><pre><span></span><code><span class="n">dataCallback</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">targetedResources</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">READ</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">WRITE</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="custom_object_baseline-data-structures">Data Structures</h3>
<p>This sample introduces two important data structures of IOWA.</p>
<h4 id="custom_object_baseline-iowa_lwm2m_resource_desc_t">iowa_lwm2m_resource_desc_t</h4>
<p>This data structure is used to describe an LwM2M Object Resource.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">               </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_data_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w">                </span><span class="n">operations</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w">                </span><span class="n">flags</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_resource_desc_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p><code>id</code> is the numerical ID of the Resource. This ID must be unique among the Object Resource IDs.</p>
<p><code>type</code> is the data type of the Resource value.</p>
<p><code>operations</code> is the list of LwM2M operations allowed on the resources. The only allowed combinations are: "IOWA_DM_READ", "IOWA_DM_WRITE", "IOWA_DM_READ | IOWA_DM_WRITE", and "IOWA_DM_EXECUTE".</p>
<p><code>flags</code> will be explained in other samples.</p>
<h4 id="custom_object_baseline-iowa_lwm2m_data_t">iowa_lwm2m_data_t</h4>
<p>This data structure is used to convey the Resource values between IOWA and the Object implementation.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resInstanceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_data_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">bool</span><span class="w">    </span><span class="n">asBoolean</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">asInteger</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">  </span><span class="n">asFloat</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w">   </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">asBuffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w">   </span><span class="n">totalSize</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">details</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">asBlock</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_lwm2m_object_link_t</span><span class="w"> </span><span class="n">asObjLink</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p><code>objectID</code>, <code>instanceID</code>, and <code>resourceID</code> contain the URI of the Resource. Some Resources may have multiple instances. In this case <code>resInstanceID</code> is used, otherwise (like in this sample), it is set to <strong>IOWA_LWM2M_ID_ALL</strong>.</p>
<p><code>type</code> contains the data type of the Resource value.</p>
<p><code>value</code> contains the value of the Resource. It is an union depending on <code>type</code>:</p>
<ul>
<li>
<p><code>value.asBoolean</code> when <code>type</code> is <strong>IOWA_LWM2M_TYPE_BOOLEAN</strong>.</p>
</li>
<li>
<p><code>value.asInteger</code> when <code>type</code> is <strong>IOWA_LWM2M_TYPE_INTEGER</strong>, <strong>IOWA_LWM2M_TYPE_TIME</strong> or <strong>IOWA_LWM2M_TYPE_UNSIGNED_INTEGER</strong>.</p>
</li>
<li>
<p><code>value.asFloat</code> when <code>type</code> is <strong>IOWA_LWM2M_TYPE_FLOAT</strong>.</p>
</li>
<li>
<p><code>value.asBuffer</code> when <code>type</code> is <strong>IOWA_LWM2M_TYPE_CORE_LINK</strong>, <strong>IOWA_LWM2M_TYPE_STRING</strong>, <strong>IOWA_LWM2M_TYPE_OPAQUE</strong> or <strong>IOWA_LWM2M_TYPE_UNDEFINED</strong>.</p>
</li>
<li>
<p><code>value.asObjLink</code> when <code>type</code> is <strong>IOWA_LWM2M_TYPE_OBJECT_LINK</strong>.</p>
</li>
<li>
<p><code>value.asBlock</code> is explained in another sample.</p>
</li>
</ul>
<p><code>timestamp</code> is explained in another sample.</p>
<h3 id="custom_object_baseline-main-function">Main Function</h3>
<h4 id="custom_object_baseline-initialization">Initialization</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_baseline-lwm2m-client-configuration">LwM2M Client Configuration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_baseline-custom-object-addition">Custom Object Addition</h4>
<p>Here we add a custom Object to the LwM2M Client.</p>
<div class="highlight"><pre><span></span><code><span class="n">sample_object_values_t</span><span class="w"> </span><span class="n">objectValues</span><span class="p">;</span><span class="w"></span>
<span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">sample_object_resources</span><span class="p">[</span><span class="n">SAMPLE_RES_COUNT</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5500</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_BOOLEAN</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_OPERATION_READ</span><span class="p">,</span><span class="w">                        </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5750</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_STRING</span><span class="p">,</span><span class="w">  </span><span class="n">IOWA_OPERATION_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_OPERATION_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5503</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_OPERATION_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_OPERATION_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">objectValues</span><span class="p">.</span><span class="n">booleanValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="n">objectValues</span><span class="p">.</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="n">objectValues</span><span class="p">.</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">SAMPLE_RES_COUNT</span><span class="p">,</span><span class="w"> </span><span class="n">sample_object_resources</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">sample_object_dataCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="o">&amp;</span><span class="n">objectValues</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument is the IOWA context created in the Initialization step.</p>
<p>The second argument is the Object numerical ID. This ID must be unique.</p>
<p>The third argument is the number of Instances this Object has, the fourth argument is the list of the IDs of these Instances. This parameter is useful only for multiple-instance Objects. As we do not provide a list of Instances and the instance callback (the eighth parameter) is nil, IOWA consider this Object to be a single-instance one. See the sample custom_object_multiple_instances for more details.</p>
<p>The fifth and sixth arguments are the Object's Resources definition. This is an array of <code>iowa_lwm2m_resource_desc_t</code>.</p>
<p>The seventh argument is the callback IOWA will call when an operation is to be performed on the Object's Resources. It is explained in more details below.</p>
<p>The eighth and ninth arguments are callbacks called by IOWA to manipulate the Object. There are explained in other samples.</p>
<p>The last argument is an user defined pointer passed as argument to the Object callbacks. In this example, it is a structure holding the Object values.</p>
<h4 id="custom_object_baseline-lwm2m-server-declaration">LwM2M Server Declaration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_baseline-main-loop">"Main Loop"</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_baseline-cleanup">Cleanup</h4>
<p>This step is the same as in the Baseline Client sample with one additional function call:</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_client_remove_custom_object</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument is the IOWA context created in the Initialization step.</p>
<p>The second argument is the same ID of the Object as in the call to <code>iowa_client_add_custom_object()</code>.</p>
<h3 id="custom_object_baseline-object-data-callback">Object Data Callback</h3>
<p>when a LwM2M Server perform an operation on our Object, IOWA takes care of all the necessary checks (Resource existence, operation rights, correct datatypes, etc...). The Data Callback deals only with the actual Resource values.</p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">sample_object_dataCallback</span><span class="p">(</span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">iowa_lwm2m_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">dataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">numData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
</code></pre></div>
<p>The parameters to the callback are the operation (<strong>IOWA_DM_READ</strong>, <strong>IOWA_DM_WRITE</strong>, <strong>IOWA_DM_EXECUTE</strong>, or <strong>IOWA_DM_FREE</strong>), an array of <code>iowa_lwm2m_data_t</code>, the user data passed as parameter to <code>iowa_client_add_custom_object()</code>, and the IOWA context.</p>
<p>The first thing we do is retrieving the actual values we stored in the user data:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">sample_object_values_t</span><span class="w"> </span><span class="o">*</span><span class="n">objectValuesP</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Retrieve our Object values</span>
<span class="w">    </span><span class="n">objectValuesP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">sample_object_values_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userData</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Then we iterate over all the targeted Resources:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numData</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">resourceID</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
</code></pre></div>
<p>We do not check <code>dataP[i].objectID</code> and <code>dataP[i].instanceID</code> as the callback is used only by our Object. These need to be considered only when the Object has several instances or if the callback is shared among several custom Objects.</p>
<div class="highlight"><pre><span></span><code><span class="k">case</span><span class="w"> </span><span class="mi">5503</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_DM_READ</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asInteger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">integerValue</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_DM_WRITE</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asInteger</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>For each Resource, if the operation is <strong>IOWA_DM_READ</strong>, we store the Resource value in the <code>iowa_lwm2m_data_t</code>. If the operation is <strong>IOWA_DM_WRITE</strong>, we update the Resource value with the value from the <code>iowa_lwm2m_data_t</code>.</p>
<h4 id="custom_object_baseline-the-iowa_dm_free-operation">The IOWA_DM_FREE Operation</h4>
<p>To handle the <strong>IOWA_DM_READ</strong> case, the callback may allocate memory. For instance the Resource could be the content of a log file. When IOWA has no longer the use of a resource value, it calls the callback with the operation <strong>IOWA_DM_FREE</strong>.</p>
<p>This is illustrated in the sample by the Resource holding a string value (ID: 5750):</p>
<div class="highlight"><pre><span></span><code><span class="k">case</span><span class="w"> </span><span class="mi">5750</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_DM_READ</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// For the sake of the example, we return a copy of our string value.</span>
<span class="w">            </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strdup</span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">buffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">IOWA_COAP_500_INTERNAL_SERVER_ERROR</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_DM_WRITE</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">IOWA_COAP_500_INTERNAL_SERVER_ERROR</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="p">,</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">length</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">objectValuesP</span><span class="o">-&gt;</span><span class="n">stringValue</span><span class="p">[</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">length</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_DM_FREE</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// IOWA has no longer use of the string value. We can free it.</span>
<span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">.</span><span class="n">asBuffer</span><span class="p">.</span><span class="n">buffer</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>When the operation is <strong>IOWA_DM_READ</strong> (and there is a value to return), we allocate a new string and duplicate the value. We pass the pointer to this new string in the <code>iowa_lwm2m_data_t</code>.</p>
<p>Then when the callback is called with <strong>IOWA_DM_FREE</strong>, we can free the duplicate string as the <code>iowa_lwm2m_data_t</code> still holds the pointer to it.</p>
<blockquote>
<p>When handling the <strong>IOWA_DM_READ</strong> case, it is also possible for the callback to just return the pointer to our string value. IOWA will not modify it. In this case, there is nothing to do when the operation is <strong>IOWA_DM_FREE</strong>.</p>
</blockquote>
<h2 id="custom_object_baseline-next-steps">Next Steps</h2>
<p>The sample illustrates only the baseline of the creation of a custom LwM2M Object. The other custom object samples dive into more useful concepts.</p></section><section class="print-page" id="custom_object_dynamic"><h1 id="custom_object_dynamic-dynamic-custom-object">Dynamic Custom Object</h1>
<p>This is the <a href="#custom_object_baseline">Custom Object Baseline Client</a> with dynamic Resource values. The Client still features the same custom LwM2M Object:</p>
<p><em>ID:</em> <em>3200</em></p>
<p><em>Single instance</em></p>
<p><em>Resources:</em></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Type</th>
<th>Operations</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>5500</td>
<td>Boolean</td>
<td>R</td>
<td>Single</td>
<td>A read-only boolean value</td>
</tr>
<tr>
<td>5750</td>
<td>String</td>
<td>R/W</td>
<td>Single</td>
<td>A writable string</td>
</tr>
<tr>
<td>5503</td>
<td>Integer</td>
<td>R/W</td>
<td>Single</td>
<td>A writable integer value</td>
</tr>
</tbody>
</table>
<p>However, the values of the Boolean Resource (ID: 5500) and Integer Resource (ID: 5503) will change during the execution.</p>
<p>The following API will be explained:</p>
<ul>
<li><code>iowa_client_notification_lock()</code></li>
<li><code>iowa_client_object_resource_changed()</code></li>
</ul>
<h2 id="custom_object_dynamic-usage">Usage</h2>
<p>The usage is the same as the Custom Object Baseline Client sample.</p>
<p>If you set an Observation on the Object or the Object Instance, you will notice that the values of the Boolean Resource (ID: 5500) and Integer Resource (ID: 5503) are updated:</p>
<p><img alt="Custom Object Dynamic Client" src="images/custom_object_dynamic_client.jpg" /></p>
<p>After two minutes, <em>custom_object_dynamic_client</em> unregisters from the LwM2M Server.</p>
<h2 id="custom_object_dynamic-breakdown">Breakdown</h2>
<h3 id="custom_object_dynamic-client-pseudo-code">Client Pseudo Code</h3>
<p>This is the pseudo code of Client main function:</p>
<div class="highlight"><pre><span></span><code><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Initialization</span>
<span class="w">    </span><span class="n">iowa_init</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Client configuration</span>
<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">CLIENT_NAME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Custom Object addition</span>
<span class="w">    </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">resourceDescription</span><span class="p">,</span><span class="w"> </span><span class="n">dataCallback</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Server declaration</span>
<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// &quot;Main loop&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="mi">120</span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Invert</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">value</span><span class="w"></span>
<span class="w">        </span><span class="n">Increment</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">value</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">BOOLEAN_RESOURCE_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">INTEGER_RESOURCE_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Cleanup</span>
<span class="w">    </span><span class="n">iowa_client_remove_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and the pseudo code of the Object data callback:</p>
<div class="highlight"><pre><span></span><code><span class="n">dataCallback</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">targetedResources</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">READ</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">WRITE</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="custom_object_dynamic-main-function">Main Function</h3>
<h4 id="custom_object_dynamic-initialization">Initialization</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_dynamic-lwm2m-client-configuration">LwM2M Client Configuration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_dynamic-custom-object-addition">Custom Object Addition</h4>
<p>This step is the same as in the Custom Object Baseline Client sample.</p>
<h4 id="custom_object_dynamic-lwm2m-server-declaration">LwM2M Server Declaration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_dynamic-main-loop">"Main Loop"</h4>
<p>The Custom Object Baseline Client sample was letting IOWA run for two minutes before exiting. Here, during these two minutes, we let IOWA run for three seconds then we update the boolean and integer values.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">objectValues</span><span class="p">.</span><span class="n">booleanValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">objectValues</span><span class="p">.</span><span class="n">booleanValue</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">objectValues</span><span class="p">.</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objectValues</span><span class="p">.</span><span class="n">integerValue</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_BOOLEAN_RES_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_INTEGER_RES_ID</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_notification_lock</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The call to <code>iowa_step()</code> is the same as in the Baseline Client sample with a different time value.</p>
<p>We invert the boolean and increase the integer in our structure holding the Object values.</p>
<p>The calls to <code>iowa_client_object_resource_changed()</code> inform IOWA that some resource values have changed. As always, the first argument is the IOWA context created in the Initialization step. The second, third, and fourth arguments are the Object ID, Instance ID, and Resource ID of the resource which value has changed. Here we inform IOWA that the values of Resources "/3200/5500" and "/3200/0/5503" has changed.</p>
<p>If these Resources are under observation, either directly or because the Object or Object Instance are under observation, IOWA will first call the Object data callback to retrieve the values. Then IOWA will send a notification.</p>
<p>Here we are calling <code>iowa_client_object_resource_changed()</code> twice. To prevent the generation of two separate notifications in the case the Object or Object Instance are under observation, we call <code>iowa_client_notification_lock()</code>.</p>
<p>When <code>iowa_client_notification_lock()</code> is called with the second argument set to <code>true</code>, IOWA stops sending notifications (or Registration Update messages) until <code>iowa_client_notification_lock()</code> is called with the second argument set to <code>false</code>.</p>
<h4 id="custom_object_dynamic-cleanup">Cleanup</h4>
<p>This step is the same as in the Custom Object Baseline Client sample.</p>
<h3 id="custom_object_dynamic-object-data-callback">Object Data Callback</h3>
<p>The Object data callback is the same as in the Custom Object Baseline Client sample.</p>
<h2 id="custom_object_dynamic-next-steps">Next Steps</h2>
<p>The sample illustrates how to handle changes of the values of a custom LwM2M Object. The other custom object samples explain how to manage multiple instances of the custom LwM2M Object, or Resources with multiple Resource Instances.</p></section><section class="print-page" id="custom_object_multiple_instances"><h1 id="custom_object_multiple_instances-multiple-instances-custom-object">Multiple Instances Custom Object</h1>
<p>This is the <a href="#custom_object_baseline">Custom Object Baseline Client</a> featuring multiple instances of the same custom LwM2M Object:</p>
<p><em>ID:</em> <em>3200</em></p>
<p><em>Multiple instances</em></p>
<p><em>Resources:</em></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Type</th>
<th>Operations</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>5500</td>
<td>Boolean</td>
<td>R</td>
<td>Single</td>
<td>A read-only boolean value</td>
</tr>
<tr>
<td>5750</td>
<td>String</td>
<td>R/W</td>
<td>Single</td>
<td>A writable string</td>
</tr>
<tr>
<td>5503</td>
<td>Integer</td>
<td>R/W</td>
<td>Single</td>
<td>A writable integer value</td>
</tr>
</tbody>
</table>
<p>The following API will be explained:</p>
<ul>
<li><code>iowa_client_object_instance_changed()</code></li>
</ul>
<h2 id="custom_object_multiple_instances-usage">Usage</h2>
<p>The usage is the same as the Custom Object Baseline Client sample.</p>
<p>When registered to the LwM2M Server, you will notice that the <em>custom_object_multiple_instances</em> features two instances of the additional LwM2M Object described above:</p>
<p><img alt="First" src="images/First.jpg" /></p>
<p>After one minute, a third instance will appear:</p>
<p><img alt="Second" src="images/Second.jpg" /></p>
<p>Then, after thirty seconds, the first instance will disappear.</p>
<p>After two minutes, <em>custom_object_multiple_instances</em> unregisters from the LwM2M Server.</p>
<h2 id="custom_object_multiple_instances-breakdown">Breakdown</h2>
<h3 id="custom_object_multiple_instances-client-pseudo-code">Client Pseudo Code</h3>
<p>This is the pseudo code of Client main function:</p>
<div class="highlight"><pre><span></span><code><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Initialization</span>
<span class="w">    </span><span class="n">iowa_init</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Client configuration</span>
<span class="w">    </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">CLIENT_NAME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Custom Object addition</span>
<span class="w">    </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">resourceDescription</span><span class="p">,</span><span class="w"> </span><span class="n">instanceIDs</span><span class="p">,</span><span class="w"> </span><span class="n">dataCallback</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// LwM2M Server declaration</span>
<span class="w">    </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">SERVER_SHORT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_URI</span><span class="p">,</span><span class="w"> </span><span class="n">SERVER_LIFETIME</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// &quot;Main loop&quot;</span>
<span class="w">    </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">60</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Declare third instance</span>
<span class="w">    </span><span class="n">iowa_client_object_instance_changed</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">CREATE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">30</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Declare third instance</span>
<span class="w">    </span><span class="n">iowa_client_object_instance_changed</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">DELETE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_step</span><span class="p">(</span><span class="mi">30</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Cleanup</span>
<span class="w">    </span><span class="n">iowa_client_remove_custom_object</span><span class="p">(</span><span class="n">OBJECT_ID</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and the pseudo code of the Object data callback:</p>
<div class="highlight"><pre><span></span><code><span class="n">dataCallback</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">targetedResources</span><span class="w"></span>
<span class="w">        </span><span class="n">find</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">instance</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">READ</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instance</span><span class="o">/</span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">WRITE</span><span class="w"></span>
<span class="w">            </span><span class="n">then</span><span class="w"> </span><span class="n">instance</span><span class="o">/</span><span class="n">resource</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">targetedResources</span><span class="p">.</span><span class="n">value</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="custom_object_multiple_instances-main-function">Main Function</h3>
<h4 id="custom_object_multiple_instances-initialization">Initialization</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_multiple_instances-lwm2m-client-configuration">LwM2M Client Configuration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_multiple_instances-custom-object-addition">Custom Object Addition</h4>
<p>Here we add a custom Object to the LwM2M Client.</p>
<div class="highlight"><pre><span></span><code><span class="n">sample_object_values_t</span><span class="w"> </span><span class="n">objectValues</span><span class="p">;</span><span class="w"></span>
<span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="n">sample_object_resources</span><span class="p">[</span><span class="n">SAMPLE_RES_COUNT</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5500</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_BOOLEAN</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_OPERATION_READ</span><span class="p">,</span><span class="w">                        </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5750</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_STRING</span><span class="p">,</span><span class="w">  </span><span class="n">IOWA_OPERATION_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_OPERATION_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="mi">5503</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_LWM2M_TYPE_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_OPERATION_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">IOWA_OPERATION_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_RESOURCE_FLAG_NONE</span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">sample_instance_values_t</span><span class="w"> </span><span class="n">instanceValues</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"></span>
<span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceIds</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>

<span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="c1">// ID of the first instance</span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">booleanValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strdup</span><span class="p">(</span><span class="s">&quot;First instance&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">instanceValues</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">   </span><span class="c1">// ID of the first instance</span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">booleanValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">34</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strdup</span><span class="p">(</span><span class="s">&quot;Second instance&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">instanceValues</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">   </span><span class="c1">// ID of the first instance</span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">booleanValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">integerValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceValues</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strdup</span><span class="p">(</span><span class="s">&quot;Third instance&quot;</span><span class="p">);</span><span class="w"></span>


<span class="n">instanceIds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="n">instanceIds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instanceValues</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="p">;</span><span class="w"></span>

<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">instanceIds</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">SAMPLE_RES_COUNT</span><span class="p">,</span><span class="w"> </span><span class="n">sample_object_resources</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="n">sample_object_dataCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="nb">NULL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                       </span><span class="o">&amp;</span><span class="n">instanceValues</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>The arguments to <code>iowa_client_add_custom_object()</code> are the same as in the Custom Object Baseline Client sample, except for the third and fourth ones.</p>
<p>The third argument is the number of Instances this Object has, the fourth argument is the list of the IDs of these Instances. Note that the instance IDs do not need to match their index. This is why we have an <code>id</code> field in the sample_instance_values_t holding our values:</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w">  </span><span class="n">booleanValue</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">   </span><span class="n">integerValue</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">stringValue</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">sample_instance_values_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h4 id="custom_object_multiple_instances-lwm2m-server-declaration">LwM2M Server Declaration</h4>
<p>This step is the same as in the Baseline Client sample.</p>
<h4 id="custom_object_multiple_instances-main-loop">"Main Loop"</h4>
<p>Here after one minute we declare the presence of a third instance of the custom object:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Declare the third instance.</span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_object_instance_changed</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">instanceValues</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_DM_CREATE</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>then we remove the first instance:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Remove the first instance.</span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_object_instance_changed</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">SAMPLE_OBJECT_ID</span><span class="p">,</span><span class="w"> </span><span class="n">instanceValues</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_DM_DELETE</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>As always, the first argument to <code>iowa_client_object_instance_changed()</code> is the IOWA context created in the Initialization step.</p>
<p>The second argument is the same ID of the Object as in the call to <em><code>iowa_client_add_custom_object()</code></em>.</p>
<p>The fourth argument is the ID of the instance that is modified.</p>
<p>The last argument is the nature of the modification:</p>
<ul>
<li><strong>IOWA_DM_CREATE</strong> if the instance was created.</li>
<li><strong>IOWA_DM_DELETE</strong> if the instance was deleted.</li>
</ul>
<p>Note that this API only inform IOWA of the addition or removal of an instance. It does not invoke any callback of the custom object. It is the caller responsibility to ensure that the necessary data are created or freed. In this sample, we created in advance an array of three <code>sample_instance_values_t</code> to hold the data.</p>
<h4 id="custom_object_multiple_instances-cleanup">Cleanup</h4>
<p>This step is the same as in the Custom Object Baseline Client.</p>
<h3 id="custom_object_multiple_instances-object-data-callback">Object Data Callback</h3>
<p>This callback is very similar to the one in the Custom Object Baseline Client. The only difference is that we check  <code>dataP[i].instanceID</code> to find the matching <code>sample_instance_values_t</code> :</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="o">||</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">instanceID</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">].</span><span class="n">instanceID</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">instanceIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">instanceValues</span><span class="p">[</span><span class="n">instanceIndex</span><span class="p">].</span><span class="n">id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">dataP</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">instanceID</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">instanceIndex</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// We only declared three instances so this should not happen</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instanceIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">IOWA_COAP_404_NOT_FOUND</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></section><section class="print-page" id="custom_object_multiple_resource_instances"><h1 id="custom_object_multiple_resource_instances-multiple-resource-custom-object">Multiple Resource Custom Object</h1>
<p>This is a very simple LwM2M Client featuring a custom LwM2M Object with a multiple Resource.</p></section><section class="print-page" id="streamable_resource_client"><h1 id="streamable_resource_client-streamable-resource-client">Streamable Resource Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: LwM2M Custom Objects Samples</h1>
                        <h2 class='nav-section-title' id='section-firmware-update-samples'>
                            Firmware Update Samples <a class='headerlink' href='#section-firmware-update-samples' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="fw_update_push_client"><h1 id="fw_update_push_client-firmware-update-client-push-method">Firmware Update Client "Push" Method</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="fw_update_pull_client"><h1 id="fw_update_pull_client-firmware-update-client-pull-method">Firmware Update Client "Pull" Method</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="fw_coap_download_client"><h1 id="fw_coap_download_client-firmware-update-client-with-coap-download">Firmware Update Client with CoAP Download</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="fw_coap_block_client"><h1 id="fw_coap_block_client-firmware-update-client-with-coap-block-wise-transfer">Firmware Update Client with CoAP Block-Wise Transfer</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: Firmware Update Samples</h1>
                        <h2 class='nav-section-title' id='section-lwm2m-advanced-client-samples'>
                            LwM2M Advanced Client Samples <a class='headerlink' href='#section-lwm2m-advanced-client-samples' title='Permanent link'>â†µ</a>
                        </h2>
                        <section class="print-page" id="secure_client_mbedtls3"><h1 id="secure_client_mbedtls3-secure-client-with-mbed-tls-310">Secure Client with Mbed TLS 3.1.0</h1>
<p>This is the <a href="#baseline_client">Baseline Client</a> using <a href="https://github.com/Mbed-TLS/mbedtls">Mbed TLS 3.1.0</a> to secure its exchanges with the LwM2M Server.</p>
<h2 id="secure_client_mbedtls3-configuration">Configuration</h2>
<p>Before compiling and running, this sample requires some configuration to setup the security credentials.</p>
<p>This sample uses Pre-Shared Key security. You will need to decide on a key to use. Any byte stream will do. You will also need a key identity. For convenience, this identity is usually an human-readable string.</p>
<h3 id="secure_client_mbedtls3-client-side-setup">Client-side Setup</h3>
<p>You need to edit the file <em>samples/secure_client_mbedtls3/main.c</em> to enter your key and its identity at line 71 and 72:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyIdentity</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*Enter your Pre-Shared Key identity here*/</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyValue</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*Enter your Pre-Shared Key value here*/</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div></p>
<p>For instance:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyIdentity</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyValue</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div></p>
<p>Then you need to enter an unique client name in line 183:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="cm">/*Enter your client name here*/</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">devInfo</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div></p>
<h3 id="secure_client_mbedtls3-server-side-setup">Server-side Setup</h3>
<p>On IoTerop's <a href="https://iowa-server.ioterop.com/">CONNECTicut</a>, click on the "<em>Configuration</em>" tab, then on the "<em>Add new client configuration</em>" button.</p>
<p><img alt="Guide" src="images/Button.jpg" /></p>
<p>In the "<em>Client name</em>" field, enter the client name you chose in the previous step.</p>
<p>In the "<em>Security mode</em>" drop-down list, select <strong>Pre-Shared Key</strong>.</p>
<p>In the "<em>PSK Identity</em>" field, enter the key identity you chose.</p>
<p>In the "<em>PSK Secret</em>" field, enter the key you chose <strong>encoded in base64</strong>.</p>
<blockquote>
<p>You can access a base64 encoder at <a href="https://cryptii.com/pipes/binary-to-base64">https://cryptii.com/pipes/binary-to-base64</a>.</p>
</blockquote>
<p>Then click on the "<em>Validate</em>" button.</p>
<p><img alt="Device Provisioning" src="images/Provisioning.jpg" /></p>
<h2 id="secure_client_mbedtls3-usage">Usage</h2>
<p>The usage is the same as the <a href="#baseline_client">Baseline Client</a> sample.</p>
<blockquote>
<p>If the Client fails to connect to the Server, it is possible that the key identity and/or the client name you chose are alredy in use on the Server.</p>
</blockquote></section><section class="print-page" id="secure_client_mbedtls2"><h1 id="secure_client_mbedtls2-secure-client-with-mbed-tls-2280">Secure Client with Mbed TLS 2.28.0</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="secure_client_tinydtls"><h1 id="secure_client_tinydtls-secure-client-with-tinydtls">Secure Client with tinydtls</h1>
<p>This is the <a href="#baseline_client">Baseline Client</a> using <a href="https://github.com/eclipse/tinydtls">tinydtls</a> to secure its exchanges with the LwM2M Server.</p>
<h2 id="secure_client_tinydtls-configuration">Configuration</h2>
<p>Before compiling and running, this sample requires some configuration to setup the security credentials.</p>
<p>This sample uses Pre-Shared Key security. You will need to decide on a key to use. Any byte stream will do. You will also need a key identity. For convenience, this identity is usually an human-readable string.</p>
<h3 id="secure_client_tinydtls-client-side-setup">Client-side Setup</h3>
<p>You need to edit the file <em>samples/secure_client_tinytls/main.c</em> to enter your key and its identity at line 71 and 72:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyIdentity</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*Enter your Pre-Shared Key identity here*/</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyValue</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*Enter your Pre-Shared Key value here*/</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div></p>
<p>For instance:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyIdentity</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyValue</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</code></pre></div></p>
<p>Then you need to enter an unique client name in line 184:
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="cm">/*Enter your client name here*/</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">devInfo</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div></p>
<h3 id="secure_client_tinydtls-server-side-setup">Server-side Setup</h3>
<p>On IoTerop's <a href="https://iowa-server.ioterop.com/">CONNECTicut</a>, click on the "<em>Configuration</em>" tab, then on the "<em>Add new client configuration</em>" button.</p>
<p><img alt="Guide" src="images/Button.jpg" /></p>
<p>In the "<em>Client name</em>" field, enter the client name you chose in the previous step.</p>
<p>In the "<em>Security mode</em>" drop-down list, select <strong>Pre-Shared Key</strong>.</p>
<p>In the "<em>PSK Identity</em>" field, enter the key identity you chose.</p>
<p>In the "<em>PSK Secret</em>" field, enter the key you chose <strong>encoded in base64</strong>.</p>
<blockquote>
<p>You can access a base64 encoder at <a href="https://cryptii.com/pipes/binary-to-base64">https://cryptii.com/pipes/binary-to-base64</a>.</p>
</blockquote>
<p>Then click on the "<em>Validate</em>" button.</p>
<p><img alt="Device Provisioning" src="images/Provisioning.jpg" /></p>
<h2 id="secure_client_tinydtls-usage">Usage</h2>
<p>The usage is the same as the <a href="#baseline_client">Baseline Client</a> sample.</p>
<blockquote>
<p>If the Client fails to connect to the Server, it is possible that the key identity and/or the client name you chose are alredy in use on the Server.</p>
</blockquote></section><section class="print-page" id="bootstrap_client"><h1 id="bootstrap_client-bootstrap-client">Bootstrap Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="multithread_ipso_client"><h1 id="multithread_ipso_client-multithreaded-ipso-client">Multithreaded IPSO Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="device_info_client"><h1 id="device_info_client-device-info-client">Device Info Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="websockets_client"><h1 id="websockets_client-websocket-client">WebSocket Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="context_storage_client"><h1 id="context_storage_client-context-storage-client">Context Storage Client</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: LwM2M Advanced Client Samples</h1><section class="print-page" id="baseline_server"><h1 id="baseline_server-baseline-server">Baseline Server</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: Samples</h1>
                        <h1 class='nav-section-title' id='section-api-reference'>
                            API Reference <a class='headerlink' href='#section-api-reference' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="abstractionlayer"><h1 id="abstractionlayer-system-abstraction-layer">System Abstraction Layer</h1>
<p>The functions explained below are defined inside the file <em>include/iowa_platform.h</em>.</p>
<h2 id="abstractionlayer-presentation">Presentation</h2>
<p>To port IOWA to your platform, you have to implement the following functions.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">);</span><span class="w"></span>

<span class="kt">int32_t</span><span class="w"> </span><span class="nf">iowa_system_gettime</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_send</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_recv</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">connArray</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">connCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_close</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>If you are implementing a LwM2M Client, you also have to implement these functions:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_reboot</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_connection_open</span><span class="p">(</span><span class="n">iowa_connection_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>These other functions are optional to implement. See Below.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_trace</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">va_list</span><span class="w"> </span><span class="n">varArgs</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_queue_create</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_queue_delete</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_queue_enqueue</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_dequeue</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_peek</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_queue_remove</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_backup</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">iowa_system_queue_restore</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_store_context</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">bufferP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_retrieve_context</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">**</span><span class="n">bufferP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_interrupt_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_lock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_unlock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_connection_get_peer_identifier</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">addrP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_random_vector_generator</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">randomBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>

<span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_system_security_data</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">peerIdentity</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">peerIdentityLen</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">iowa_security_operation_t</span><span class="w"> </span><span class="n">securityOp</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">iowa_security_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">securityDataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userDataP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<hr />
<h2 id="abstractionlayer-data-types">Data types</h2>
<h3 id="abstractionlayer-iowa_connection_type_t">iowa_connection_type_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_DATAGRAM</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_STREAM</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_LORAWAN</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_SMS</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_CONN_WEBSOCKET</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_connection_type_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_CONN_UNDEFINED</dt>
<dd>Connection type is unknown.</dd>
<dt>IOWA_CONN_DATAGRAM</dt>
<dd>UDP connection.</dd>
<dt>IOWA_CONN_STREAM</dt>
<dd>TCP connection.</dd>
<dt>IOWA_CONN_LORAWAN</dt>
<dd>LoRaWAN transport.</dd>
<dt>IOWA_CONN_SMS</dt>
<dd>SMS transport.</dd>
<dt>IOWA_CONN_WEBSOCKET</dt>
<dd>WebSocket transport.</dd>
</dl>
<h3 id="abstractionlayer-iowa_security_operation_t">iowa_security_operation_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_SEC_READ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_SEC_FREE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_SEC_CREATE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_SEC_DELETE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_SEC_CHECK</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_operation_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_security_operation_t</code> enumeration is used to tell which security operation is requested when the function <code>iowa_system_security_data</code> is called.</p>
<dl>
<dt>IOWA_SEC_READ</dt>
<dd>Read security keys from the Application.</dd>
<dt>IOWA_SEC_FREE</dt>
<dd>Free the data allocated if any in the security structure. Always call after <strong>IOWA_SEC_READ</strong>.</dd>
<dt>IOWA_SEC_CREATE</dt>
<dd>Add security keys to the Application.</dd>
<dt>IOWA_SEC_DELETE</dt>
<dd>Remove security keys from the Application.</dd>
<dt>IOWA_SEC_CHECK</dt>
<dd>Check if the security keys are present on the Application.</dd>
</dl>
<h3 id="abstractionlayer-iowa_psk_data_t">iowa_psk_data_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">identity</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">identityLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">privateKey</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">privateKeyLen</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_psk_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_psk_data_t</code> structure is used to store the identity / private key pair information.</p>
<dl>
<dt>identity</dt>
<dd>Identity associated with the private key.</dd>
<dt>identityLen</dt>
<dd>Length of the identity.</dd>
<dt>privateKey</dt>
<dd>Private key associated with the identity.</dd>
<dt>privateKeyLen</dt>
<dd>Length of the private key.</dd>
</dl>
<h3 id="abstractionlayer-iowa_certificate_data_t">iowa_certificate_data_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">caCertificate</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">caCertificateLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">certificate</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">certificateLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">privateKey</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">privateKeyLen</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_certificate_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_certificate_data_t</code> structure is used to store information related to a certificate.</p>
<dl>
<dt>caCertificate</dt>
<dd>Certificate authority used to generate the certificate. Must respect the DER (Distinguished Encoding Rules) format.</dd>
<dt>caCertificateLen</dt>
<dd>Length of the certificate authority.</dd>
<dt>certificate</dt>
<dd>Certificate. Must respect the DER (Distinguished Encoding Rules) format.</dd>
<dt>certificateLen</dt>
<dd>Length of the certificate.</dd>
<dt>privateKey</dt>
<dd>Private key used to generate the certificate. Must respect the DER (Distinguished Encoding Rules) format.</dd>
<dt>privateKeyLen</dt>
<dd>Length of the private key.</dd>
</dl>
<h3 id="abstractionlayer-iowa_rpk_data_t">iowa_rpk_data_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">publicKeyX</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">publicKeyXLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">publicKeyY</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">publicKeyYLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">privateKey</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">privateKeyLen</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_rpk_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_rpk_data_t</code> structure is used to store information related to raw public key information. Supported public keys must use the fixed curve <em>secp256r1</em>.</p>
<dl>
<dt>publicKeyX</dt>
<dd>Public key X coordinate.</dd>
<dt>publicKeyXLen</dt>
<dd>Length of the public key X coordinate.</dd>
<dt>publicKeyY</dt>
<dd>Public key Y coordinate.</dd>
<dt>publicKeyYLen</dt>
<dd>Length of the public key Y coordinate.</dd>
<dt>privateKey</dt>
<dd>Private key used to generate the public key.</dd>
<dt>privateKeyLen</dt>
<dd>Length of the private key.</dd>
</dl>
<h3 id="abstractionlayer-iowa_oscore_data_t">iowa_oscore_data_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">senderId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">senderIdLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">recipientId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">recipientIdLen</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">masterSecret</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">masterSecretLen</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_oscore_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_oscore_data_t</code> structure is used to store information related to OSCORE key information.</p>
<dl>
<dt>senderId</dt>
<dd>ID to use to protect sent CoAP messages.</dd>
<dt>senderIdLen</dt>
<dd>Length of the Sender ID.</dd>
<dt>recipientId</dt>
<dd>ID to use to verify received CoAP messages..</dd>
<dt>recipientIdLen</dt>
<dd>Length of the Recipient ID.</dd>
<dt>masterSecret</dt>
<dd>Private key associated to the Sender ID and Recipient ID.</dd>
<dt>masterSecretLen</dt>
<dd>Length of the Master Secret.</dd>
</dl>
<h3 id="abstractionlayer-iowa_security_data_t">iowa_security_data_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_security_mode_t</span><span class="w"> </span><span class="n">securityMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_psk_data_t</span><span class="w">         </span><span class="n">pskData</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_certificate_data_t</span><span class="w"> </span><span class="n">certData</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_rpk_data_t</span><span class="w">         </span><span class="n">rpkData</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_oscore_data_t</span><span class="w">      </span><span class="n">oscoreData</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">protocol</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_security_data_t</code> structure is used to create, delete, read and free security data.</p>
<dl>
<dt>securityMode</dt>
<dd>Security mode to determine the data in the union structure.</dd>
<dt>protocol.pskData</dt>
<dd>Pre-shared key data.</dd>
<dt>protocol.certData</dt>
<dd>Certificate data.</dd>
<dt>protocol.rpkData</dt>
<dd>Raw public key data.</dd>
<dt>protocol.oscoreData</dt>
<dd>Object Security for CORE key data.</dd>
</dl>
<hr />
<h2 id="abstractionlayer-api">API</h2>
<h3 id="abstractionlayer-iowa_system_malloc">iowa_system_malloc</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_malloc()</code> could map directly to C standard library <code>malloc()</code>. It allocates a memory block.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>size</em></dt>
<dd>The size in bytes of the requested memory block.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to the allocated memory or NULL in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Note</strong></p>
<p>This function is required by IOWA.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_free">iowa_system_free</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_free()</code> could map directly to C standard library <code>free()</code>. It releases a memory block previously allocated by <a href="#abstractionlayer-iowa_system_malloc"><code>iowa_system_malloc()</code></a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>pointer</em></dt>
<dd>A pointer to the memory block to release.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required by IOWA.</p>
<p>From C standard, no action should occur if <em>pointer</em> argument is a null pointer. This is how the function <code>free()</code> from C standard library behaves. However some compilers or implementations do not respect this standard. So it can be necessary when implementing <code>iowa_system_free()</code> to check if the argument <em>pointer</em> is nil.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_gettime">iowa_system_gettime</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int32_t</span><span class="w"> </span><span class="nf">iowa_system_gettime</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_gettime()</code> is used by IOWA to determine the time elapsed.</p>
<p><strong>Return Value</strong></p>
<p>The number of seconds elapsed since a point of origin or a negative number in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required by IOWA.</p>
<p>If you are using the GPS or the Location object, this function will be used to timestamp the measure. In this case, the point of origin must be Epoch.</p>
<p>Else, the point of origin (Epoch, system boot, etc...) does not matter as this function is used only to determine the elapsed time between consecutive calls.</p>
<p>There is no safeguard if <code>iowa_system_gettime()</code> returns a value inferior to the one returned in a previous call.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_reboot">iowa_system_reboot</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_reboot</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_reboot()</code> starts a system reboot.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only for LwM2M Clients.</p>
<p>This feature is required by the Lightweight M2M protocol. However, a LwM2M device can be functional without it and this function can be a stub.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_trace">iowa_system_trace</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_trace</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="kt">va_list</span><span class="w"> </span><span class="n">varArgs</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_trace()</code> outputs the logs when the stack is built with <strong>IOWA_WITH_LOGS</strong>.</p>
<p>It can be mapped directly to <code>vprintf()</code>.</p>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required by IOWA only when logs are activated. See <a href="#configuration-iowa_log_level-and-iowa_log_part">IOWA_LOG_LEVEL and IOWA_LOG_PART</a>.</p>
<p>IOWA takes care of freeing <em>varArgs</em> after this call returns.</p>
<p>To print a single line on the output, this function can be called multiple times. This has an impact when the flag <strong>IOWA_THREAD_SUPPORT</strong> is enabled. Several calls of <a href="#abstractionlayer-iowa_system_trace"><code>iowa_system_trace()</code></a> can occur from different threads at the same time. And thus, the output can be ruined. The implementation of this function must be thread safe.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_open">iowa_system_connection_open</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_connection_open</span><span class="p">(</span><span class="n">iowa_connection_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_open()</code> opens a connection to a host.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>type</em></dt>
<dd>The type of connection to open.</dd>
<dt><em>hostname</em></dt>
<dd>The hostname of the peer to connect to.</dd>
<dt><em>port</em></dt>
<dd>The port to connect to. It may be NULL depending on the provided server URL.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to an user-defined type or NULL in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only for LwM2M Clients.</p>
<p>When IOWA is used as a LwM2M Client, it calls this function to connect to the LwM2M Servers. See the <a href="#clientapi-iowa_client_add_server"><code>iowa_client_add_server()</code></a> API.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_open_server">iowa_system_connection_open_server</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_connection_open_server</span><span class="p">(</span><span class="n">iowa_connection_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">ssid</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_open_server()</code> opens a connection to a host.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>type</em></dt>
<dd>The type of connection to open.</dd>
<dt><em>hostname</em></dt>
<dd>The hostname of the peer to connect to.</dd>
<dt><em>port</em></dt>
<dd>The port to connect to. It may be NULL depending on the provided server URL.</dd>
<dt><em>ssid</em></dt>
<dd>The Short Server ID of the LwM2M Server to connect to, <code>0</code> if the connection is to the LwM2M Bootstrap-Server, or <strong>IOWA_LWM2M_ID_ALL</strong> if the connection is not to a LwM2M Server.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to [<code>iowa_init()</code>][iowa_init].</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to an user-defined type or NULL in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only for LwM2M Clients when <a href="#configuration-iowa_abstraction_extension"><strong>IOWA_ABSTRACTION_EXTENSION</strong></a> is defined.</p>
<p>When IOWA is used as a LwM2M Client, it calls this function to connect to the LwM2M Servers. See the [<code>iowa_client_add_server()</code>][iowa_client_add_server] API.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_send">iowa_system_connection_send</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_send</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_send()</code> sends a buffer on a connection.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>connP</em></dt>
<dd>The connection as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>The data to send.</dd>
<dt><em>length</em></dt>
<dd>The length of the data in bytes.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of bytes sent or a negative number in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required by IOWA.</p>
<p>On packet switched networks (eg. UDP), if <em>length</em> is bigger than the MTU, it is advised to not try to send the buffer and return the MTU.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_get_peer_identifier">iowa_system_connection_get_peer_identifier</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_connection_get_peer_identifier</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">addrP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_get_peer_identifier()</code> returns an unique identifier for the peer of a connection (e.g. IP address, LoRaWAN DevEUI, SMS MSISDN).</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>connP</em></dt>
<dd>The connection as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
<dt><em>addrP</em></dt>
<dd>A pre-allocated buffer to store the identifier.</dd>
<dt><em>length</em></dt>
<dd>The length of <em>addrP</em> in bytes.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of bytes of the identifier or 0 in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with <a href="#configuration-iowa_security_layer">IOWA_SECURITY_LAYER</a> different from <strong>IOWA_SECURITY_LAYER_NONE</strong>, or with <strong>LWM2M_SERVER_MODE</strong> or <strong>LWM2M_BOOTSTRAP_SERVER_MODE</strong> flags.</p>
<p>This is used when the endpoint name has not been found in the registration payload.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_recv">iowa_system_connection_recv</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_recv</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_recv()</code> reads data from a connection in a non-blocking way.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>connP</em></dt>
<dd>The connection as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the received data.</dd>
<dt><em>length</em></dt>
<dd>The length of the buffer in bytes.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of received bytes or a negative number in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Note</strong></p>
<p>This function is required by IOWA.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_select">iowa_system_connection_select</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_connection_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">connArray</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">connCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_select()</code> monitors a list of connections for incoming data during the specified time.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>connArray</em></dt>
<dd>An array of connections as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
<dt><em>connCount</em></dt>
<dd>The number of elements of connArray. This may be zero.</dd>
<dt><em>timeout</em></dt>
<dd>The time to wait for data in seconds. This may be zero.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
<dt><strong>Return Value</strong></dt>
<dd>
<p>either:</p>
</dd>
<dd>
<ul>
<li>a positive number if data are available.</li>
</ul>
</dd>
<dd>
<ul>
<li>zero if the time elapsed.</li>
</ul>
</dd>
<dd>
<ul>
<li>a negative number in case of error.</li>
</ul>
</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required by IOWA.</p>
<p>If data are available on one or more connections, <code>iowa_system_connection_select()</code> must modify the <em>connArray</em> elements :</p>
<ul>
<li>If data are available on a connection the matching element in <em>connArray</em> is left untouched.</li>
<li>If no data are available, the matching element is set to NULL.
  If the timeout is reached (or in case of error), there is no need to modify the <em>connArray</em> elements.</li>
</ul>
<p>When the application needs to be very responsive, this function is a good place to monitor application specific events without using a very short timeout in <a href="#commonapi-iowa_step"><code>iowa_step()</code></a>. For instance, the sample server waits for keyboard events here.</p>
<p>It is possible that IOWA calls <code>iowa_system_connection_select()</code> with a timeout of zero. In this case, <code>iowa_system_connection_select()</code> must not return an error, and should check if some data are already available on one of the connections.</p>
<p>It is also possible that IOWA calls <code>iowa_system_connection_select()</code> with no connections. In this case, <code>iowa_system_connection_select()</code> must not return an error, and should return after the timeout, which may also be zero, expires. This can occur when opening a connection to a LwM2M Server failed and IOWA is configured to wait a specific time before retrying to connect to the LwM2M Server.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_interrupt_select">iowa_system_connection_interrupt_select</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_interrupt_select</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p>A call to <code>iowa_system_connection_interrupt_select()</code> makes <a href="#abstractionlayer-iowa_system_connection_select"><code>iowa_system_connection_select()</code></a> return immediately if it is currently running.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_MULTITHREAD_SUPPORT</strong> flag.</p>
<p>The value returned by <a href="#abstractionlayer-iowa_system_connection_select"><code>iowa_system_connection_select()</code></a> is zero. Calling <code>iowa_system_connection_interrupt_select()</code> is considered as a preemptive timeout for <a href="#abstractionlayer-iowa_system_connection_select"><code>iowa_system_connection_select()</code></a>.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_connection_close">iowa_system_connection_close</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_connection_close</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">connP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_connection_close()</code> closes a connection.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>connP</em></dt>
<dd>The connection as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Note</strong></p>
<p>This function is required by IOWA.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_create">iowa_system_queue_create</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_system_queue_create</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_create()</code> creates a storage queue to offload data from the memory.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to an user-defined type or NULL in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> or <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flags.</p>
<p>The storage queue must store data as separate entities and not as as a stream. Ideally, this is a FIFO.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_delete">iowa_system_queue_delete</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_queue_delete</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_delete()</code> closes a storage queue.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> or <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flags.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_enqueue">iowa_system_queue_enqueue</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_queue_enqueue</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_enqueue()</code> stores data in a storage queue.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>The data to store.</dd>
<dt><em>length</em></dt>
<dd>The length of the data in bytes.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of stored bytes or a negative number in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> or <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flags.</p>
<p>The data must be stored as a single entity.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_dequeue">iowa_system_queue_dequeue</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_dequeue</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_dequeue()</code> retrieves an entity from a storage queue or, the provided buffer is too small, it returns the size of the next entity to retrieve.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the retrieved data. This can be nil.</dd>
<dt><em>length</em></dt>
<dd>The length of the buffer in bytes. This can be zero.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The size in bytes of retrieved entity or zero if the queue is empty or in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> flag.</p>
<p>If the provided buffer is nil or too small to contain the entity to retrieve, the entity is not removed from the queue.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_peek">iowa_system_queue_peek</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_peek</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_peek()</code> peeks a entity from a storage queue or, if the provided buffer is too small, it returns the size of the next entity to peek.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the retrieved data. This can be nil.</dd>
<dt><em>length</em></dt>
<dd>The length of the buffer in bytes. This can be zero.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The size in bytes of peeked entity or zero if the queue is empty or in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flag.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_remove">iowa_system_queue_remove</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_queue_remove</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_remove()</code> removes the first entity of a storage queue.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flag.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_backup">iowa_system_queue_backup</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_queue_backup</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">queueP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_backup()</code> returns a blob of data necessary to recreate a storage queue, or if the provided buffer is too small, the size of this blob of data.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>queueP</em></dt>
<dd>A storage queue as returned by <a href="#abstractionlayer-iowa_system_queue_create"><code>iowa_system_queue_create()</code></a>.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the blob of data. This can be nil.</dd>
<dt><em>length</em></dt>
<dd>The length of <em>buffer</em> in bytes. This can be zero.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The size in bytes of the blob of data to save or zero in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_STORAGE_CONTEXT_SUPPORT</strong> flag and with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> or <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flags.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_queue_restore">iowa_system_queue_restore</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">iowa_system_queue_restore</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_queue_restore()</code> recreates a storage queue from a blob of data.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>buffer</em></dt>
<dd>A buffer containing the blob of data returned by <a href="#abstractionlayer-iowa_system_queue_backup"><code>iowa_system_queue_backup()</code></a>.</dd>
<dt><em>length</em></dt>
<dd>The length of <em>buffer</em> in bytes.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to an user-defined type or NULL in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_STORAGE_CONTEXT_SUPPORT</strong> flag and with the <strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong> or <strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong> flags.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_store_context">iowa_system_store_context</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_store_context</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">bufferP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_store_context()</code> stores the IOWA context.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>bufferP</em></dt>
<dd>The destination buffer.</dd>
<dt><em>length</em></dt>
<dd>Length of the buffer.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of stored bytes or a zero in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_STORAGE_CONTEXT_SUPPORT</strong> flag.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_retrieve_context">iowa_system_retrieve_context</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_system_retrieve_context</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">**</span><span class="n">bufferP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_retrieve_context()</code> retrieves an IOWA context.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>bufferP</em></dt>
<dd>The buffer containing the retrieved data.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The size in bytes of retrieved data or zero if there is nothing or in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<ul>
<li>This function is required only if IOWA is built with the <strong>IOWA_STORAGE_CONTEXT_SUPPORT</strong> flag.</li>
<li><em>bufferP</em> must be allocated by the function. The buffer will next be freed by IOWA internally.</li>
</ul>
<hr />
<h3 id="abstractionlayer-iowa_system_mutex_lock">iowa_system_mutex_lock</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_lock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_mutex_lock()</code> locks a mutex for the current thread.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_MULTITHREAD_SUPPORT</strong> flag.</p>
<p>IOWA uses only one mutex.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_mutex_unlock">iowa_system_mutex_unlock</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_system_mutex_unlock</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_mutex_unlock()</code> releases a mutex.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is required only if IOWA is built with the <strong>IOWA_MULTITHREAD_SUPPORT</strong> flag.</p>
<p>IOWA uses only one mutex.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_random_vector_generator">iowa_system_random_vector_generator</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_system_random_vector_generator</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">randomBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_random_vector_generator()</code> stores random values to a preallocated vector.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>randomBuffer</em></dt>
<dd>The generated random vector.</dd>
<dt><em>size</em></dt>
<dd>The size of the vector.</dd>
<dt><em>userData</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A code indicating if the vector has been generated:</p>
<ul>
<li>0 if the vector has been generated successfully.</li>
<li>Another value if an error occurred.</li>
</ul>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is only required if IOWA is built with <strong>IOWA_SECURITY_LAYER</strong> different from <strong>IOWA_SECURITY_LAYER_NONE</strong>.</p>
<hr />
<h3 id="abstractionlayer-iowa_system_security_data">iowa_system_security_data</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_system_security_data</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">peerIdentity</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">peerIdentityLen</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">iowa_security_operation_t</span><span class="w"> </span><span class="n">securityOp</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="n">iowa_security_data_t</span><span class="w"> </span><span class="o">*</span><span class="n">securityDataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userDataP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_system_security_data()</code> is a function used by the security layer to CREATE, DELETE or READ the security data.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>peerIdentity</em></dt>
<dd>The identity associating to the peer (can be an URI on client side, or the PSK identity on server side, etc).</dd>
<dt><em>peerIdentitySize</em></dt>
<dd>Size of the identity.</dd>
<dt><em>securityOp</em></dt>
<dd>The security operation.</dd>
<dt><em>securityDataP</em></dt>
<dd>The security data.</dd>
<dt><em>userDataP</em></dt>
<dd>The argument passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>the security data based on <em>peerIdentity</em> has not been found (only when the security operation is not <code>IOWA_SEC_CREATE</code>).</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>the security data based on <em>peerIdentity</em> already exists (only when the security operation is <code>IOWA_SEC_CREATE</code>).</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_platform.h</p>
<p><strong>Notes</strong></p>
<p>This function is only required if IOWA is built with <strong>IOWA_SECURITY_LAYER</strong> different from <strong>IOWA_SECURITY_LAYER_NONE</strong>.</p>
<p>The <strong>IOWA_SEC_DELETE</strong> operation is only used if a <strong>IOWA_SEC_CREATE</strong> operation happened. The <strong>IOWA_SEC_CREATE</strong> operation is only used on bootstrapping.</p>
<p>Regarding the memory allocation:</p>
<ul>
<li>On a <strong>IOWA_SEC_CREATE</strong> operation, the data is allocated by the stack. So the deallocation MUST not be done by the application.</li>
<li>On a <strong>IOWA_SEC_READ</strong> operation, the data if needed is allocated by the application. The stack does not deallocate it. That's why after a <strong>IOWA_SEC_READ</strong> operation, the function <code>iowa_system_security_data</code> is called with <strong>IOWA_SEC_FREE</strong> to allow the application to deallocate the memory if needed.</li>
</ul>
<p><em>peerIdentity</em> is always a character string encoded in UTF-8 without the Null-terminated string:</p>
<ul>
<li>On a LwM2M Client, this is the LwM2M Server URI or the Bootstrap Server URI.</li>
<li>On Server, this is Client Hint Identity.</li>
</ul></section><section class="print-page" id="commonapi"><h1 id="commonapi-common-api-reference">Common API Reference</h1>
<blockquote>
<p>This is an excerpt from the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote>
<p>The functions explained below are defined inside the file <em>include/iowa.h</em>.</p>
<h2 id="commonapi-presentation">Presentation</h2>
<p>Whatever the role of your application (Client or Server), it builds on the following skeleton:
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;iowa.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">     * Initialization</span>
<span class="cm">     */</span><span class="w"></span>

<span class="w">    </span><span class="n">iowaH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">     * &quot;Main loop&quot;</span>
<span class="cm">     */</span><span class="w"></span>

<span class="w">    </span><span class="k">do</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_close</span><span class="p">(</span><span class="n">iowaH</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div></p>
<h2 id="commonapi-data-types">Data types</h2>
<h3 id="commonapi-iowa_status_t">iowa_status_t</h3>
<p>This is the return type of most of the IOWA APIs. This is an enumeration matching the CoAP status codes, similar to the HTTP status codes.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_status_t</span><span class="p">;</span><span class="w"></span>

<span class="cp">#define IOWA_COAP_NO_ERROR                        0x00</span>
<span class="cp">#define IOWA_COAP_201_CREATED                     0x41</span>
<span class="cp">#define IOWA_COAP_202_DELETED                     0x42</span>
<span class="cp">#define IOWA_COAP_203_VALID                       0x43</span>
<span class="cp">#define IOWA_COAP_204_CHANGED                     0x44</span>
<span class="cp">#define IOWA_COAP_205_CONTENT                     0x45</span>
<span class="cp">#define IOWA_COAP_231_CONTINUE                    0x5F</span>
<span class="cp">#define IOWA_COAP_400_BAD_REQUEST                 0x80</span>
<span class="cp">#define IOWA_COAP_401_UNAUTHORIZED                0x81</span>
<span class="cp">#define IOWA_COAP_402_BAD_OPTION                  0x82</span>
<span class="cp">#define IOWA_COAP_403_FORBIDDEN                   0x83</span>
<span class="cp">#define IOWA_COAP_404_NOT_FOUND                   0x84</span>
<span class="cp">#define IOWA_COAP_405_METHOD_NOT_ALLOWED          0x85</span>
<span class="cp">#define IOWA_COAP_406_NOT_ACCEPTABLE              0x86</span>
<span class="cp">#define IOWA_COAP_408_REQUEST_ENTITY_INCOMPLETE   0x88</span>
<span class="cp">#define IOWA_COAP_409_CONFLICT                    0x89</span>
<span class="cp">#define IOWA_COAP_412_PRECONDITION_FAILED         0x8C</span>
<span class="cp">#define IOWA_COAP_413_REQUEST_ENTITY_TOO_LARGE    0x8D</span>
<span class="cp">#define IOWA_COAP_415_UNSUPPORTED_CONTENT_FORMAT  0x8F</span>
<span class="cp">#define IOWA_COAP_422_UNPROCESSABLE_ENTITY        0x96</span>
<span class="cp">#define IOWA_COAP_429_TOO_MANY_REQUESTS           0x9D</span>
<span class="cp">#define IOWA_COAP_500_INTERNAL_SERVER_ERROR       0xA0</span>
<span class="cp">#define IOWA_COAP_501_NOT_IMPLEMENTED             0xA1</span>
<span class="cp">#define IOWA_COAP_502_BAD_GATEWAY                 0xA2</span>
<span class="cp">#define IOWA_COAP_503_SERVICE_UNAVAILABLE         0xA3</span>
<span class="cp">#define IOWA_COAP_504_GATEWAY_TIMEOUT             0xA4</span>
<span class="cp">#define IOWA_COAP_505_PROXYING_NOT_SUPPORTED      0xA5</span>
</code></pre></div>
<h3 id="commonapi-iowa_context_t">iowa_context_t</h3>
<p>This opaque type is used to store the context of the IOWA stack engine. It is created by calling <a href="#commonapi-iowa_init"><code>iowa_init()</code></a> and destroyed by calling <a href="#commonapi-iowa_close"><code>iowa_close()</code></a>.</p>
<p>Multiple <code>iowa_context_t</code> can be created within the same process.</p>
<h3 id="commonapi-iowa_dm_operation_t">iowa_dm_operation_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_dm_operation_t</span><span class="p">;</span><span class="w"></span>

<span class="cp">#define IOWA_DM_UNDEFINED        0</span>
<span class="cp">#define IOWA_DM_READ             1</span>
<span class="cp">#define IOWA_DM_FREE             2</span>
<span class="cp">#define IOWA_DM_WRITE            3</span>
<span class="cp">#define IOWA_DM_EXECUTE          4</span>
<span class="cp">#define IOWA_DM_CREATE           5</span>
<span class="cp">#define IOWA_DM_DELETE           6</span>
<span class="cp">#define IOWA_DM_DISCOVER         7</span>
<span class="cp">#define IOWA_DM_WRITE_ATTRIBUTES 8</span>
<span class="cp">#define IOWA_DM_NOTIFY           9</span>
<span class="cp">#define IOWA_DM_CANCEL           10</span>
<span class="cp">#define IOWA_DM_DATA_PUSH        11</span>
<span class="cp">#define IOWA_DM_READ_REQUEST     12</span>
</code></pre></div>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_DM_UNDEFINED</dt>
<dd>No specific LwM2M operation, this should never be used and only serves as a non default operation.</dd>
<dt>IOWA_DM_READ</dt>
<dd>LwM2M Read operation is used to access the value of an Object, Object Instances, and Resources.</dd>
<dt>IOWA_DM_FREE</dt>
<dd>Free operation is used to clean the allocated memory on <em>IOWA_DM_READ</em> operation.</dd>
<dt>IOWA_DM_WRITE</dt>
<dd>LwM2M Write operation is used to change the value of an Object, Object Instances, and Resources.</dd>
<dt>IOWA_DM_EXECUTE</dt>
<dd>LwM2M Execute operation is used to initiate some action, and can only be performed on individual Resources.</dd>
<dt>IOWA_DM_CREATE</dt>
<dd>LwM2M Create operation is used to create Object Instance(s).</dd>
<dt>IOWA_DM_DELETE</dt>
<dd>LwM2M Delete operation is used to delete an Object Instance.</dd>
<dt>IOWA_DM_DISCOVER</dt>
<dd>LwM2M Discover operation is used to discover LwM2M Attributes attached to an Object, Object Instances, and Resources.</dd>
<dt>IOWA_DM_WRITE_ATTRIBUTES</dt>
<dd>LwM2M Write-Attributes operation is used to change the LwM2M Attributes of an Object, Object Instances, and Resources.</dd>
<dt>IOWA_DM_NOTIFY</dt>
<dd>LwM2M Notify operation is used to notify the change of a value during a valid Observation on an Object Instance or Resource.</dd>
<dt>IOWA_DM_CANCEL</dt>
<dd>LwM2M Cancel operation is used to end an Observation.</dd>
<dt>IOWA_DM_DATA_PUSH</dt>
<dd>LwM2M Data push operation is used when LwM2M Server receives the value of an Object, Object Instances, and Resources without requested it.</dd>
<dt>IOWA_DM_READ_REQUEST</dt>
<dd>On the Client side, inform a custom Object that a LwM2M Server will perform a READ operation. See <a href="#clientapi-iowa_lwm2m_resource_desc_t">iowa_lwm2m_resource_desc_t</a>.</dd>
</dl>
<p><strong>Notes</strong></p>
<p>This enumeration is used on both Server and Client side. But not all the values are used depending of the side.</p>
<p>Server callbacks can be called with:</p>
<ul>
<li>IOWA_DM_READ</li>
<li>IOWA_DM_WRITE</li>
<li>IOWA_DM_EXECUTE</li>
<li>IOWA_DM_CREATE</li>
<li>IOWA_DM_DELETE</li>
<li>IOWA_DM_DISCOVER</li>
<li>IOWA_DM_WRITE_ATTRIBUTES</li>
<li>IOWA_DM_NOTIFY</li>
<li>IOWA_DM_DATA_PUSH</li>
</ul>
<p>Client callbacks can be called with:</p>
<ul>
<li>IOWA_DM_READ</li>
<li>IOWA_DM_FREE</li>
<li>IOWA_DM_WRITE</li>
<li>IOWA_DM_EXECUTE</li>
<li>IOWA_DM_CREATE</li>
<li>IOWA_DM_DELETE</li>
<li>IOWA_DM_DATA_PUSH</li>
</ul>
<h3 id="commonapi-iowa_lwm2m_data_type_t">iowa_lwm2m_data_type_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_lwm2m_data_type_t</span><span class="p">;</span><span class="w"></span>

<span class="cp">#define IOWA_LWM2M_TYPE_UNDEFINED        0</span>
<span class="cp">#define IOWA_LWM2M_TYPE_STRING           1</span>
<span class="cp">#define IOWA_LWM2M_TYPE_OPAQUE           2</span>
<span class="cp">#define IOWA_LWM2M_TYPE_INTEGER          3</span>
<span class="cp">#define IOWA_LWM2M_TYPE_FLOAT            4</span>
<span class="cp">#define IOWA_LWM2M_TYPE_BOOLEAN          5</span>
<span class="cp">#define IOWA_LWM2M_TYPE_CORE_LINK        6</span>
<span class="cp">#define IOWA_LWM2M_TYPE_OBJECT_LINK      7</span>
<span class="cp">#define IOWA_LWM2M_TYPE_TIME             8</span>
<span class="cp">#define IOWA_LWM2M_TYPE_UNSIGNED_INTEGER 9</span>
</code></pre></div>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_LWM2M_TYPE_UNDEFINED</dt>
<dd>No specific data type: it is only used for Executable Resource.</dd>
<dt>IOWA_LWM2M_TYPE_STRING</dt>
<dd>A UTF-8 string.</dd>
<dt>IOWA_LWM2M_TYPE_OPAQUE</dt>
<dd>A sequence of binary octets.</dd>
<dt>IOWA_LWM2M_TYPE_INTEGER</dt>
<dd>An 64-bit signed integer.</dd>
<dt>IOWA_LWM2M_TYPE_FLOAT</dt>
<dd>A 32 or 64-bit floating point value.</dd>
<dt>IOWA_LWM2M_TYPE_BOOLEAN</dt>
<dd>An unsigned integer with the value 0 for false and the value 1 for true.</dd>
<dt>IOWA_LWM2M_TYPE_CORE_LINK</dt>
<dd>A UTF-8 string representing the relation between resources and links.</dd>
<dt>IOWA_LWM2M_TYPE_OBJECT_LINK</dt>
<dd>Reference to an Instance of a given Object.</dd>
<dt>IOWA_LWM2M_TYPE_TIME</dt>
<dd>A signed integer representing the number of seconds.</dd>
<dt>IOWA_LWM2M_TYPE_UNSIGNED_INTEGER</dt>
<dd>An unsigned integer.</dd>
</dl>
<h3 id="commonapi-iowa_lwm2m_data_t">iowa_lwm2m_data_t</h3>
<p>When the LwM2M Server and the LwM2M Client exchange data, at the application level, they are presented in <code>iowa_lwm2m_data_t</code> structures.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resInstanceID</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_data_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">bool</span><span class="w">    </span><span class="n">asBoolean</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">asInteger</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w">  </span><span class="n">asFloat</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w">   </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">asBuffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w">   </span><span class="n">totalSize</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">details</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">asBlock</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">iowa_lwm2m_object_link_t</span><span class="w"> </span><span class="n">asObjLink</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_data_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This structure contains the value of a LwM2M resource along its complete URI.</p>
<dl>
<dt>objectID</dt>
<dd>ID of the Object containing the resource.</dd>
<dt>instanceID</dt>
<dd>ID of the Object Instance containing the resource.</dd>
<dt>resourceID</dt>
<dd>ID of the resource.</dd>
<dt>resInstanceID</dt>
<dd>ID of the resource instance. For single instance resource, this is always <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
<dt>type</dt>
<dd>The datatype of the resource.</dd>
<dt>value.asBoolean</dt>
<dd>The value of the resource when type is <strong>IOWA_LWM2M_TYPE_BOOLEAN</strong>.</dd>
<dt>value.asInteger</dt>
<dd>The value of the resource when type is <strong>IOWA_LWM2M_TYPE_INTEGER</strong>, <strong>IOWA_LWM2M_TYPE_TIME</strong> or <strong>IOWA_LWM2M_TYPE_UNSIGNED_INTEGER</strong>.</dd>
<dt>value.asFloat</dt>
<dd>The value of the resource when type is <strong>IOWA_LWM2M_TYPE_FLOAT</strong>.</dd>
<dt>value.asBuffer</dt>
<dd>The value of the resource when type is <strong>IOWA_LWM2M_TYPE_CORE_LINK</strong>, <strong>IOWA_LWM2M_TYPE_STRING</strong>, <strong>IOWA_LWM2M_TYPE_OPAQUE</strong> or <strong>IOWA_LWM2M_TYPE_UNDEFINED</strong>.</dd>
<dt>value.asBlock</dt>
<dd>A part of the value of the resource when type is <strong>IOWA_LWM2M_TYPE_STRING_BLOCK</strong>, <strong>IOWA_LWM2M_TYPE_OPAQUE_BLOCK</strong>, or <strong>IOWA_LWM2M_TYPE_CORE_LINK_BLOCK</strong>. See <a href="#streamable">Custom Object Streaming APIs</a> for usage details.</dd>
<dt>value.asObjLink</dt>
<dd>The value of the resource when type is <strong>IOWA_LWM2M_TYPE_OBJECT_LINK</strong>.</dd>
<dt>timestamp</dt>
<dd>The timestamp value in seconds. Time is always absolute, and timestamp is present when the value is greater than zero. This can not be negative.</dd>
</dl>
<h3 id="commonapi-iowa_lwm2m_protocol_version_t">iowa_lwm2m_protocol_version_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_LWM2M_VERSION_UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_LWM2M_VERSION_1_0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_LWM2M_VERSION_1_1</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_protocol_version_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible LwM2M Enabler version. It is an enumeration of the following values:</p>
<dl>
<dt>IOWA_LWM2M_VERSION_UNDEFINED</dt>
<dd>Unknown LwM2M enabler version.</dd>
<dt>IOWA_LWM2M_VERSION_1_0</dt>
<dd>LwM2M Enabler version 1.0.</dd>
<dt>IOWA_LWM2M_VERSION_1_1</dt>
<dd>LwM2M Enabler version 1.1.</dd>
</dl>
<h3 id="commonapi-iowa_object_version_t">iowa_object_version_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">major</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">minor</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_object_version_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_object_version_t</code> structure is used to set the version of an object.</p>
<dl>
<dt>major</dt>
<dd>Major version of the Object.</dd>
<dt>minor</dt>
<dd>Minor version of the Object.</dd>
</dl>
<p><strong>Notes</strong></p>
<p>To set the object version in a Client application, you need to call <a href="#clientapi-iowa_client_object_set_configuration"><code>iowa_client_object_set_configuration()</code></a> with <strong>IOWA_OBJECT_SETTING_VERSION</strong> as setting and a pointer to <code>iowa_object_version_t</code> as argument.</p>
<h3 id="commonapi-iowa_lwm2m_object_link_t">iowa_lwm2m_object_link_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_object_version_t</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_object_link_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h3 id="commonapi-iowa_content_format_t">iowa_content_format_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">iowa_content_format_t</span><span class="p">;</span><span class="w"></span>

<span class="cp">#define IOWA_CONTENT_FORMAT_TEXT       0</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_OPAQUE     42</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_CBOR       60</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_SENML_JSON 110</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_SENML_CBOR 112</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_TLV_OLD    1542</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_JSON_OLD   1543</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_TLV        11542</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_JSON       11543</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_LWM2M_CBOR 11544</span>
<span class="cp">#define IOWA_CONTENT_FORMAT_UNSET      0xFFFF</span>
</code></pre></div>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_CONTENT_FORMAT_TEXT</dt>
<dd>Plain text encoding (e.g. "123", "-123.45"). Usable only for single resource encoding.</dd>
<dt>IOWA_CONTENT_FORMAT_OPAQUE</dt>
<dd>A sequence of binary octets. Usable only for single resource encoding which data type is <strong>Opaque</strong>.</dd>
<dt>IOWA_CONTENT_FORMAT_CBOR</dt>
<dd>CBOR encoding. Usable only for single resource encoding.</dd>
<dt>IOWA_CONTENT_FORMAT_SENML_JSON</dt>
<dd>LwM2M specific SenML JSON encoding. This may not be supported by all Clients. See <a href="#serverapi-iowa_client_t"><code>iowa_client_t</code></a>.</dd>
<dt>IOWA_CONTENT_FORMAT_SENML_CBOR</dt>
<dd>LwM2M specific SenML CBOR encoding. This may not be supported by all Clients. See <a href="#serverapi-iowa_client_t"><code>iowa_client_t</code></a>.</dd>
<dt>IOWA_CONTENT_FORMAT_TLV_OLD</dt>
<dd>LwM2M specific binary Type-Length-Value format. Usually the most compact one. This one is not anymore used, it only serves as backward compatibility with old LwM2M stack implementation (previous 1.0).</dd>
<dt>IOWA_CONTENT_FORMAT_JSON_OLD</dt>
<dd>LwM2M specific JSON encoding. This may not be supported by all Clients. See <a href="#serverapi-iowa_client_t"><code>iowa_client_t</code></a>. This one is not anymore used, it only serves as backward compatibility with old LwM2M stack implementation (previous 1.0).</dd>
<dt>IOWA_CONTENT_FORMAT_TLV</dt>
<dd>LwM2M specific binary Type-Length-Value format. Usually the most compact one.</dd>
<dt>IOWA_CONTENT_FORMAT_JSON</dt>
<dd>LwM2M specific JSON encoding. This may not be supported by all Clients. See <a href="#serverapi-iowa_client_t"><code>iowa_client_t</code></a>.</dd>
<dt>IOWA_CONTENT_FORMAT_LWM2M_CBOR</dt>
<dd>LwM2M specific binary format replacing the TLV format. Usually the most compact one.</dd>
<dt>IOWA_CONTENT_FORMAT_UNSET</dt>
<dd>Used to reset the encoding to the default one.</dd>
</dl>
<h3 id="commonapi-iowa_lwm2m_uri_t">iowa_lwm2m_uri_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resInstanceId</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_uri_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This structure represents a LwM2M URI.</p>
<p>In the LwM2M resource model, resources are grouped into Objects. These Objects have instances. Hence the URI of a resource is in the form <strong><code>/{Object}/{Object Instance}/{Resource}</code></strong>. Moreover some resources, described are <em>multiple</em>, can have several instances, leading to URI in the form <strong><code>/{Object}/{Object Instance}/{Resource}/{Resource Instance}</code></strong>.</p>
<dl>
<dt><em>objectId</em></dt>
<dd>ID of a LwM2M Object.</dd>
<dt><em>instanceId</em></dt>
<dd>ID of the Object Instance.</dd>
<dt><em>resourceId</em></dt>
<dd>ID of the resource.</dd>
<dt><em>resInstanceId</em></dt>
<dd>ID of the resource instance.</dd>
</dl>
<p>When a segment of the URI is not set, the value of the corresponding field is set to <strong>IOWA_LWM2M_ID_ALL</strong>.</p>
<p>For instance, the URI <code>/3/0/9</code> is represented as:
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">objectId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">instanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">resourceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">resInstanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_LWM2M_ID_ALL</span><span class="w"></span>
</code></pre></div></p>
<p>the URI <code>/5</code> is represented as:
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">objectId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">instanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_LWM2M_ID_ALL</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">resourceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_LWM2M_ID_ALL</span><span class="w"></span>
<span class="n">iowa_lwm2m_uri_t</span><span class="o">::</span><span class="n">resInstanceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IOWA_LWM2M_ID_ALL</span><span class="w"></span>
</code></pre></div></p>
<hr />
<h2 id="commonapi-api">API</h2>
<h3 id="commonapi-iowa_init">iowa_init</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_context_t</span><span class="w"> </span><span class="nf">iowa_init</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_init()</code> initializes an IOWA context.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>userData</em></dt>
<dd>Pointer to application-specific data. This is passed as argument to the Communication Abstraction Interface functions. This can be nil.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> in case of success or NULL in case of memory allocation error.</p>
<p><strong>Header File</strong></p>
<p>iowa.h</p>
<hr />
<h3 id="commonapi-iowa_step">iowa_step</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_step</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timeout</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_step()</code> runs the stack engine during the specified time.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>timeout</em></dt>
<dd>The allowed time to run in seconds.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>either:</dd>
<dd>
<ul>
<li>a memory allocation failed.</li>
</ul>
</dd>
<dd>
<ul>
<li><a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> returned an error.</li>
</ul>
</dd>
<dt>IOWA_COAP_503_SERVICE_UNAVAILABLE</dt>
<dd>one of the <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection...()</code></a> functions returned an error.</dd>
<dd>LwM2M Client only: when the Client failed to connect to any Server. (<a href="#clientapi-iowa_event_callback_t">iowa_event_callback_t</a> is called with a <strong>IOWA_EVENT_REG_FAILED</strong> event.)</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa.h</p>
<p><strong>Notes</strong></p>
<p>If <em>timeout</em> is a negative value:</p>
<ul>
<li><code>iowa_step()</code> will return only in case of error.</li>
<li><a href="#abstractionlayer-iowa_system_connection_select"><code>iowa_system_connection_select()</code></a> will be called with <strong>INT32_MAX</strong>.</li>
</ul>
<p>For LwM2M Clients: if <code>iowa_step()</code> returns an <strong>IOWA_COAP_503_SERVICE_UNAVAILABLE</strong> error because it is not registered to any LwM2M Server, subsequent call to <code>iowa_step()</code>, will retry to register to the known LwM2M Servers.</p>
<p><a href="#commonapi-iowa_stop"><code>iowa_stop()</code></a> can be used to make <code>iowa_step()</code>return immediately.</p>
<p><code>iowa_step()</code> is not thread-safe against itself when called on the same IOWA context. Thus there should be only a single thread calling <code>iowa_step()</code> for a given IOWA context. Note that all other IOWA APIs are thread-safe.</p>
<hr />
<h3 id="commonapi-iowa_flush_before_pause">iowa_flush_before_pause</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_flush_before_pause</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">duration</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">delayP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_flush_before_pause()</code> is used to inform the stack that the device will pause. <code>iowa_flush_before_pause()</code> performs all the pending and required operations of the stack engine before returning.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>duration</em></dt>
<dd>The duration of the planned pause in seconds.</dd>
<dt><em>delayP</em></dt>
<dd>The delay before the next IOWA scheduled operation.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>duration</em> is negative.</li>
</ul>
</dd>
<dd>
<ul>
<li>for a LwM2M Client: <em>duration</em> is longer than one of the LwM2M Server registration lifetime.</li>
</ul>
</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>either:</dd>
<dd>
<ul>
<li>a memory allocation failed.</li>
</ul>
</dd>
<dd>
<ul>
<li><a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> returned an error.</li>
</ul>
</dd>
<dt>IOWA_COAP_503_SERVICE_UNAVAILABLE</dt>
<dd>one of the <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection...()</code></a> functions returned an error.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa.h</p>
<p><strong>Notes</strong></p>
<p>In LwM2M Client mode: if no server are configured, the function returns immediately with no error.</p>
<p>A LwM2M Server should never stop. For a LwM2M Server, <code>iowa_flush_before_pause()</code> will just wait for all pending CoAP transactions to finish.</p>
<hr />
<h3 id="commonapi-iowa_close">iowa_close</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_close</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_close()</code> closes an IOWA context.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa.h</p>
<hr />
<h3 id="commonapi-iowa_clock_reset">iowa_clock_reset</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_clock_reset</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_clock_reset()</code> informs IOWA that <a href="#iowa_system_gettime"><code>iowa_system_gettime()</code></a> has lost track of time and that IOWA must re-synchronize its internal timers.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>
<ul>
<li>the <a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> function returned an error.</li>
</ul>
</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa.h</p>
<p><strong>Notes</strong></p>
<p>When used as a LwM2M Client, IOWA will update the registrations to the LwM2M Servers. If Resources are under observation with time attributes (<a href="#lwm2moverview-write-attributes">pmin or pmax</a>), IOWA will sends a Notification.</p>
<hr />
<h3 id="commonapi-iowa_connection_closed">iowa_connection_closed</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_connection_closed</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">connP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_connection_closed()</code> informs IOWA that a connection was closed by an external event (e.g. peer disconnection).</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>connP</em></dt>
<dd>The closed connection of the same user-defined type as the one returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa.h</p></section><section class="print-page" id="clientapi"><h1 id="clientapi-client-mode-api-reference">Client Mode API Reference</h1>
<blockquote>
<p>This is an excerpt from the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote>
<p>The functions explained below are defined inside the file <em>include/iowa_client.h</em> and the Objects folder <em>include/objects</em>.</p>
<h2 id="clientapi-client-pseudo-code">Client pseudo code</h2>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;iowa_client.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;iowa_ipso.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">iowaH</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_device_info_t</span><span class="w"> </span><span class="n">devInfo</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">sensorId</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">    * Initialization</span>
<span class="cm">    */</span><span class="w"></span>

<span class="w">    </span><span class="n">iowaH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">manufacturer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;IOTEROP&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">deviceType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Example device&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">modelNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">serialNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">hardwareVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">softwareVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">devInfo</span><span class="p">.</span><span class="n">optFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_configure</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IOWA_Sample_Client&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">devInfo</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_IPSO_add_sensor</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="n">IOWA_IPSO_VOLTAGE</span><span class="p">,</span><span class="w"> </span><span class="mf">12.0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="s">&quot;V&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Test DC&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="o">&amp;</span><span class="n">sensorId</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_add_server</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;coap://localhost:5683&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">IOWA_SEC_NONE</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="cm">/******************</span>
<span class="cm">    * &quot;Main loop&quot;</span>
<span class="cm">    */</span><span class="w"></span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IOWA_COAP_NO_ERROR</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">sensorValue</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_step</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">sensorValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_battery_voltage</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iowa_client_IPSO_update_value</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">sensorId</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="n">sensorValue</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">iowa_client_IPSO_remove_sensor</span><span class="p">(</span><span class="n">iowaH</span><span class="p">,</span><span class="w"> </span><span class="n">sensorId</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_close</span><span class="p">(</span><span class="n">iowaH</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<hr />
<h2 id="clientapi-data-types">Data types</h2>
<h3 id="clientapi-iowa_lwm2m_binding_t">iowa_lwm2m_binding_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_lwm2m_binding_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><strong>IOWA_LWM2M_BINDING_UNKNOWN</strong></dt>
<dd>The flag to define Unknown binding.</dd>
<dt><strong>IOWA_LWM2M_BINDING_UDP</strong></dt>
<dd>The flag to define UDP binding.</dd>
<dt><strong>IOWA_LWM2M_BINDING_TCP</strong></dt>
<dd>The flag to define TCP binding.</dd>
<dt><strong>IOWA_LWM2M_BINDING_SMS</strong></dt>
<dd>The flag to define SMS binding.</dd>
<dt><strong>IOWA_LWM2M_BINDING_NON_IP</strong></dt>
<dd>The flag to define Non-IP binding.</dd>
</dl>
<h3 id="clientapi-iowa_server_status_t">iowa_server_status_t</h3>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_SERVER_STATUS_UNREGISTERED</dt>
<dd>This is the initial state of any server.</dd>
<dt>IOWA_SERVER_STATUS_REGISTERING</dt>
<dd>IOWA is currently registering to this server.</dd>
<dt>IOWA_SERVER_STATUS_REGISTERED</dt>
<dd>IOWA is registered to this server.</dd>
<dt>IOWA_SERVER_STATUS_REGISTRATION_FAILED</dt>
<dd>IOWA failed to register to this server.</dd>
<dt>IOWA_SERVER_STATUS_BOOTSTRAPPING</dt>
<dd>This server is the LwM2M Bootstrap Server and it is currently bootstrapping IOWA.</dd>
</dl>
<h3 id="clientapi-iowa_server_info_t">iowa_server_info_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">                </span><span class="n">shortId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">             </span><span class="o">*</span><span class="n">uriP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w">                 </span><span class="n">lifetime</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_binding_t</span><span class="w">    </span><span class="n">binding</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w">                    </span><span class="n">queueMode</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_server_status_t</span><span class="w">    </span><span class="n">status</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">                </span><span class="n">securityObjectInstanceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">                </span><span class="n">serverObjectInstanceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">                </span><span class="n">oscoreObjectInstanceId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_protocol_version_t</span><span class="w"> </span><span class="n">lwm2mVersion</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_server_info_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_server_info_t</code> structure is used to get the shortID and the parameters of the configured servers.</p>
<dl>
<dt>shortId</dt>
<dd>the Short ID assigned to the server.</dd>
<dt>uriP</dt>
<dd>The uri to connect with the server.</dd>
<dt>lifetime</dt>
<dd>The lifetime in seconds of the registration to the server.</dd>
<dt>binding</dt>
<dd>The binding used to connect to the server.</dd>
<dt>queueMode</dt>
<dd>The state of the Queue mode of the server.</dd>
<dt>status</dt>
<dd>The current registration status of the server.</dd>
<dt>securityObjectInstanceId</dt>
<dd>The ID of the Security Object Instance holding the server information.</dd>
<dt>serverObjectInstanceId</dt>
<dd>The ID of the Server Object Instance holding the server information. The value is <strong>IOWA_LWM2M_ID_ALL</strong> for a LwM2M Bootstrap-Server.</dd>
<dt>oscoreObjectInstanceId</dt>
<dd>The ID of the OSCORE Object Instance holding the server information. The value is <strong>IOWA_LWM2M_ID_ALL</strong> if the server does not use OSCORE or if <strong>IOWA_COAP_OSCORE_SUPPORT</strong> is not defined.</dd>
<dt>lwm2mVersion</dt>
<dd>The LwM2M protocol version used by the server. See <a href="#commonapi-iowa_lwm2m_protocol_version_t"><code>iowa_lwm2m_protocol_version_t</code></a>.</dd>
</dl>
<h3 id="clientapi-iowa_device_info_t">iowa_device_info_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">manufacturer</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">deviceType</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">modelNumber</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">serialNumber</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">hardwareVersion</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">firmwareVersion</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">softwareVersion</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">msisdn</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">altPath</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">    </span><span class="n">optFlags</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">utcOffsetP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">timezoneP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">    </span><span class="n">memoryTotal</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w">    </span><span class="n">memoryFree</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_time_update_callback_t</span><span class="w">    </span><span class="n">dataTimeUpdateCallback</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_client_factory_reset_callback_t</span><span class="w">  </span><span class="n">factoryResetCallback</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w">                                 </span><span class="o">*</span><span class="n">callbackUserDataP</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_device_info_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_device_info_t</code> structure exists only for the sake of the readability of <code>iowa_client_configure()</code>. It contains pointers to nil-terminated strings described below. As all these information are optional in a LwM2M Client, these pointers can be nil. The LwM2M standard does not mandate any format for these strings. They are manufacturer specific.</p>
<dl>
<dt>manufacturer</dt>
<dd>A human readable manufacturer name.</dd>
<dt>deviceType</dt>
<dd>The type of the device.</dd>
<dt>modelNumber</dt>
<dd>The number of the model.</dd>
<dt>serialNumber</dt>
<dd>The serial number of the device.</dd>
<dt>hardwareVersion</dt>
<dd>The current version of the device hardware.</dd>
<dt>firmwareVersion</dt>
<dd>The current version of the device firmware.</dd>
<dt>softwareVersion</dt>
<dd>The current version of the device software.</dd>
<dt>msisdn</dt>
<dd>The phone number of the device.</dd>
<dt>altPath</dt>
<dd>The LwM2M Alternative Path.</dd>
<dt>optFlags</dt>
<dd>Flags used to enable optional features. This value is a combination of:</dd>
</dl>
<ul>
<li><strong>IOWA_DEVICE_RSC_BATTERY</strong>: enables the battery level and status exposed in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a>. To update battery level you need to call <a href="#clientapi-iowa_client_device_update_battery"><code>iowa_client_device_update_battery()</code></a>.</li>
<li><strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong>: enables the power sources information in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a>. To add any new power source you need to call <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_add_device_power_source()</code></a>.</li>
<li><strong>IOWA_DEVICE_RSC_CURRENT_TIME</strong>: enables the use of current time in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a> (default value: 0).</li>
<li><strong>IOWA_DEVICE_RSC_UTC_OFFSET</strong>: enables the use of UTC offset in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a> (default value: utcOffsetP).</li>
<li><strong>IOWA_DEVICE_RSC_TIMEZONE</strong>: enables the use of timezone in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a> (default value: 0).
To update time information (current time, UTC offset, timezone) you need to call <a href="#clientapi-iowa_client_update_device_time_information"><code>iowa_client_update_device_time_information()</code></a></li>
<li><strong>IOWA_DEVICE_RSC_MEMORY_FREE</strong>: enables the Memory Free resource exposed in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a> (default value: <em>memoryFree</em>).</li>
<li><strong>IOWA_DEVICE_RSC_EXTERNAL_INFO</strong>: enables the ExtDevInfo resource exposed in the <a href="#clientapi-device-object-resources"><code>Device Object</code></a>. To set the Resource values, you need to call <a href="#clientapi-iowa_client_update_device_external_information"><code>iowa_client_update_device_external_information()</code></a>.</li>
</ul>
<dl>
<dt>utcOffsetP</dt>
<dd>Indicates the UTC offset currently in effect for this LwM2M Device. It should be in the ISO 8601 format (UTC+X).</dd>
<dt>timezoneP</dt>
<dd>Indicates in which time zone the LwM2M Device is located, in IANA Timezone (TZ) database format.</dd>
<dt>memoryTotal</dt>
<dd>Total amount of storage space which can store data and software in the LwM2M Device (expressed in kilobytes). Ignored if equal to zero.</dd>
<dt>memoryFree</dt>
<dd>Estimated current available amount of storage space which can store data and software in the LwM2M Device (expressed in kilobytes). Ignored if <em>optFlags</em> does not have <strong>IOWA_DEVICE_RSC_MEMORY_FREE</strong> set.</dd>
<dt>dataTimeUpdateCallback</dt>
<dd>The callback called when the time information is updated by the LwM2M Server.</dd>
<dt>factoryResetCallback</dt>
<dd>The callback called on a Factory Reset.</dd>
<dt>callbackUserDataP</dt>
<dd>Passed as argument to the callbacks <code>dataTimeUpdateCallback</code> and <code>factoryResetCallback</code>.</dd>
</dl>
<p><strong>Notes</strong></p>
<p>To update time information (current time, UTC offset, timezone) you need to call <a href="#clientapi-iowa_client_update_device_time_information"><code>iowa_client_update_device_time_information()</code></a></p>
<p>To update device related information (manufacturer, model number, serial number, firmware version, device type, hardware version, software version.) you need to call <a href="#clientapi-iowa_client_update_device_information"><code>iowa_client_update_device_information()</code></a>.</p>
<h3 id="clientapi-iowa_object_setting_id_t">iowa_object_setting_id_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_object_setting_id_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h4 id="clientapi-possible-values">Possible Values</h4>
<dl>
<dt><strong>IOWA_OBJECT_SETTING_VERSION</strong></dt>
<dd>A flag to set the version of the object, value is an <em>iowa_object_version_t</em>.</dd>
</dl>
<h3 id="clientapi-iowa_event_type_t">iowa_event_type_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_UNREGISTERED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_REGISTERING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_REGISTERED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_UPDATING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_FAILED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_REG_UPDATE_FAILED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_BS_PENDING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_BS_FINISHED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_BS_FAILED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBSERVATION_STARTED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBSERVATION_NOTIFICATION</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBSERVATION_NOTIFICATION_ACKED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBSERVATION_NOTIFICATION_FAILED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBSERVATION_CANCELED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBJECT_INSTANCE_CREATED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_OBJECT_INSTANCE_DELETED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_EVALUATION_PERIOD</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_READ</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">IOWA_EVENT_SERVER_SETTING_CHANGED</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_event_type_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>iowa_event_type_t</code> contains the possible events that can be reported by the IOWA stack.</p>
<h3 id="clientapi-iowa_event_t">iowa_event_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_event_type_t</span><span class="w"> </span><span class="n">eventType</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">          </span><span class="n">serverShortId</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">union</span>
    <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">lifetime</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">bool</span><span class="w"> </span><span class="n">internalError</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_status_t</span><span class="w"> </span><span class="n">errorCode</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">registration</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">sensorId</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">notificationNumber</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceId</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">minPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">minEvalPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxEvalPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">observation</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_lwm2m_uri_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">uriP</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">objectInstance</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_lwm2m_uri_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">uriP</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">minEvalPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxEvalPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">evalPeriod</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">sensorId</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">sensor</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span>
        <span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">iowa_server_setting_id_t</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">union</span>
            <span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="kt">bool</span><span class="w"> </span><span class="n">asBoolean</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">asUInt32</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">asInt32</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">iowa_lwm2m_binding_t</span><span class="w"> </span><span class="n">asBinding</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">serverSetting</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">details</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_event_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt>eventType</dt>
<dd>the event type.</dd>
<dt>serverShortId</dt>
<dd>the short server ID of the LwM2M Server generating this event.</dd>
<dt>details</dt>
<dd>the details of the event.</dd>
<dt>details::registration</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_REG_UNREGISTERED</strong>, <strong>IOWA_EVENT_REG_REGISTERING</strong>, <strong>IOWA_EVENT_REG_REGISTERED</strong>, <strong>IOWA_EVENT_REG_UPDATING</strong>, <strong>IOWA_EVENT_REG_FAILED</strong> or <strong>IOWA_EVENT_REG_UPDATE_FAILED</strong>.</dd>
<dt>details::registration::lifetime</dt>
<dd>the lifetime of the registration to the LwM2M Server generating this event.</dd>
<dt>details::registration::internalError</dt>
<dd>indicates if the error for a failed registration or registration update is coming from an internal issue or if it an error returned by the LwM2M Server. Set only when the event is of type <strong>IOWA_EVENT_REG_FAILED</strong> or <strong>IOWA_EVENT_REG_UPDATE_FAILED</strong>.</dd>
<dt>details::registration::errorCode</dt>
<dd>an <a href="#commonapi-iowa_status_t"><code>iowa_status_t</code></a> indicating the reason for a failed registration or registration update. Set only when the event is of type <strong>IOWA_EVENT_REG_FAILED</strong> or <strong>IOWA_EVENT_REG_UPDATE_FAILED</strong>.</dd>
<dt>details::observation</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_OBSERVATION_STARTED</strong>,  <strong>IOWA_EVENT_OBSERVATION_NOTIFICATION</strong>, <strong>IOWA_EVENT_OBSERVATION_NOTIFICATION_ACKED</strong>, <strong>IOWA_EVENT_OBSERVATION_NOTIFICATION_FAILED</strong>, or <strong>IOWA_EVENT_OBSERVATION_CANCELED</strong></dd>
<dt>details::observation::sensorId</dt>
<dd>the ID of the sensor under observation.</dd>
<dt>details::observation::resourceId</dt>
<dd>the ID of the specific resource under observation of the sensor. This may be <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
<dt>details::observation::minPeriod</dt>
<dd>the minimum time in seconds to wait between notifications for the observation. If not set the minPeriod is to 0.</dd>
<dt>details::observation::maxPeriod</dt>
<dd>the maximum time in seconds to wait between notifications for the observation. If not set the maxPeriod is to UINT32_MAX.</dd>
<dt>details::observation::minEvalPeriod</dt>
<dd>the minimum sample time in seconds for the observed sensor in LwM2M 1.1 or later. If not set the minEvalPeriod is to 0.</dd>
<dt>details::observation::maxEvalPeriod</dt>
<dd>the maximum sample time in seconds for the observed sensor in LwM2M 1.1 or later. If not set the maxEvalPeriod is to UINT32_MAX.</dd>
<dt>details::instance</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_OBJECT_INSTANCE_CREATED</strong> or <strong>IOWA_EVENT_OBJECT_INSTANCE_DELETED</strong>.</dd>
<dt>details::instance::uri</dt>
<dd>a pointer to the <code>iowa_lwm2m_uri_t</code> of the instance that has been created or deleted.</dd>
<dt>details::evalPeriod</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_EVALUATION_PERIOD</strong>. Available when the flag IOWA_LWM2M_VERSION_1_1 is set.</dd>
<dt>details::evalPeriod::uriP</dt>
<dd>a pointer to the <code>iowa_lwm2m_uri_t</code> of the uri where evaluation period has been set.</dd>
<dt>details::evalPeriod::minEvalPeriod</dt>
<dd>the minimum sample time in seconds for the concerned uri. If the LwM2M Server unsets it or does not set it, the value is 0.</dd>
<dt>details::evalPeriod::maxEvalPeriod</dt>
<dd>the maximum sample time in seconds for the concerned uri. If the LwM2M Server unsets it or does not set it, the value is UINT32_MAX.</dd>
<dt>details::sensor</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_READ</strong>.</dd>
<dt>details::sensor::sensorId</dt>
<dd>the ID of the sensor targeted by a Read operation from the LwM2M Server.</dd>
<dt>details::serverSetting</dt>
<dd>filled when the event is of type <strong>IOWA_EVENT_SERVER_SETTING_CHANGED</strong>.</dd>
<dt>details::serverSetting::id</dt>
<dd>the ID of the LwM2M Server setting that changed.</dd>
<dt>details::serverSetting::value</dt>
<dd>the value of the LwM2M Server setting depending on the setting ID. See <a href="#clientapi-iowa_server_setting_id_t"><code>iowa_server_setting_id_t</code></a>.</dd>
</dl>
<p>The <code>iowa_event_t</code> is used by <code>iowa_event_callback_t</code> when an event occurred on a client. These events are described by <code>iowa_event_type_t</code>.</p>
<p><strong>Notes</strong></p>
<p>The IOWA stack handles the minimum and maximum observation periods. They are provided in <code>iowa_event_t</code> as an information for the application. Embedded devices may use this information to tune their measurement or sleeping schedule.</p>
<p>The IOWA stack does not handle the minimum and maximum evaluation observation periods. They are provided in <code>iowa_event_t</code> as sample times for the application. Embedded devices may use those sample times to tune their measurement or sleeping schedule.</p>
<p>For events of type <strong>IOWA_EVENT_REG_FAILED</strong> or <strong>IOWA_EVENT_REG_UPDATE_FAILED</strong>, <code>details::registration::internalError</code> set to <code>true</code> indicates an internal error. <code>details::registration::errorCode</code> indicates the type of error:
* <strong>IOWA_COAP_406_NOT_ACCEPTABLE</strong>: the response from the LwM2M Server is not valid.
* <strong>IOWA_COAP_500_INTERNAL_SERVER_ERROR</strong>: a memory allocation failed.
* <strong>IOWA_COAP_503_SERVICE_UNAVAILABLE</strong>: lost connection to the LwM2M Server.</p>
<p>The IOWA stack generates events of type <strong>IOWA_EVENT_SERVER_SETTING_CHANGED</strong> when a LwM2M Server performs a LwM2M Write operation on the matching resource in the LwM2M server Object. The event is generated even if the written value is the same as the previous one.</p>
<h3 id="clientapi-iowa_device_time_info_t">iowa_device_time_info_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w">    </span><span class="n">flags</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w">     </span><span class="n">currentTime</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">utcOffsetP</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">timezoneP</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_device_time_info_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt>flags</dt>
<dd>Flags used to enable optional time information. This value is a combination of:</dd>
</dl>
<ul>
<li><strong>IOWA_DEVICE_RSC_CURRENT_TIME</strong> : current time has a new current time value from server</li>
<li><strong>IOWA_DEVICE_RSC_UTC_OFFSET</strong> : current time has a new UTC offset value from server</li>
<li><strong>IOWA_DEVICE_RSC_TIMEZONE</strong> : current time has a new timezone value from server</li>
</ul>
<dl>
<dt>currentTime</dt>
<dd>Current UNIX time of the LwM2M Client in seconds.</dd>
<dt>utcOffsetP</dt>
<dd>Indicates the UTC offset currently in effect for this LwM2M Device. It should be in the ISO 8601 format (UTC+X). Could be nil, if not UTC offset is enable.</dd>
<dt>timezoneP</dt>
<dd>Indicates in which time zone the LwM2M Device is located, in IANA Timezone (TZ) database format. Could be nil, if not Timezone is enable.</dd>
</dl>
<h3 id="clientapi-iowa_ipso_timed_value_t">iowa_ipso_timed_value_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_ipso_timed_value_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt>value</dt>
<dd>The timestamped value.</dd>
<dt>timestamp</dt>
<dd>The timestamp associated to the value in seconds. This can not be negative.</dd>
</dl>
<h3 id="clientapi-iowa_sensor_t">iowa_sensor_t</h3>
<p>This must be treated as an opaque type. It is internally mapped to a 32-bit unsigned integer.</p>
<p><strong>Special Values</strong></p>
<dl>
<dt><strong>IOWA_INVALID_SENSOR_ID</strong></dt>
<dd>Used to indicate an error by APIs returning an <code>iowa_sensor_t</code>.</dd>
<dt><strong>IOWA_DEVICE_TIME_SENSOR_ID</strong></dt>
<dd>The sensor ID of the Current Time of the device. This is internally mapped to the resource 13 in the <a href="#lwm2moverview-device-object">Device Object</a>.</dd>
</dl>
<h3 id="clientapi-iowa_lwm2m_resource_desc_t">iowa_lwm2m_resource_desc_t</h3>
<p>This structure contains the description of a LwM2M resource.
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_lwm2m_data_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">operations</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">flags</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_lwm2m_resource_desc_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div></p>
<dl>
<dt><em>id</em></dt>
<dd>ID of the resource.</dd>
<dt><em>type</em></dt>
<dd>The datatype of the resource.</dd>
<dt><em>operations</em></dt>
<dd>The operations allowed on the resource.</dd>
<dd>This is a mask of values <strong>IOWA_OPERATION_READ</strong>, <strong>IOWA_OPERATION_WRITE</strong> and <strong>IOWA_OPERATION_EXECUTE</strong>.</dd>
<dt><em>flags</em></dt>
<dd>The flags of the resource.</dd>
<dd>This is a mask of values <strong>IOWA_RESOURCE_FLAG_NONE</strong>, <strong>IOWA_RESOURCE_FLAG_OPTIONAL</strong>, <strong>IOWA_RESOURCE_FLAG_MANDATORY</strong>, <strong>IOWA_RESOURCE_FLAG_MULTIPLE</strong>, and <strong>IOWA_RESOURCE_FLAG_ASYNCHRONOUS</strong>.</dd>
</dl>
<h3 id="clientapi-iowa_sensor_uri_t">iowa_sensor_uri_t</h3>
<p>This structure describes a sensor URI.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceId</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_sensor_uri_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>id</em></dt>
<dd>ID of the object.</dd>
<dt><em>resourceId</em></dt>
<dd>The ID of the resource. This can be <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
</dl>
<hr />
<h2 id="clientapi-callbacks">Callbacks</h2>
<h3 id="clientapi-iowa_event_callback_t">iowa_event_callback_t</h3>
<p>This is the event callback, called when an event such as registration update or unregister occurred.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_event_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_event_t</span><span class="o">*</span><span class="w"> </span><span class="n">eventP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>eventP</em></dt>
<dd>The event stored in a structure.</dd>
<dt><em>userData</em></dt>
<dd>A pointer to application specific data. This is a parameter of <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> was called.</dd>
</dl>
<h3 id="clientapi-iowa_client_time_update_callback_t">iowa_client_time_update_callback_t</h3>
<p>This callback is called when time information are updated by server.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_client_time_update_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_device_time_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">timeInfoP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="kt">void</span><span class="w">  </span><span class="o">*</span><span class="n">userDataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>timeInfoP</em></dt>
<dd>Current device time information.</dd>
<dt><em>userDataP</em></dt>
<dd>A pointer to application specific data. This is the parameter of <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> was called.</dd>
</dl>
<h3 id="clientapi-iowa_client_factory_reset_callback_t">iowa_client_factory_reset_callback_t</h3>
<p>This callback is called when a factory reset is requested.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_client_factory_reset_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">userDataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>userDataP</em></dt>
<dd>A pointer to application specific data. This is the parameter of <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> was called.</dd>
</dl>
<h3 id="clientapi-iowa_rwe_callback_t">iowa_RWE_callback_t</h3>
<p>This callback is called when a Read, Write or Execute operation is performed on a resource of a custom LwM2M Object.
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="n">iowa_status_t</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_RWE_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">iowa_lwm2m_data_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dataP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">numData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div></p>
<dl>
<dt><em>operation</em></dt>
<dd>The operation to perform on the resource among <strong>IOWA_DM_READ</strong>, <strong>IOWA_DM_WRITE</strong> and <strong>IOWA_DM_EXECUTE</strong>.</dd>
<dt><em>dataP</em></dt>
<dd>An array of the URIs of the targeted resources.</dd>
<dd>For a Write operation, it also contains the value to write.</dd>
<dd>For a Read operation, the result is to be stored in this.</dd>
<dt><em>numData</em></dt>
<dd>Number of resources in dataP.</dd>
<dt><em>userData</em></dt>
<dd>A pointer to application specific data. This is the parameter of <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a> was called.</dd>
</dl>
<p><strong>Notes</strong></p>
<ul>
<li>Before calling this callback, the IOWA stack performs checks on the resource existence and its allowed operations. In case of a Write operation, the data type is also checked for conformance.</li>
<li>The LwM2M Execute operation may have parameters. If so, they are provided as a string in <em>dataP</em>.</li>
<li>After <a href="#commonapi-iowa_dm_operation_t"><strong>IOWA_DM_READ</strong></a> operation, the callback is called with <a href="#commonapi-iowa_dm_operation_t"><strong>IOWA_DM_FREE</strong></a> operation to permit the deallocation of memory that may have been allocated by the callback previously.</li>
<li>In case of a write operation on resource-instances level, if the Write operation is a <em>Replace</em>, and not a <em>Partial Update</em>, the callback will be called first with <a href="#commonapi-iowa_dm_operation_t"><strong>IOWA_DM_DELETE</strong></a> to erase the current resource-instances, then it will be called with <a href="#commonapi-iowa_dm_operation_t"><strong>IOWA_DM_WRITE</strong></a> to write the new values. in case of a <em>Partial Update</em> Write operation, the callback will be called with <a href="#commonapi-iowa_dm_operation_t"><strong>IOWA_DM_WRITE</strong></a> only, where it will change or append the current resource-instances values.</li>
</ul>
<h3 id="clientapi-iowa_cd_callback_t">iowa_CD_callback_t</h3>
<p>This callback is called when a Create or Delete operation is performed on an instance of a custom LwM2M Object.
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="n">iowa_status_t</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_CD_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div></p>
<dl>
<dt><em>operation</em></dt>
<dd>The operation to perform on the instance among <strong>IOWA_DM_CREATE</strong> and <strong>IOWA_DM_DELETE</strong>.</dd>
<dt><em>objectID</em></dt>
<dd>The ID of the targeted Object.</dd>
<dt><em>instanceID</em></dt>
<dd>The ID of the targeted instance.</dd>
<dt><em>userData</em></dt>
<dd>A pointer to application specific data. This is the parameter of <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a> was called.</dd>
</dl>
<h3 id="clientapi-iowa_ri_callback_t">iowa_RI_callback_t</h3>
<p>This callback is called to retrieve the list of current resource instance IDs for a multiple resource.
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="n">iowa_status_t</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_RI_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nbResInstanceP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">resInstanceArrayP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">);</span><span class="w"></span>
</code></pre></div></p>
<dl>
<dt><em>objectID</em></dt>
<dd>The ID of the Object the resource belongs to.</dd>
<dt><em>instanceID</em></dt>
<dd>The ID of the Object Instance the resource belongs to.</dd>
<dt><em>resourceID</em></dt>
<dd>The ID of the targeted resource.</dd>
<dt><em>nbResInstanceP</em></dt>
<dd>Used to store the number of elements in resInstanceArrayP.</dd>
<dt><em>resInstanceArrayP</em></dt>
<dd>Used to store an array containing the resource instances IDs. This array will be freed by the caller by calling <a href="#abstractionlayer-iowa_system_free"><code>iowa_system_free()</code></a>.</dd>
<dt><em>userData</em></dt>
<dd>A pointer to application specific data. This is the parameter of <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a>.</dd>
<dt><em>contextP</em></dt>
<dd>The IOWA context on which <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a> was called.</dd>
</dl>
<hr />
<h2 id="clientapi-api">API</h2>
<h3 id="clientapi-iowa_client_configure">iowa_client_configure</h3>
<p><strong>Prototype</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_configure</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">identity</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="n">iowa_device_info_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">infoP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="n">iowa_event_callback_t</span><span class="w"> </span><span class="n">eventCb</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<strong>Description</strong></p>
<p><code>iowa_client_configure()</code> sets the information of the LwM2M Client.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>identity</em></dt>
<dd>The unique identity of the LwM2M Client as a nil-terminated string.</dd>
<dt><em>infoP</em></dt>
<dd>The optional information of the LwM2M Client. This can be nil.</dd>
<dt><em>eventCb</em></dt>
<dd>The callback called when an event occurred. This can be nil.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>COAP_400_BAD_REQUEST</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>identity</em> is nil or empty and <strong>LWM2M_VERSION_1_1_SUPPORT</strong> is not set.</li>
</ul>
</dd>
<dd>
<ul>
<li>the maximum length of <em>infoP-&gt;msisdn</em> is 15 digits.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>infoP-&gt;msisdn</em> is not nil, but <strong>IOWA_SMS_SUPPORT</strong> is not defined.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>infoP-&gt;altPath</em> contains an invalid URI path.</li>
</ul>
</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>the client was already configured in this context. To reconfigure the client, close than reopen a fresh IOWA context with <a href="#commonapi-iowa_close"><code>iowa_close()</code></a> and <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>The nil-terminated strings pointed by the fields of <em>infoP</em> are not duplicated nor freed by IOWA. Make sure they are available until <a href="#commonapi-iowa_close"><code>iowa_close()</code></a> is called. It is advised to use static strings.</p>
<h4 id="clientapi-device-object-resources">Device Object Resources</h4>
<p>The LwM2M Client information is exposed to the LwM2M Server through the Resources of the <a href="#lwm2moverview-device-object"><code>Device Object</code></a> (ID: 3). The following table explained the mapping:</p>
<table>
<thead>
<tr>
<th>Resource ID</th>
<th>Resource Name</th>
<th>API</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Manufacturer</td>
<td><em>manufacturer</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_MANUFACTURER</strong> must be defined.</td>
</tr>
<tr>
<td>1</td>
<td>Model Number</td>
<td><em>modelNumber</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_MODEL_NUMBER</strong> must be defined.</td>
</tr>
<tr>
<td>2</td>
<td>Serial Number</td>
<td><em>serialNumber</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_SERIAL_NUMBER</strong> must be defined.</td>
</tr>
<tr>
<td>3</td>
<td>Firmware Version</td>
<td><em>firmwareVersion</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_FIRMWARE_VERSION</strong> must be defined.</td>
</tr>
<tr>
<td>4</td>
<td>Reboot</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>Factory Reset</td>
<td>Set the callback <em>factoryResetCallback</em> of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_FACTORY_RESET</strong> must be defined.</td>
</tr>
<tr>
<td>6</td>
<td>Available Power Sources</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_..._device_power_source</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong> must be defined.</td>
</tr>
<tr>
<td>7</td>
<td>Power Source Voltage</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_..._device_power_source</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong> must be defined.</td>
</tr>
<tr>
<td>8</td>
<td>Power Source Current</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_..._device_power_source</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong> must be defined.</td>
</tr>
<tr>
<td>9</td>
<td>Battery Level</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_BATTERY</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_device_update_battery"><code>iowa_client_device_update_battery</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_BATTERY</strong> must be defined.</td>
</tr>
<tr>
<td>10</td>
<td>Memory Free</td>
<td><em>memoryFree</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure when the flag <strong>IOWA_DEVICE_RSC_MEMORY_FREE</strong> in the <em>optFlags</em> field is set. <strong>IOWA_DEVICE_SUPPORT_RSC_MEMORY_FREE</strong> must be defined.</td>
</tr>
<tr>
<td>11</td>
<td>Error Code</td>
<td>Use <a href="#clientapi-iowa_client_set_device_error_code"><code>iowa_client_..._device_error_code</code></a> to control it.</td>
</tr>
<tr>
<td>12</td>
<td>Reset Error Code</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_RESET_ERROR</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. <strong>IOWA_DEVICE_SUPPORT_RSC_RESET_ERROR</strong> must be defined.</td>
</tr>
<tr>
<td>13</td>
<td>Current Time</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_CURRENT_TIME</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_update_device_time_information"><code>iowa_client_update_device_time_information</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_CURRENT_TIME</strong> must be defined.</td>
</tr>
<tr>
<td>14</td>
<td>UTC Offset</td>
<td><em>utcOffsetP</em> field and set the flag <strong>IOWA_DEVICE_RSC_UTC_OFFSET</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_update_device_time_information"><code>iowa_client_update_device_time_information</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_UTC_OFFSET</strong> must be defined.</td>
</tr>
<tr>
<td>15</td>
<td>Timezone</td>
<td><em>timezoneP</em> field and set the flag <strong>IOWA_DEVICE_RSC_TIMEZONE</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_update_device_time_information"><code>iowa_client_update_device_time_information</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_TIMEZONE</strong> must be defined.</td>
</tr>
<tr>
<td>16</td>
<td>Supported Binding and Modes</td>
<td>Cannot be updated directly but depends on the Server URI schema.</td>
</tr>
<tr>
<td>17</td>
<td>Device Type</td>
<td><em>deviceType</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_DEVICE_TYPE</strong> must be defined.</td>
</tr>
<tr>
<td>18</td>
<td>Hardware Version</td>
<td><em>hardwareVersion</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_HARDWARE_VERSION</strong> must be defined.</td>
</tr>
<tr>
<td>19</td>
<td>Software Version</td>
<td><em>softwareVersion</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_SOFTWARE_VERSION</strong> must be defined.</td>
</tr>
<tr>
<td>20</td>
<td>Battery Status</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_BATTERY</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a>. Then use <a href="#clientapi-iowa_client_device_update_battery"><code>iowa_client_device_update_battery</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_BATTERY</strong> must be defined.</td>
</tr>
<tr>
<td>21</td>
<td>Memory Total</td>
<td><em>memoryTotal</em> field of the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. <strong>IOWA_DEVICE_SUPPORT_RSC_MEMORY_TOTAL</strong> must be defined.</td>
</tr>
<tr>
<td>22</td>
<td>ExtDevInfo</td>
<td>Set the flag <strong>IOWA_DEVICE_RSC_EXTERNAL_INFO</strong> in <em>optFlags</em> field of the structure <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> to enable it. Then use <a href="#clientapi-iowa_client_update_device_external_information"><code>iowa_client_update_device_external_information</code></a> to control it. <strong>IOWA_DEVICE_SUPPORT_RSC_EXTERNAL_INFO</strong> must be defined.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="clientapi-iowa_client_add_server">iowa_client_add_server</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_add_server</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">lifetime</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">configFlags</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">iowa_security_mode_t</span><span class="w"> </span><span class="n">securityMode</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_add_server()</code> declares a new LwM2M Server for the LwM2M Client to connect to.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime. The context MUST be configured with <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> to add a server.</dd>
<dt><em>shortID</em></dt>
<dd>The ID assigned to this server. This cannot be zero nor <strong>IOWA_LWM2M_ID_ALL</strong> nor an existing one.</dd>
<dt><em>uri</em></dt>
<dd>The URI to reach this server as a nil-terminated string e.g. "coaps://[::1]:5684", "coap://lwm2m.example.org:5683" or "sms://+331020304050".</dd>
<dt><em>lifetime</em></dt>
<dd>The lifetime in seconds of the registration to this server.</dd>
<dt><em>configFlags</em></dt>
<dd>A bit-mask of configuration flags for this LwM2M Server.</dd>
<dt><em>securityMode</em></dt>
<dd>The security mode to use when connecting to this LwM2M Server. See <a href="#securityapi-iowa_security_mode_t">iowa_security_mode_t</a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_400_BAD_REQUEST</dt>
<dd><em>uri</em> is nil.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>shortID</em> is either zero, <strong>IOWA_LWM2M_ID_ALL</strong> or already in use.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>uri</em> is invalid. For example, if the transport is not supported or if <em>uri</em> does not match <em>securityMode</em>.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>If <em>lifetime</em> is set to zero, the registration lifetime is set to a default value of:</p>
<ul>
<li>30 days (2,592,000 seconds) for LoRaWAN transport</li>
<li>24 hours (86,400 seconds) for other transports (UDP, TCP, SMS ...)</li>
</ul>
<p><em>uri</em> is duplicated internally by IOWA and can be freed by the caller.</p>
<p><em>configFlags</em> is a combination of the following:</p>
<ul>
<li><strong>IOWA_LWM2M_QUEUE_MODE</strong>: Enable LwM2M Queue Mode for this LwM2M Server.</li>
</ul>
<h4 id="clientapi-server-object-resources">Server Object Resources</h4>
<p>The LwM2M Server information is exposed through the Resources of the <a href="#lwm2moverview-server-object"><code>Server Object</code></a> (ID: 1). The following table explained the mapping:</p>
<table>
<thead>
<tr>
<th>Resource ID</th>
<th>Resource Name</th>
<th>API</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Short Server ID</td>
<td>In <a href="#clientapi-iowa_client_add_server"><code>iowa_client_add_server</code>()</a>, fill <em>shortID</em>.</td>
</tr>
<tr>
<td>1</td>
<td>Lifetime</td>
<td>In <a href="#clientapi-iowa_client_add_server"><code>iowa_client_add_server</code>()</a>, fill <em>lifetime</em>.</td>
</tr>
<tr>
<td>2</td>
<td>Default Minimum Period</td>
<td>Use <a href="#clientapi-iowa_client_set_notification_default_periods"><code>iowa_client_set_notification_default_periods</code></a> to control it. <strong>IOWA_SERVER_SUPPORT_RSC_DEFAULT_PERIODS</strong> must be defined.</td>
</tr>
<tr>
<td>3</td>
<td>Default Maximum Period</td>
<td>Use <a href="#clientapi-iowa_client_set_notification_default_periods"><code>iowa_client_set_notification_default_periods</code></a> to control it. <strong>IOWA_SERVER_SUPPORT_RSC_DEFAULT_PERIODS</strong> must be defined.</td>
</tr>
<tr>
<td>4</td>
<td>Disable</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_DISABLE_TIMEOUT</strong> must be defined.</td>
</tr>
<tr>
<td>5</td>
<td>Disable Timeout</td>
<td>By default it is 86400 seconds. To change this default value, use <strong>IOWA_SERVER_RSC_DISABLE_TIMEOUT_DEFAULT_VALUE</strong>. <strong>IOWA_SERVER_SUPPORT_RSC_DISABLE_TIMEOUT</strong> must be defined.</td>
</tr>
<tr>
<td>6</td>
<td>Notification Storing When Disabled or Offline</td>
<td>By default it is false. To change this default value, use <strong>IOWA_SERVER_RSC_STORING_DEFAULT_VALUE</strong>.</td>
</tr>
<tr>
<td>7</td>
<td>Binding</td>
<td>Determined with the <em>uri</em> passed to <a href="#clientapi-iowa_client_add_server"><code>iowa_client_add_server</code>()</a>.</td>
</tr>
<tr>
<td>8</td>
<td>Registration Update Trigger</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>Bootstrap-Request Trigger</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_BOOTSTRAP_TRIGGER</strong> must be defined. Bootstrap feature is required.</td>
</tr>
<tr>
<td>10</td>
<td>APN Link</td>
<td>Not exposed by IOWA.</td>
</tr>
<tr>
<td>11</td>
<td>TLS-DTLS Alert Code</td>
<td>Not exposed by IOWA.</td>
</tr>
<tr>
<td>12</td>
<td>Last Bootstrapped</td>
<td>Not exposed by IOWA.</td>
</tr>
<tr>
<td>13</td>
<td>Registration Priority Order</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_REGISTRATION_BEHAVIOUR</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>14</td>
<td>Initial Registration Delay Timer</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_REGISTRATION_BEHAVIOUR</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>15</td>
<td>Registration Failure Block</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_REGISTRATION_BEHAVIOUR</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>16</td>
<td>Bootstrap on Registration Failure</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_REGISTRATION_BEHAVIOUR</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>17</td>
<td>Communication Retry Count</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_COMMUNICATION_ATTEMPTS</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>18</td>
<td>Communication Retry Timer</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_COMMUNICATION_ATTEMPTS</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>19</td>
<td>Communication Sequence Delay Timer</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_COMMUNICATION_ATTEMPTS</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>20</td>
<td>Communication Sequence Retry Count</td>
<td><strong>IOWA_SERVER_SUPPORT_RSC_COMMUNICATION_ATTEMPTS</strong> must be defined. LwM2M version must be 1.1 or later.</td>
</tr>
<tr>
<td>21</td>
<td>Trigger</td>
<td>Not exposed by IOWA.</td>
</tr>
<tr>
<td>22</td>
<td>Preferred Transport</td>
<td>Not exposed by IOWA.</td>
</tr>
<tr>
<td>23</td>
<td>Mute Send</td>
<td>By default it is false. To change this default value, use <strong>IOWA_SERVER_RSC_MUTE_SEND_DEFAULT_VALUE</strong>. <strong>IOWA_SERVER_SUPPORT_RSC_MUTE_SEND</strong> must be defined. Data Push operation feature is required.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="clientapi-iowa_client_remove_server">iowa_client_remove_server</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_remove_server</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortID</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_remove_server()</code> removes a LwM2M Server added by <a href="#clientapi-iowa_client_add_server"><code>iowa_client_add_server()</code></a> from the LwM2M Client.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt>shortID</dt>
<dd>The ID assigned to this server or <em>IOWA_LWM2M_ID_ALL</em>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>shortID</em> is zero.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>shortID</em> does not match any known server.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_get_server_count">iowa_client_get_server_count</h3>
<p><strong>Prototype</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_get_server_count</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">serversCountP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<strong>Description</strong></p>
<p><code>iowa_client_get_server_count()</code> get the count of all configured LwM2M Servers.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>serversCountP</em></dt>
<dd>A pointer to the count of all configured LwM2M Servers.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_get_server_array">iowa_client_get_server_array</h3>
<p><strong>Prototype</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_get_server_array</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">serversCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                           </span><span class="n">iowa_server_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">serverArrayP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<strong>Description</strong></p>
<p><code>iowa_client_get_server_array()</code> retrieves the configured LwM2M Servers with theirs associated information.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>serversCount</em></dt>
<dd>A pointer to the count of LwM2M Servers.</dd>
<dt><em>serverArrayP</em></dt>
<dd>An Array of <code>iowa_server_info_t</code> with a size equal to the count of the current configured LwM2M Servers.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>No LwM2M Servers are configured in the Client.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>serverArrayP</em> is nil.</dd>
<dt>IOWA_COAP_408_REQUEST_ENTITY_INCOMPLETE</dt>
<dd>The count of configured LwM2M servers has been changed since the call of <code>iowa_client_get_server_count()</code>. However, <em>serverArrayP</em> was filled with valid information.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>To get the count of the current configured LwM2M Servers you need to call <code>iowa_client_get_server_count()</code>.</p>
<hr />
<h3 id="clientapi-iowa_client_get_server_coap_peer">iowa_client_get_server_coap_peer</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_coap_peer_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_client_get_server_coap_peer</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortId</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_get_server_coap_peer()</code> returns the CoAP peer associated to a LwM2M Server.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>shortID</em></dt>
<dd>The ID assigned to the server.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to the <a href="#coapapi-iowa_coap_peer_t">iowa_coap_peer_t</a> associated to the LwM2M Server.</p>
<p>This pointer may be nil if <code>shortId</code> is invalid or if IOWA did not yet initiate the registration to the LwM2M Server.</p>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_set_notification_default_periods">iowa_client_set_notification_default_periods</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_set_notification_default_periods</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">minPeriod</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                           </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">maxPeriod</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_set_notification_default_periods()</code> configures the default periods for notifications sent to a LwM2M Server.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>shortID</em></dt>
<dd>The ID assigned to the server or <em>IOWA_LWM2M_ID_ALL</em>.</dd>
<dt><em>minPeriod</em></dt>
<dd>The default minimum time in seconds between two notifications sent to the LwM2M Server for the same observation.</dd>
<dt><em>maxPeriod</em></dt>
<dd>The default maximum time in seconds between two notifications sent to the LwM2M Server for the same observation.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>shortID</em> is zero.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>shortID</em> does not match any known server.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>When <em>IOWA_LWM2M_ID_ALL</em> is used as <em>shortID</em>, only already known LwM2M Servers will have the default periods configured. If a LwM2M Server is added after the call to this API, by default it will not have default periods.</p>
<p>Setting the default periods does not affect already running observations.</p>
<p>A minimum period set to zero is equivalent to having no minimum period defined. Same for maximum period.</p>
<p>If <em>maxPeriod</em> is inferior to <em>minPeriod</em>, it is cleared (i.e. set to zero).</p>
<hr />
<h3 id="clientapi-iowa_client_use_reliable_notifications">iowa_client_use_reliable_notifications</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_use_reliable_notifications</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortId</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_use_reliable_notifications()</code> configures the LwM2M Client to ensure that notifications are received by the LwM2M Server.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>shortId</em></dt>
<dd>The ID assigned to the server or <em>IOWA_LWM2M_ID_ALL</em>.</dd>
<dt><em>enable</em></dt>
<dd>If true, notifications will be reliable.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>shortID</em> is zero.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>shortID</em> does not match any known server.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>When <em>IOWA_LWM2M_ID_ALL</em> is used as <em>shortID</em>, only already known LwM2M Servers will have reliable notifications. If a LwM2M Server is added after the call to this API, by default it will not use reliable notifications.</p>
<p>If <em>enable</em> is true:</p>
<ul>
<li>on unreliable transports like UDP, the notifications are sent as Confirmable messages.</li>
<li>events <strong>IOWA_EVENT_OBSERVATION_NOTIFICATION_ACKED</strong> and <strong>IOWA_EVENT_OBSERVATION_NOTIFICATION_FAILED</strong> are emitted.</li>
<li>when storage queues are enabled, if a notification does not reach the LwM2M Server, IOWA stores it until the LwM2M Server is reachable again. See <a href="#configuration-lwm2m_storage_queue_support"><strong>LWM2M_STORAGE_QUEUE_SUPPORT</strong></a> and <a href="#configuration-lwm2m_storage_queue_peek_support"><strong>LWM2M_STORAGE_QUEUE_PEEK_SUPPORT</strong></a>.</li>
</ul>
<hr />
<h3 id="clientapi-iowa_client_object_set_mode">iowa_client_object_set_mode</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_object_set_mode</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">mode</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_object_set_mode()</code> sets the sensor mode.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>The ID of the sensor.</dd>
<dt><em>mode</em></dt>
<dd>Flags used to enable modes.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>id</em> does not match any known sensor.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>To use this API, the compilation flag <a href="#configuration-lwm2m_client_asynchronous_operation_support"><strong>LWM2M_CLIENT_ASYNCHRONOUS_OPERATION_SUPPORT</strong></a> must be set.</p>
<p>To set the sensor mode, you can use the following flag:</p>
<ul>
<li>IOWA_OBJECT_MODE_DEFAULT</li>
<li>IOWA_OBJECT_MODE_ASYNCHRONOUS</li>
</ul>
<p>By default, sensors are synchronous.</p>
<p>A call to <code>iowa_client_object_set_mode()</code> affects all the sensors of the same type.</p>
<hr />
<h3 id="clientapi-iowa_client_object_set_configuration">iowa_client_object_set_configuration</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_object_set_configuration</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectId</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="n">iowa_object_setting_id_t</span><span class="w"> </span><span class="n">settingId</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">argP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_object_set_configuration()</code> sets the object configuration.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>objectId</em></dt>
<dd>The ID of the object.</dd>
<dt><em>settingId</em></dt>
<dd>The setting to set. See <a href="#clientapi-iowa_object_setting_id_t"><code>iowa_object_setting_id_t</code></a>.</dd>
<dt><em>argP</em></dt>
<dd>A pointer to the setting value. Dependent on <em>settingId</em>.</dd>
</dl>
<table>
<thead>
<tr>
<th><em>settingId</em></th>
<th><em>argP</em> type</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IOWA_OBJECT_SETTING_VERSION</strong></td>
<td><a href="#commonapi-iowa_object_version_t">iowa_object_version_t</a> *</td>
</tr>
</tbody>
</table>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_402_BAD_OPTION</dt>
<dd><em>settingId</em> is unknown.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>objectId</em> does not match any known object.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>argP</em> is nil.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_device_update_battery">iowa_client_device_update_battery</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_device_update_battery</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="n">iowa_device_battery_status_t</span><span class="w"> </span><span class="n">batteryStatus</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_device_update_battery()</code> updates the battery level and status exposed in the <a href="#lwm2moverview-device-object"><code>Device Object</code></a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>batteryLevel</em></dt>
<dd>The battery level in percent.</dd>
<dt><em>batteryStatus</em></dt>
<dd>The battery status.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_405_METHOD_NOT_ALLOWED</dt>
<dd>client has been configured without the flag <strong>IOWA_DEVICE_RSC_BATTERY</strong> in the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. To reconfigure the client, close than reopen a fresh IOWA Client context with <a href="#commonapi-iowa_close"><code>iowa_close()</code></a>, <a href="#commonapi-iowa_init"><code>iowa_init()</code></a> and <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>batteryLevel</em> is outside the range [0, 100].</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>For the device to expose its battery level and status, <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> must have been to called with the <strong>IOWA_DEVICE_RSC_BATTERY</strong> flag.</p>
<p>Before the first call to <code>iowa_client_device_update_battery()</code>, default value of batteryStatus is <strong>IOWA_DEVICE_BATTERY_STATUS_UNKNOWN</strong>.</p>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined, <code>iowa_client_device_update_battery()</code> can only be called when IOWA is built with the flag <strong>IOWA_DEVICE_SUPPORT_RSC_BATTERY</strong>.</p>
<p><strong>iowa_device_battery_status_t</strong></p>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_DEVICE_BATTERY_STATUS_NORMAL</dt>
<dd>The battery is operating normally and not on power.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_CHARGING</dt>
<dd>The battery is currently charging.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_CHARGE_COMPLETE</dt>
<dd>The battery is fully charged and still on power.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_DAMAGED</dt>
<dd>The battery has some problem.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_LOW_BATTERY</dt>
<dd>The battery is low on charge.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_NOT_INSTALLED</dt>
<dd>The battery is not installed.</dd>
<dt>IOWA_DEVICE_BATTERY_STATUS_UNKNOWN</dt>
<dd>The battery information is not available.</dd>
</dl>
<hr />
<h3 id="clientapi-iowa_client_add_device_power_source">iowa_client_add_device_power_source</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_add_device_power_source</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">iowa_power_source_type_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">int</span><span class="w"> </span><span class="n">voltageValue</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">int</span><span class="w"> </span><span class="n">currentValue</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="o">*</span><span class="n">idP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_add_device_power_source()</code> adds a power source to Device object with initial value of voltage and current.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>type</em></dt>
<dd>power source type.</dd>
<dt><em>voltageValue</em></dt>
<dd>initial voltage value (mV).</dd>
<dt><em>currentValue</em></dt>
<dd>initial current value (mA).</dd>
<dt><em>idP</em></dt>
<dd>Used to store the ID of the created power source. Not checked at runtime.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_405_METHOD_NOT_ALLOWED</dt>
<dd>client has been configured without the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. To reconfigure the client, close than reopen a fresh IOWA Client context with <a href="#commonapi-iowa_close"><code>iowa_close()</code></a>, <a href="#commonapi-iowa_init"><code>iowa_init()</code></a> and <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>For the device to expose its power source information, <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> must have been to called with the <code>IOWA_DEVICE_RSC_POWER_SOURCE</code> flag.</p>
<p>To update a power source values, you need to call <a href="#clientapi-iowa_client_update_device_power_source"><code>iowa_client_update_device_power_source()</code></a>.</p>
<p>To remove a power source, you need to call <a href="#clientapi-iowa_client_remove_device_power_source"><code>iowa_client_remove_device_power_source()</code></a>.</p>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined, <code>iowa_client_add_device_power_source()</code> can only be called when IOWA is built with the flag <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong>.</p>
<p><strong>iowa_power_source_type_t</strong></p>
<p>This is an enumeration of the following values:</p>
<dl>
<dt>IOWA_POWER_SOURCE_DC_POWER</dt>
<dd>DC power supply.</dd>
<dt>IOWA_POWER_SOURCE_INTERNAL_BATTERY</dt>
<dd>Internal battery.</dd>
<dt>IOWA_POWER_SOURCE_EXTERNAL_BATTERY</dt>
<dd>External battery.</dd>
<dt>IOWA_POWER_SOURCE_FUEL_CELL</dt>
<dd>Fuel Cell</dd>
<dt>IOWA_POWER_SOURCE_POWER_OVER_ETHERNET</dt>
<dd>Power Over Ethernet.</dd>
<dt>IOWA_POWER_SOURCE_USB</dt>
<dd>USB.</dd>
<dt>IOWA_POWER_SOURCE_AC_MAIN_POWER</dt>
<dd>AC power supply.</dd>
<dt>IOWA_POWER_SOURCE_SOLAR</dt>
<dd>Solar energy.</dd>
</dl>
<hr />
<h3 id="clientapi-iowa_client_remove_device_power_source">iowa_client_remove_device_power_source</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_remove_device_power_source</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_remove_device_power_source()</code> removes a power source from the Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>ID of the power source to remove.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>id</em> is not a device's power source. Valid <em>id</em> are only returned by <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_add_device_power_source()</code></a>.</dd>
<dt>IOWA_COAP_405_METHOD_NOT_ALLOWED</dt>
<dd>client has been configured without the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. To reconfigure the client, close than reopen a fresh IOWA Client context with <a href="#commonapi-iowa_close"><code>iowa_close()</code></a>, <a href="#commonapi-iowa_init"><code>iowa_init()</code></a> and <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>For the device to expose its power source information, <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> must have been to called with the <code>IOWA_DEVICE_RSC_POWER_SOURCE</code> flag.</p>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined, <code>iowa_client_remove_device_power_source()</code> can only be called when IOWA is built with the flag <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong>.</p>
<hr />
<h3 id="clientapi-iowa_client_update_device_power_source">iowa_client_update_device_power_source</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_update_device_power_source</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="kt">int</span><span class="w"> </span><span class="n">voltageValue</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                     </span><span class="kt">int</span><span class="w"> </span><span class="n">currentValue</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_update_device_power_source()</code> updates a power source values to Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>ID of the power source.</dd>
<dt><em>voltageValue</em></dt>
<dd>new voltage value (mV).</dd>
<dt><em>currentValue</em></dt>
<dd>new current value (mA).</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>id is not a device's power source. Valid <em>id</em> are only returned by <a href="#clientapi-iowa_client_add_device_power_source"><code>iowa_client_add_device_power_source()</code></a>.</dd>
<dt>IOWA_COAP_405_METHOD_NOT_ALLOWED</dt>
<dd>client has been configured without the flag <strong>IOWA_DEVICE_RSC_POWER_SOURCE</strong> in the <a href="#clientapi-iowa_device_info_t"><code>iowa_device_info_t</code></a> structure. To reconfigure the client, close than reopen a fresh IOWA Client context with <a href="#commonapi-iowa_close"><code>iowa_close()</code></a>, <a href="#commonapi-iowa_init"><code>iowa_init()</code></a> and <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>For the device to expose its power source information, <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> must have been to called with the <code>IOWA_DEVICE_RSC_POWER_SOURCE</code> flag.</p>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined, <code>iowa_client_update_device_power_source()</code> can only be called when IOWA is built with the flag <strong>IOWA_DEVICE_SUPPORT_RSC_POWER_SOURCE</strong>.</p>
<hr />
<h3 id="clientapi-iowa_client_update_device_information">iowa_client_update_device_information</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_update_device_information</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">iowa_device_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">deviceInfoP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_update_device_information()</code> updates the device information.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>deviceInfoP</em></dt>
<dd>pointer to the new device's information.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_400_BAD_REQUEST</dt>
<dd><em>deviceInfoP</em> is nil.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>This function update only the supported device resources that has been set previously in <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</p>
<p>The parameters that can be updated are :</p>
<ul>
<li>Manufacturer.</li>
<li>Model number.</li>
<li>Serial number.</li>
<li>Firmware version.</li>
<li>Device type.</li>
<li>Hardware version.</li>
<li>Software version.</li>
<li>Free memory when the flag <strong>IOWA_DEVICE_RSC_MEMORY_FREE</strong> in <em>optFlags</em> field is set.</li>
<li>Total memory.</li>
</ul>
<p>Nil values in <em>deviceInfoP</em> will be ignored and won't make any changes except for the free memory.</p>
<hr />
<h3 id="clientapi-iowa_client_set_device_error_code">iowa_client_set_device_error_code</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_set_device_error_code</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">errorCode</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_set_device_error_code()</code> sets an error code on Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>errorCode</em></dt>
<dd>The error code value to set between 1 and 32.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_402_BAD_OPTION</dt>
<dd><em>errorCode</em> is not a valid parameter.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>errorCode</em> is IOWA_ERROR_CODE_NO_ERROR but there is no error to clear.</dd>
<dt>IOWA_COAP_409_CONFLICT</dt>
<dd><em>errorCode</em> has already been set.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>To clear one error code, you need to call <a href="#clientapi-iowa_client_clear_device_error_code"><code>iowa_client_clear_device_error_code()</code></a>.</p>
<p>To clear all error codes, you can call <a href="#clientapi-iowa_client_set_device_error_code"><code>iowa_client_set_device_error_code()</code></a> with <em>errorCode</em> argument set to IOWA_ERROR_CODE_NO_ERROR.</p>
<p>The error code is an integer between 1 and 32. The LwM2M protocol defines eight values between 1 and 8 detailed below. Values between 9 and 15 are reserved for future use. The device maker or the application can use the values between 16 and 32 as proprietary error codes.</p>
<p>LwM2M defined error code values are:</p>
<ul>
<li>
<dl>
<dt>IOWA_ERROR_CODE_NO_ERROR</dt>
<dd>No error.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_LOW_BATTERY_POWER (1)</dt>
<dd>Low battery power.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_EXTERNAL_POWER_SUPPLY_OFF (2)</dt>
<dd>External power supply off.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_GPS_MODULE_FAILURE (3)</dt>
<dd>GPS module failure.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_LOW_RECEIVED_SIGNAL_STRENGTH (4)</dt>
<dd>Low received signal strength.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_OUT_OF_MEMORY (5)</dt>
<dd>Out of memory.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_SMS_FAILURE (6)</dt>
<dd>SMS failure.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_IP_CONNECTIVITY_FAILURE (7)</dt>
<dd>IP connectivity failure.</dd>
</dl>
</li>
<li>
<dl>
<dt>IOWA_ERROR_CODE_PERIPHERAL_MALFUNCTION (8)</dt>
<dd>Peripheral malfunction.</dd>
</dl>
</li>
</ul>
<hr />
<h3 id="clientapi-iowa_client_clear_device_error_code">iowa_client_clear_device_error_code</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_clear_device_error_code</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">errorCode</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_clear_device_error_code()</code> clears an error code from the Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>errorCode</em></dt>
<dd>The error code to clear between 1 and 32. It can't be <em>IOWA_ERROR_CODE_NO_ERROR</em>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_402_BAD_OPTION</dt>
<dd>The error code <em>IOWA_ERROR_CODE_NO_ERROR</em> can't be cleared.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>The error code is not set.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>LwM2M defined error code values are enumerated in <a href="#clientapi-iowa_client_set_device_error_code"><code>iowa_client_set_device_error_code()</code></a>.</p>
<hr />
<h3 id="clientapi-iowa_client_update_device_time_information">iowa_client_update_device_time_information</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_update_device_time_information</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="n">iowa_device_time_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">timeInfoP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_update_device_time_information()</code> updates time information to Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>timeInfoP</em></dt>
<dd>Current device time information: <a href="#clientapi-iowa_device_time_info_t"><code>iowa_device_time_info_t</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>timeInfoP</em> is nil.</li>
</ul>
</dd>
<dd>
<ul>
<li>currentTime in <em>timeInfoP</em> is set with a negative value.</li>
</ul>
</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>For the device to expose its time information, <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a> must have been to called with time information used.</p>
<p><code>iowa_client_update_device_time_information()</code> can only be called when IOWA is built with at least one of the following flag:
* <strong>IOWA_DEVICE_SUPPORT_RSC_CURRENT_TIME</strong>
* <strong>IOWA_DEVICE_SUPPORT_RSC_UTC_OFFSET</strong>
* <strong>IOWA_DEVICE_SUPPORT_RSC_TIMEZONE</strong></p>
<hr />
<h3 id="clientapi-iowa_client_update_device_external_information">iowa_client_update_device_external_information</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_update_device_external_information</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extLinkCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                             </span><span class="n">iowa_lwm2m_object_link_t</span><span class="w"> </span><span class="o">*</span><span class="n">extLinkArray</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_update_device_external_information()</code> updates the external device information exposed in the Device object.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>extLinkCount</em></dt>
<dd>The number of links in <em>extLinkArray</em>.</dd>
<dt><em>extLinkArray</em></dt>
<dd>An array of object links referencing object instance containing "external device" information.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>extLinkArray</em> is nil while <em>extLinkCount</em> is not 0.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not configured. Call first <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>The Resource "ExtDevInfo" must have been enabled by setting the optional flag <strong>IOWA_DEVICE_RSC_EXTERNAL_INFO</strong> when calling <a href="#clientapi-iowa_client_configure"><code>iowa_client_configure()</code></a>.</p>
<p>The field <code>version</code> in the <a href="#commonapi-iowa_lwm2m_object_link_t"><code>iowa_lwm2m_object_link_t</code></a> structure is ignored.</p>
<p>When <a href="#configuration-iowa_remove_all_optional_resources"><strong>IOWA_REMOVE_ALL_OPTIONAL_RESOURCES</strong></a> is defined, <code>iowa_client_update_device_external_information()</code> can only be called when IOWA is built with the flag <strong>IOWA_DEVICE_SUPPORT_RSC_EXTERNAL_INFO</strong>.</p>
<hr />
<h3 id="clientapi-iowa_client_add_custom_object">iowa_client_add_custom_object</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_add_custom_object</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">instanceCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">uint16_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">instanceIDs</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">resourceCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_lwm2m_resource_desc_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">resourceArray</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_RWE_callback_t</span><span class="w"> </span><span class="n">dataCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_CD_callback_t</span><span class="w"> </span><span class="n">instanceCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_RI_callback_t</span><span class="w"> </span><span class="n">resInstanceCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">userData</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_add_custom_object()</code> adds a new custom Object for the LwM2M Client to handle. The object is defined by its ID and a the list of the resources it contains.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>objectID</em></dt>
<dd>The ID of the Object.</dd>
<dt><em>instanceCount</em></dt>
<dd>The number of elements in <em>instanceIDs</em>. This can be 0.</dd>
<dt><em>instanceIDs</em></dt>
<dd>The IDs of the instances of the Object. This can be nil.</dd>
<dt><em>resourceCount</em></dt>
<dd>The number of elements in <em>resourceArray</em>.</dd>
<dt><em>resourceArray</em></dt>
<dd>An array of <a href="#clientapi-iowa_lwm2m_resource_desc_t"><code>iowa_lwm2m_resource_desc_t</code></a> composing the Object.</dd>
<dt><em>dataCallback</em></dt>
<dd>The callback to perform Read, Write and Execute operations on the resources.</dd>
<dt><em>instanceCallback</em></dt>
<dd>The callback to perform Create and Delete operations on Object instances. This can be nil.</dd>
<dt><em>resInstanceCallback</em></dt>
<dd>The callback to retrieve the list of instances of resources declared as multiple. This can be nil.</dd>
<dt><em>userData</em></dt>
<dd>Passed as argument to the callbacks.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd>objectID is 0, 1 or 3 which are reserved Object IDs.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>objectID</em> is <strong>IOWA_LWM2M_ID_ALL</strong> (65535).</li>
</ul>
</dd>
<dd>
<ul>
<li><em>resourceCount</em> is zero.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>resourceArray</em> is nil.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>dataCallback</em> is nil.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>instanceIDs</em> is nil and <em>instanceCount</em> is not zero.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>resInstanceCallback</em> is nil and one of the resources in <em>resourceArray</em> has the <strong>IOWA_RESOURCE_FLAG_MULTIPLE</strong> flag set.</li>
</ul>
</dd>
<dd>
<ul>
<li>an instance ID is <strong>IOWA_LWM2M_ID_ALL</strong>.</li>
</ul>
</dd>
<dd>
<ul>
<li>a resource ID is <strong>IOWA_LWM2M_ID_ALL</strong>.</li>
</ul>
</dd>
<dd>
<ul>
<li>a resource has no operation defined.</li>
</ul>
</dd>
<dd>
<ul>
<li>a resource is both set as streamable and asynchronous.</li>
</ul>
</dd>
<dd>
<ul>
<li>a resource is set as executable with another operation.</li>
</ul>
</dd>
<dd>
<ul>
<li>two resources have the same ID.</li>
</ul>
</dd>
<dt>IOWA_COAP_409_CONFLICT</dt>
<dd>this object already exists. Call first <a href="#clientapi-iowa_client_remove_custom_object"><code>iowa_client_remove_custom_object()</code></a>.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>Object IDs 0, 1 and 3 are reserved and cannot be used.</p>
<p>Per Lightweight M2M specification, the ID of the instance of a single-instance Object is 0. When creating a single-instance Object, you can set <em>instanceCount</em> to zero and <em>instanceCallback</em> to nil. IOWA will automatically create an instance with ID 0.</p>
<p>When the LwM2M Server creates a new instance of the custom object, <em>instanceCallback</em> is first called with the new instance ID then <em>dataCallback</em> is called with <em>operation</em> set to <strong>IOWA_DM_WRITE</strong> to initialize the instance. Thus if <em>instanceCallback</em> is defined, <em>dataCallback</em> must handle the Write operation even on resources declared as read-only.</p>
<hr />
<h3 id="clientapi-iowa_client_remove_custom_object">iowa_client_remove_custom_object</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_remove_custom_object</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_remove_custom_object()</code> removes a custom Object created with <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>objectID</em></dt>
<dd>The ID of the Object.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>objectID</em> is 0, 1 or 3 which are reserved Object IDs.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>objectID</em> does not match any known object.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>objectID</em> is <strong>IOWA_LWM2M_ID_ALL</strong> (65535).</dd>
</dl>
<p><strong>Notes</strong></p>
<p>This API does not check if the LwM2M Object was added by calling <a href="#clientapi-iowa_client_add_custom_object"><code>iowa_client_add_custom_object()</code></a> or by calling another high-level API like <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</p>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_object_resource_changed">iowa_client_object_resource_changed</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_object_resource_changed</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">resourceID</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_object_resource_changed()</code> informs the IOWA stack that the value of a LwM2M Object resource changed.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>objectID</em></dt>
<dd>The ID of the Object containing the resource.</dd>
<dt><em>instanceID</em></dt>
<dd>The ID of the Instance containing the resource. This can be <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
<dt><em>resourceID</em></dt>
<dd>The ID of the resource. This can be <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>objectID</em> is 0, 1 or 3 which are reserved Object IDs.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd><em>objectID</em> is <strong>IOWA_LWM2M_ID_ALL</strong> (65535).</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>This API does not check if the LwM2M Object resource exists. That's why this API does not return IOWA_COAP_404_NOT_FOUND.
Actually, <code>iowa_client_object_resource_changed()</code> is only searching a match between the running observation and the URI provided. If a match is found a notification is sent, else nothing happens.</p>
<hr />
<h3 id="clientapi-iowa_client_object_instance_changed">iowa_client_object_instance_changed</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_object_instance_changed</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">objectID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">instanceID</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                  </span><span class="n">iowa_dm_operation_t</span><span class="w"> </span><span class="n">operation</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_object_instance_changed()</code> informs the IOWA stack that an instance of a LwM2M Object was created or deleted.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>objectID</em></dt>
<dd>The ID of the Object containing the instance.</dd>
<dt><em>instanceID</em></dt>
<dd>The ID of the created or deleted Instance.</dd>
<dt><em>operation</em></dt>
<dd><strong>IOWA_DM_CREATE</strong> if it is a new instance. <strong>IOWA_DM_DELETE</strong> if the instance was removed.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>objectID</em> is 0, 1 or 3 which are reserved Object IDs.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>objectID</em> does not match any known object.</li>
</ul>
</dd>
<dd>
<ul>
<li><em>operation</em> is <strong>IOWA_DM_DELETE</strong> and <em>instanceID</em> does not match any known instance.</li>
</ul>
</dd>
<dt>IOWA_COAP_405_METHOD_NOT_ALLOWED</dt>
<dd><em>operation</em> is neither <strong>IOWA_DM_CREATE</strong> nor <strong>IOWA_DM_DELETE</strong>.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li><em>objectID</em> is <strong>IOWA_LWM2M_ID_ALL</strong> (65535).</li>
</ul>
</dd>
<dd>
<ul>
<li><em>operation</em> is <strong>IOWA_DM_CREATE</strong> and <strong>instanceID</strong> was already present.</li>
</ul>
</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<hr />
<h3 id="clientapi-iowa_client_notification_lock">iowa_client_notification_lock</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_client_notification_lock</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">bool</span><span class="w"> </span><span class="n">enter</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_notification_lock()</code> prevents or allows the IOWA stack to send notifications and registration updates.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>enter</em></dt>
<dd><strong>true</strong> to stop the notification, <strong>false</strong> to resume the notification.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>The main use is to perform several calls to <a href="#clientapi-iowa_client_object_resource_changed"><code>iowa_client_object_resource_changed()</code></a> on an Object without generating a notification each time if the Object is under observation.</p>
<p>Registration updates are also blocked, allowing to add or remove several Objects or Object Instances.</p>
<p>This function is useful only if IOWA is built with the <strong>IOWA_MULTITHREAD_SUPPORT</strong> flag.
Inside a custom object callback, notifications are already disabled.</p>
<hr />
<h3 id="clientapi-iowa_client_send_heartbeat">iowa_client_send_heartbeat</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_send_heartbeat</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                         </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortID</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_send_heartbeat()</code> sends an heartbeat message to a server.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>shortID</em></dt>
<dd>The Short ID assigned to this Server. Can be equal to <strong>IOWA_LWM2M_ID_ALL</strong>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_403_FORBIDDEN</dt>
<dd><em>shortID</em> is zero.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>shortID</em> does not match any known server.</dd>
<dt>IOWA_COAP_412_PRECONDITION_FAILED</dt>
<dd>client is not connected to the server with <em>shortID</em>. This can happen when:</dd>
<dd>
<ul>
<li>The Server is a Bootstrap Server and the Client is already connect to a Server.</li>
</ul>
</dd>
<dd>
<ul>
<li>The Client is configured with more than one Server and has established the connection with only one.</li>
</ul>
</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation failed.</dd>
<dt>IOWA_COAP_503_SERVICE_UNAVAILABLE</dt>
<dd>heartbeat message has not been sent by the platform.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>iowa_client.h</p>
<p><strong>Notes</strong></p>
<p>If <em>shortID</em> is equal to <strong>IOWA_LWM2M_ID_ALL</strong>, the heartbeat message will be sent to all servers.</p>
<p>For non LoRaWAN Servers, a registration update message is sent to the Server. The <a href="#clientapi-iowa_event_callback_t">iowa_event_callback_t</a> will be called with a <strong>IOWA_EVENT_REG_UPDATING</strong> event. Then, if a reply is received from the Server, the <a href="#clientapi-iowa_event_callback_t">iowa_event_callback_t</a> will be called with either a <strong>IOWA_EVENT_REG_REGISTERED</strong> or <strong>IOWA_EVENT_REG_FAILED</strong> event. Nothing is done when no reply is received from the Server.</p>
<p>In the <strong>IOWA_EVENT_REG_REGISTERED</strong> case, the registration lifetime timer for the LwM2M Server is resetted.</p>
<hr />
<h2 id="clientapi-ipso-objects">IPSO Objects</h2>
<p>This part allows the possibility to manipulate several IPSO Objects.</p>
<p>To be able to use these objects, <code>iowa_ipso.h</code> must be included.</p>
<h3 id="clientapi-iowa_client_ipso_add_sensor">iowa_client_IPSO_add_sensor</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_IPSO_add_sensor</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">iowa_IPSO_ID_t</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">float</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unit</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">appType</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">float</span><span class="w"> </span><span class="n">rangeMin</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">rangeMax</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">idP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_IPSO_add_sensor()</code> adds a new IPSO sensor for the LwM2M Client to handle. The sensor is defined by its type.</p>
<p>The unit, the application type and the range are only informative and reported as-is to the LwM2M Server. Note that the LwM2M Server can modify the application type.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>type</em></dt>
<dd>The type of sensor. See below.</dd>
<dt><em>value</em></dt>
<dd>The initial value measured by the sensor.</dd>
<dt><em>unit</em></dt>
<dd>The unit of the measured value as a nil-terminated string. This can be nil.</dd>
<dt><em>appType</em></dt>
<dd>The application type of the sensor as a free-form nil-terminated string. This can be nil.</dd>
<dt><em>rangeMin</em></dt>
<dd>The minimum value that can be measured by the sensor.</dd>
<dt><em>rangeMax</em></dt>
<dd>The maximum value that can be measured by the sensor.</dd>
<dt><em>idP</em></dt>
<dd>Used to store the ID of the created sensor. Not checked at runtime.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_402_BAD_OPTION</dt>
<dd><em>type</em> is unknown.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li>the sensor uses a Boolean value and <em>value</em> is neither 0.0 nor 1.0.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a percentage value and <em>value</em> is outside the [0.0, 100.0] range.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a compass direction value and <em>value</em> is outside the [0.0, 360.0] range.</li>
</ul>
</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation or a call to <a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>objects/iowa_ipso.h</p>
<p><strong>Notes</strong></p>
<p>If both <em>rangeMin</em> and <em>rangeMax</em> are set to zero, the matching resources are ignored in the LwM2M Object.</p>
<p><em>unit</em> is not duplicated nor freed by IOWA. Make sure it is available until <a href="#commonapi-iowa_close"><code>iowa_close()</code></a> or <a href="#clientapi-iowa_client_IPSO_remove_sensor"><code>iowa_client_IPSO_remove_sensor()</code></a> is called. It is advised to use static strings.</p>
<p><em>appType</em> is duplicated internally by IOWA and can be reused or freed by the caller.</p>
<p>Only a call to <a href="#clientapi-iowa_client_IPSO_remove_sensor"><code>iowa_client_IPSO_remove_sensor()</code></a> can free the memory allocated by <code>iowa_client_IPSO_add_sensor()</code>.</p>
<h4 id="clientapi-iowa_ipso_id_t">iowa_IPSO_ID_t</h4>
<p>This is an enumeration of the LwM2M IDs of the supported sensor types. See below.</p>
<p><strong>Float value sensors</strong></p>
<ul>
<li>IOWA_IPSO_ANALOG_INPUT (3202)</li>
<li>IOWA_IPSO_GENERIC (3300)</li>
<li>IOWA_IPSO_ILLUMINANCE (3301)</li>
<li>IOWA_IPSO_TEMPERATURE (3303)</li>
<li>IOWA_IPSO_HUMIDITY (3304)</li>
<li>IOWA_IPSO_BAROMETER (3315)</li>
<li>IOWA_IPSO_VOLTAGE (3316)</li>
<li>IOWA_IPSO_CURRENT (3317)</li>
<li>IOWA_IPSO_FREQUENCY (3318)</li>
<li>IOWA_IPSO_DEPTH (3319)</li>
<li>IOWA_IPSO_PERCENTAGE (3320)</li>
<li>IOWA_IPSO_ALTITUDE (3321)</li>
<li>IOWA_IPSO_LOAD (3322)</li>
<li>IOWA_IPSO_PRESSURE (3323)</li>
<li>IOWA_IPSO_LOUDNESS (3324)</li>
<li>IOWA_IPSO_CONCENTRATION (3325)</li>
<li>IOWA_IPSO_ACIDITY (3326)</li>
<li>IOWA_IPSO_CONDUCTIVITY (3327)</li>
<li>IOWA_IPSO_POWER (3328)</li>
<li>IOWA_IPSO_POWER_FACTOR (3329)</li>
<li>IOWA_IPSO_RATE (3346)</li>
<li>IOWA_IPSO_DISTANCE (3330)</li>
<li>IOWA_IPSO_ENERGY (3331)</li>
</ul>
<p><strong>Boolean value sensors</strong></p>
<p>For these sensors, the value must be either 0.0 or 1.0:</p>
<ul>
<li>IOWA_IPSO_DIGITAL_INPUT (3200)</li>
<li>IOWA_IPSO_PRESENCE (3302)</li>
<li>IOWA_IPSO_ON_OFF_SWITCH (3342)</li>
<li>IOWA_IPSO_PUSH_BUTTON (3347)</li>
</ul>
<p><strong>Compass direction value sensors</strong></p>
<p>For these sensors, the value must be between 0.0 and 360.0:</p>
<ul>
<li>IOWA_IPSO_DIRECTION (3332)</li>
</ul>
<p><strong>Notes</strong></p>
<p>The enumeration value <strong>IOWA_IPSO_LEVEL_CONTROL</strong> no longer exists.</p>
<p>The Dimmer APIs is now responsible of adding, removing and updating percentage sensors, by using the following functions:</p>
<dl>
<dt><a href="#clientapi-iowa_client_add_dimmer_object"><code>iowa_client_add_dimmer_object()</code></a></dt>
<dd>to add a new dimmer sensor.</dd>
<dt><a href="#clientapi-iowa_client_remove_dimmer_object"><code>iowa_client_remove_dimmer_object()</code></a></dt>
<dd>to remove a dimmer sensor.</dd>
<dt><a href="#clientapi-iowa_client_dimmer_update_value"><code>iowa_client_dimmer_update_value()</code></a></dt>
<dd>to update the dimmer's level value.</dd>
<dt><a href="#clientapi-iowa_client_dimmer_update_value"><code>iowa_client_dimmer_update_values()</code></a></dt>
<dd>to update the dimmer's multiple level values.</dd>
</dl>
<hr />
<h3 id="clientapi-iowa_client_ipso_update_value">iowa_client_IPSO_update_value</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_IPSO_update_value</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="kt">float</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_IPSO_update_value()</code> updates the value of an IPSO sensor.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>The ID of the sensor as returned by <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</dd>
<dt><em>value</em></dt>
<dd>The new value measured by the sensor.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>id</em> does not match any known sensor.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li>the sensor uses a Boolean value and <em>value</em> is neither 0.0 nor 1.0.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a percentage value and <em>value</em> is outside the [0.0, 100.0] range.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a compass direction value and <em>value</em> is outside the [0.0, 360.0] range.</li>
</ul>
</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation or a call to <a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>objects/iowa_ipso.h</p>
<hr />
<h3 id="clientapi-iowa_client_ipso_update_values">iowa_client_IPSO_update_values</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_IPSO_update_values</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">valueCount</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">iowa_ipso_timed_value_t</span><span class="w"> </span><span class="o">*</span><span class="n">valueArray</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_IPSO_update_values()</code> updates multiple times the value of an IPSO Object sensor.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>The ID of the sensor as returned by <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</dd>
<dt><em>valueCount</em></dt>
<dd>The number of values in <em>valueArray</em>.</dd>
<dt><em>valueArray</em></dt>
<dd>The <a href="#clientapi-iowa_ipso_timed_value_t"><code>iowa_ipso_timed_value_t</code></a> list of new values.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd><em>id</em> does not match any known sensor.</dd>
<dt>IOWA_COAP_406_NOT_ACCEPTABLE</dt>
<dd>either:</dd>
<dd>
<ul>
<li>one of the timestamped value has an negative value.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a Boolean value and <em>value</em> is neither 0.0 nor 1.0.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a percentage value and <em>value</em> is outside the [0.0, 100.0] range.</li>
</ul>
</dd>
<dd>
<ul>
<li>the sensor uses a compass direction value and <em>value</em> is outside the [0.0, 360.0] range.</li>
</ul>
</dd>
<dt>IOWA_COAP_500_INTERNAL_SERVER_ERROR</dt>
<dd>a memory allocation or a call to <a href="#abstractionlayer-iowa_system_gettime"><code>iowa_system_gettime()</code></a> failed.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>objects/iowa_ipso.h</p>
<p><strong>Notes</strong></p>
<p><code>iowa_client_IPSO_update_values()</code> can only be used when the define <a href="#configuration-lwm2m_support_timestamp"><strong>LWM2M_SUPPORT_TIMESTAMP</strong></a> is set.</p>
<p>The timestamp must be absolute and not relative to the current time, meaning negative values are not accepted. If the timestamp is equal to zero, it is ignored.</p>
<p>Calling <code>iowa_client_IPSO_update_values()</code> will overwrite the previous values list. This has multiple consequences:</p>
<ul>
<li>If the values have not been sent to the Server, the previous values are lost. Values are only sent if the Server do a Read operation or if the Server has set an Observation.</li>
<li>If the values are in the way to be sent to the Server and <code>iowa_client_IPSO_update_values()</code> is called during the process, some old values will be lost. This API is trying to send the values in best effort. Recent timestamped values are processed in priority before the oldest ones.</li>
</ul>
<p>Timestamp information is only present if the used Content Format is:</p>
<ul>
<li>JSON: <a href="#configuration-lwm2m_support_json"><code>LWM2M_SUPPORT_JSON</code></a></li>
<li>SenML JSON: <a href="#configuration-lwm2m_support_senml_json"><code>LWM2M_SUPPORT_SENML_JSON</code></a></li>
<li>SenML CBOR: <a href="#configuration-lwm2m_support_senml_cbor"><code>LWM2M_SUPPORT_SENML_CBOR</code></a></li>
</ul>
<hr />
<h3 id="clientapi-iowa_client_ipso_remove_sensor">iowa_client_IPSO_remove_sensor</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_client_IPSO_remove_sensor</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_client_IPSO_remove_sensor()</code> removes from the LwM2M Client an IPSO sensor created with <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>id</em></dt>
<dd>The ID of the sensor as returned by <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<dl>
<dt>IOWA_COAP_NO_ERROR</dt>
<dd>success.</dd>
<dt>IOWA_COAP_402_BAD_OPTION</dt>
<dd><em>id</em> is not an IPSO sensor. Valid <em>id</em> are only returned by <a href="#clientapi-iowa_client_IPSO_add_sensor"><code>iowa_client_IPSO_add_sensor()</code></a>.</dd>
<dt>IOWA_COAP_404_NOT_FOUND</dt>
<dd>IPSO referred by <strong>id</strong> does not exist.</dd>
</dl>
<p><strong>Header File</strong></p>
<p>objects/iowa_ipso.h</p></section><section class="print-page" id="empty"><blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="serverapi"><h1 id="serverapi-server-mode-api-reference">Server Mode API Reference</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="bootstrapserverapi"><h1 id="bootstrapserverapi-bootstrap-server-mode-api-reference">Bootstrap Server Mode API Reference</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="coapapi"><h1 id="coapapi-coap-api-reference">CoAP API Reference</h1>
<blockquote>
<p>This feature is present only in the <a href="https://ioterop.com/iowa/">IOWA Full SDK</a>.</p>
<p><a href="https://info.ioterop.com/contact-products">Contact us</a></p>
</blockquote></section><section class="print-page" id="utilsapi"><h1 id="utilsapi-utils-api-reference">Utils API Reference</h1>
<p>The functions explained below are defined inside the file <em>include/iowa_utils.h</em>.</p>
<h2 id="utilsapi-data-types">Data types</h2>
<h3 id="utilsapi-iowa_list_t">iowa_list_t</h3>
<p>List structure used by the List APIs.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span> <span class="nc">_iowa_list_t</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span> <span class="nc">_iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">nextP</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_list_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<dl>
<dt>nextP</dt>
<dd>Pointer to the next element in the list.</dd>
</dl>
<hr />
<h2 id="utilsapi-callbacks">Callbacks</h2>
<h3 id="utilsapi-iowa_list_node_free_callback_t">iowa_list_node_free_callback_t</h3>
<p>This is the list node free callback, called to free a node.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_list_node_free_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>nodeP</em></dt>
<dd>The node to free.</dd>
</dl>
<hr />
<h3 id="utilsapi-iowa_list_node_find_callback_t">iowa_list_node_find_callback_t</h3>
<p>This is the list node find callback, called to find a node.</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">bool</span><span class="p">(</span><span class="o">*</span><span class="n">iowa_list_node_find_callback_t</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">nodeP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                               </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">criteria</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<dl>
<dt><em>nodeP</em></dt>
<dd>The current node in the list.</dd>
<dt><em>criteria</em></dt>
<dd>The criteria to match.</dd>
</dl>
<hr />
<h2 id="utilsapi-api">API</h2>
<h3 id="utilsapi-iowa_utils_base64_get_encoded_size">iowa_utils_base64_get_encoded_size</h3>
<p><strong>Prototype</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_utils_base64_get_encoded_size</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">rawBufferLen</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<strong>Description</strong></p>
<p><code>iowa_utils_base64_get_encoded_size()</code> calculates the length of a Base64 buffer based on a raw buffer represented by its length.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>rawBufferLen</em></dt>
<dd>The length of the raw buffer.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The length of the Base64 buffer.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_base64_get_decoded_size">iowa_utils_base64_get_decoded_size</h3>
<p><strong>Prototype</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_utils_base64_get_decoded_size</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">base64Buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">base64BufferLen</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<strong>Description</strong></p>
<p><code>iowa_utils_base64_get_decoded_size()</code> calculates the length of a raw buffer based on a Base64 buffer.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>base64Buffer</em></dt>
<dd>The Base64 buffer.</dd>
<dt><em>base64BufferLen</em></dt>
<dd>The length of the Base64 buffer.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The length of the raw buffer. If any error the length will be 0.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_base64_encode">iowa_utils_base64_encode</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_utils_base64_encode</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rawBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">rawBufferLen</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">base64Buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">base64BufferLen</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_base64_encode()</code> encodes a raw buffer using Base64.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>rawBuffer</em></dt>
<dd>The raw buffer.</dd>
<dt><em>rawBufferLen</em></dt>
<dd>The length of the raw buffer.</dd>
<dt><em>base64Buffer</em></dt>
<dd>The preallocated Base64 buffer.</dd>
<dt><em>base64BufferLen</em></dt>
<dd>The length of the preallocated Base64 buffer.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The length of the encoded buffer. If any error the length will be 0.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_base64_decode">iowa_utils_base64_decode</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">size_t</span><span class="w"> </span><span class="nf">iowa_utils_base64_decode</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">base64Buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">base64BufferLen</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rawBuffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">rawBufferLen</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_base64_decode()</code> decodes a Base64 buffer into a raw buffer.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>base64Buffer</em></dt>
<dd>The Base64 buffer.</dd>
<dt><em>base64BufferLen</em></dt>
<dd>The length of the Base64 buffer.</dd>
<dt><em>rawBuffer</em></dt>
<dd>The preallocated raw buffer.</dd>
<dt><em>rawBufferLen</em></dt>
<dd>The length of the preallocated raw buffer.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The length of the decoded buffer. If any error the length will be 0.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<hr />
<h3 id="utilsapi-iowa_utils_uri_to_sensor">iowa_utils_uri_to_sensor</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="nf">iowa_utils_uri_to_sensor</span><span class="p">(</span><span class="n">iowa_lwm2m_uri_t</span><span class="w"> </span><span class="o">*</span><span class="n">uriP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_uri_to_sensor()</code> converts an iowa_lwm2m_uri_t into an iowa_sensor_t.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>uriP</em></dt>
<dd>Uri to convert.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The corresponding iowa_sensor_t or IOWA_INVALID_SENSOR_ID in case of error.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_sensor_to_uri">iowa_utils_sensor_to_uri</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_lwm2m_uri_t</span><span class="w"> </span><span class="nf">iowa_utils_sensor_to_uri</span><span class="p">(</span><span class="n">iowa_sensor_t</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_sensor_to_uri()</code> converts an iowa_sensor_t into an iowa_lwm2m_uri_t.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>id</em></dt>
<dd>Id to convert.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>An iowa_lwm2m_uri_t.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<hr />
<h3 id="utilsapi-iowa_utils_list_add">iowa_utils_list_add</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_utils_list_add</span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">headP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodeP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_list_add()</code> adds a node to a list.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>headP</em></dt>
<dd>Head of the current list.</dd>
<dt><em>nodeP</em></dt>
<dd>Node to add to the list.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The list with the new element.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_list_remove">iowa_utils_list_remove</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_utils_list_remove</span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">headP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodeP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_list_remove()</code> removes a node from a list.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>headP</em></dt>
<dd>Head of the current list.</dd>
<dt><em>nodeP</em></dt>
<dd>Node to remove from the list.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The updated list.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_list_free">iowa_utils_list_free</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_utils_list_free</span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">headP</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="n">iowa_list_node_free_callback_t</span><span class="w"> </span><span class="n">freeCb</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_list_free()</code> adds a node to a list.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>headP</em></dt>
<dd>List to free.</dd>
<dt><em>freeCb</em></dt>
<dd>Callback used to free the list.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_list_find">iowa_utils_list_find</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_utils_list_find</span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">headP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="n">iowa_list_node_find_callback_t</span><span class="w"> </span><span class="n">findCb</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">criteriaP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_list_find()</code> finds a node in a list.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>headP</em></dt>
<dd>List to search on.</dd>
<dt><em>findCb</em></dt>
<dd>Callback used to find the node in the list.</dd>
<dt><em>criteriaP</em></dt>
<dd>Criteria used to find the node in the list.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The node if found else NULL.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h3 id="utilsapi-iowa_utils_list_find_and_remove">iowa_utils_list_find_and_remove</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_utils_list_find_and_remove</span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="n">headP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                              </span><span class="n">iowa_list_node_find_callback_t</span><span class="w"> </span><span class="n">findCb</span><span class="p">,</span><span class="w"></span>
<span class="w">                                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">criteriaP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                              </span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">**</span><span class="n">nodeP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_utils_list_find_and_remove()</code> finds a node in a list and removes it.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>headP</em></dt>
<dd>List to search on.</dd>
<dt><em>findCb</em></dt>
<dd>Callback used to find the node in the list.</dd>
<dt><em>criteriaP</em></dt>
<dd>Criteria used to find the node in the list.</dd>
<dt><em>nodeP</em></dt>
<dd>OUT. Node removed from the list. Can be nil.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The updated list.</p>
<p><strong>Header File</strong></p>
<p>iowa_utils.h</p>
<hr />
<h2 id="utilsapi-example-linked-list-usage">Example: Linked List usage</h2>
<p>When declaring the linked list data structure, the first member <strong>must</strong> be a pointer. This pointer will contain the address of the next element of the list.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">myData</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span> <span class="nc">myData</span><span class="w"> </span><span class="o">*</span><span class="n">nextP</span><span class="p">;</span><span class="w">   </span><span class="c1">// Used by the linked list functions</span>
<span class="w">    </span><span class="kt">char</span><span class="w">          </span><span class="o">*</span><span class="n">aString</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">            </span><span class="n">anInt</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div></p>
<p>The head of the list is a pointer to your data structure.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">myData</span><span class="w"> </span><span class="o">*</span><span class="n">listHead</span><span class="p">;</span><span class="w"></span>
</code></pre></div></p>
<p>You can now add or remove elements to the list by using the functions <a href="#iowa_utils_list_add"><code>iowa_utils_list_add()</code></a> and <a href="#iowa_utils_list_remove"><code>iowa_utils_list_remove()</code></a>.</p>
<p>But to avoid compiler warnings or multiple cast making the code unreadable, the following macros can be used:</p>
<ul>
<li>IOWA_UTILS_LIST_ADD(H, N)</li>
<li>IOWA_UTILS_LIST_REMOVE(H, N)</li>
<li>IOWA_UTILS_LIST_FREE(H, F)</li>
<li>IOWA_UTILS_LIST_FIND(H, F, C)</li>
<li>IOWA_UTILS_LIST_FIND_AND_REMOVE(H, F, C, N)</li>
</ul>
<p>Instead of calling:</p>
<div class="highlight"><pre><span></span><code><span class="n">listHead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span> <span class="nc">myData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">iowa_utils_list_add</span><span class="p">((</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">listHead</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">iowa_list_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">newDataP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>You can use:</p>
<div class="highlight"><pre><span></span><code><span class="n">listHead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span> <span class="nc">myData</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">IOWA_UTILS_LIST_ADD</span><span class="p">(</span><span class="n">listHead</span><span class="p">,</span><span class="w"> </span><span class="n">newDataP</span><span class="p">);</span><span class="w"></span>
</code></pre></div></section><section class="print-page" id="securityapi"><h1 id="securityapi-security-implementation">Security Implementation</h1>
<h2 id="securityapi-abstraction-functions">Abstraction Functions</h2>
<h3 id="securityapi-iowa_user_security_create_client_session">iowa_user_security_create_client_session</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_user_security_create_client_session</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_create_client_session()</code> initializes implementation internals data of a new client-side security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to initialize.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<hr />
<h3 id="securityapi-iowa_user_security_create_server_session">iowa_user_security_create_server_session</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_user_security_create_server_session</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_create_server_session()</code> initializes implementation internals data of a new server-side security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to initialize.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<hr />
<h3 id="securityapi-iowa_user_security_delete_session">iowa_user_security_delete_session</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_user_security_delete_session</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_delete_session()</code> deletes the implementation internals data of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to delete data from.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<hr />
<h3 id="securityapi-iowa_user_security_handle_handshake_packet">iowa_user_security_handle_handshake_packet</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_user_security_handle_handshake_packet</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_handle_handshake_packet()</code> is called by IOWA when there is incoming data to read while the security session is in the <strong>SECURITY_STATE_HANDSHAKING</strong> state.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session receiving data.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<hr />
<h3 id="securityapi-iowa_user_security_step">iowa_user_security_step</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_user_security_step</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_step()</code> performs the required operations on the security session: updating state, handling timeouts, etc...</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to update.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<p><strong>Notes</strong></p>
<p>This function should update the IOWA context global timeout. See <a href="#securityapi-iowa_security_session_set_step_delay"><code>iowa_security_session_set_step_delay()</code></a>.</p>
<hr />
<h3 id="securityapi-iowa_user_security_send">iowa_user_security_send</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_user_security_send</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_send()</code> encrypts and sends data on a connected security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to send data on.</dd>
<dt><em>buffer</em></dt>
<dd>The data to send.</dd>
<dt><em>length</em></dt>
<dd>The length of the data in bytes.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of bytes sent or a negative number in case of error.</p>
<hr />
<h3 id="securityapi-iowa_user_security_recv">iowa_user_security_recv</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_user_security_recv</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_recv()</code> reads and decrypts data received on a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to receives data from.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the decrypted data.</dd>
<dt><em>length</em></dt>
<dd>The length of the buffer in bytes.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of received bytes or a negative number in case of error.</p>
<hr />
<h3 id="securityapi-iowa_user_security_disconnect">iowa_user_security_disconnect</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_user_security_disconnect</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_disconnect()</code> disconnects a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session to disconnect.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<hr />
<h3 id="securityapi-iowa_user_security_hkdf">iowa_user_security_HKDF</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"> </span><span class="nf">iowa_user_security_HKDF</span><span class="p">(</span><span class="n">iowa_security_hash_t</span><span class="w"> </span><span class="n">hash</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">IKM</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">IKMLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">salt</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">saltLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">infoLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">OKM</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">OKMLength</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_HKDF()</code> derives a new security key using HMAC-based Extract-and-Expand Key Derivation Function from <a href="https://tools.ietf.org/html/rfc5869">RFC 5869</a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>hash</em></dt>
<dd>The hash algorithm to use.</dd>
<dt><em>IKM</em></dt>
<dd>The input keying material.</dd>
<dt><em>IKMLength</em></dt>
<dd>The length in bytes of <em>IKM</em>.</dd>
<dt><em>salt</em></dt>
<dd>The salt value. This may be nil.</dd>
<dt><em>saltLength</em></dt>
<dd>The length in bytes of <em>salt</em>. This may be 0.</dd>
<dt><em>info</em></dt>
<dd>The context and application specific information. This may be nil.</dd>
<dt><em>infoLength</em></dt>
<dd>The length in bytes of <em>info</em>. This may be 0.</dd>
<dt><em>OKM</em></dt>
<dd>The buffer to store the compted output keying material.</dd>
<dt><em>OKMLength</em></dt>
<dd>The length in bytes of <em>OKM</em>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<hr />
<h3 id="securityapi-iowa_user_security_aead_encrypt">iowa_user_security_AEAD_encrypt</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">iowa_user_security_AEAD_encrypt</span><span class="p">(</span><span class="n">iowa_security_aead_t</span><span class="w"> </span><span class="n">aead</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">keyLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nonceLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">aad</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">aadLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">plainData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">plainDataLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">encryptedData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">encryptedDataLengthP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">tag</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">tagLength</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_AEAD_encrypt()</code> encrypts data.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>aead</em></dt>
<dd>The AEAD algorithm to use.</dd>
<dt><em>key</em></dt>
<dd>The key to use to encrypt.</dd>
<dt><em>keyLength</em></dt>
<dd>The length in bytes of <em>key</em>.</dd>
<dt><em>nonce</em></dt>
<dd>The nonce to use. This may be nil.</dd>
<dt><em>nonceLength</em></dt>
<dd>The length in bytes of <em>nonce</em>. This may be 0.</dd>
<dt><em>aad</em></dt>
<dd>The additional data to authenticate. This may be nil.</dd>
<dt><em>aadLength</em></dt>
<dd>The length in bytes of <em>aad</em>. This may be 0.</dd>
<dt><em>plainData</em></dt>
<dd>The data to encrypt.</dd>
<dt><em>plainDataLength</em></dt>
<dd>The length in bytes of <em>plainData</em>.</dd>
<dt><em>encryptedData</em></dt>
<dd>The buffer to store the encrypted data.</dd>
<dt><em>encryptedDataLengthP</em></dt>
<dd>IN/OUT. The length in bytes of <em>encryptedData</em>. This may be modified by <code>iowa_user_security_AEAD_encrypt()</code>.</dd>
<dt><em>tag</em></dt>
<dd>A buffer to store the authentication tag. This may be nil.</dd>
<dt><em>tagLength</em></dt>
<dd>The length in bytes of <em>tag</em>. This may be 0.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<hr />
<h3 id="securityapi-iowa_user_security_aead_decrypt">iowa_user_security_AEAD_decrypt</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_status_t</span><span class="w"></span>
<span class="w">    </span><span class="nf">iowa_user_security_AEAD_decrypt</span><span class="p">(</span><span class="n">iowa_security_aead_t</span><span class="w"> </span><span class="n">aead</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">keyLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nonceLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">aad</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">aadLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">tagLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">encryptedData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">encryptedDataLength</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">plainData</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">plainDataLengthP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_user_security_AEAD_decrypt()</code> decrypts data.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>aead</em></dt>
<dd>The AEAD algorithm to use.</dd>
<dt><em>key</em></dt>
<dd>The key to use to encrypt.</dd>
<dt><em>keyLength</em></dt>
<dd>The length in bytes of <em>key</em>.</dd>
<dt><em>nonce</em></dt>
<dd>The nonce to use. This may be nil.</dd>
<dt><em>nonceLength</em></dt>
<dd>The length in bytes of <em>nonce</em>. This may be 0.</dd>
<dt><em>aad</em></dt>
<dd>The additional data to authenticate. This may be nil.</dd>
<dt><em>aadLength</em></dt>
<dd>The length in bytes of <em>aad</em>. This may be 0.</dd>
<dt><em>tag</em></dt>
<dd>The authentication tag. This may be nil.</dd>
<dt><em>tagLength</em></dt>
<dd>The length in bytes of <em>tag</em>. This may be 0.</dd>
<dt><em>encryptedData</em></dt>
<dd>The data to decrypt.</dd>
<dt><em>encryptedDataLength</em></dt>
<dd>The length in bytes of <em>encryptedData</em>.</dd>
<dt><em>plainData</em></dt>
<dd>The buffer to store the decrypted data.</dd>
<dt><em>plainDataLengthP</em></dt>
<dd>IN/OUT. The length in bytes of <em>plainData</em>. This may be modified by <code>iowa_user_security_AEAD_decrypt()</code>.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p><strong>IOWA_COAP_NO_ERROR</strong> in case of success or an error status.</p>
<h2 id="securityapi-data-types">Data types</h2>
<h3 id="securityapi-iowa_security_session_t">iowa_security_session_t</h3>
<p>This type is used to store the session of the IOWA security stack engine. Multiple sessions can exist at the same time. This can be treated as an opaque type and be used through the helper functions below.</p>
<h3 id="securityapi-iowa_security_mode_t">iowa_security_mode_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_security_mode_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible security mode for the Security layer. The following values are defined:</p>
<dl>
<dt>IOWA_SEC_PRE_SHARED_KEY</dt>
<dd>Use the Pre-Shared Key mode of the security layer.</dd>
<dt>IOWA_SEC_RAW_PUBLIC_KEY</dt>
<dd>Use the Private/Public Key mode of the security layer.</dd>
<dt>IOWA_SEC_CERTIFICATE</dt>
<dd>Use the X.509 Certificate mode of the security layer.</dd>
<dt>IOWA_SEC_NONE</dt>
<dd>The security layer is not involved in the communication with this peer.</dd>
<dt>IOWA_SEC_CERTIFICATE_WITH_EST</dt>
<dd>Use the X.509 Certificate with EST mode of the security layer.</dd>
<dt>IOWA_SEC_OSCORE</dt>
<dd>Use the OSCORE security of the CoAP layer. This value can be used as a flag to be combined with the other values, e.g. <code>IOWA_SEC_PRE_SHARED_KEY | IOWA_SEC_OSCORE</code>.</dd>
</dl>
<h3 id="securityapi-iowa_cert_usage_mode_t">iowa_cert_usage_mode_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iowa_cert_usage_mode_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible semantic of the certificate or raw public key, which is used to match the certificate presented in the TLS/DTLS handshake. It is used by the Security layer when the security is <strong>IOWA_SEC_RAW_PUBLIC_KEY</strong>, <strong>IOWA_SEC_CERTIFICATE</strong>, or <strong>IOWA_SEC_CERTIFICATE_WITH_EST</strong>. The following values are defined:</p>
<dl>
<dt>IOWA_CERTIFICATE_USAGE_CA_CONSTRAINT</dt>
<dd>CA constraint.</dd>
<dt>IOWA_CERTIFICATE_USAGE_SERVICE_CERTIFICATE_CONSTRAINT</dt>
<dd>Service certificate constraint.</dd>
<dt>IOWA_CERTIFICATE_USAGE_TRUST_ANCHOR_ASSERTION</dt>
<dd>Trust anchor assertion.</dd>
<dt>IOWA_CERTIFICATE_USAGE_DOMAIN_ISSUED_CERTIFICATE</dt>
<dd>Domain-issued certificate.</dd>
</dl>
<h3 id="securityapi-iowa_security_state_t">iowa_security_state_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_DISCONNECTED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_DISCONNECTING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_INIT_HANDSHAKE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_HANDSHAKING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_HANDSHAKE_DONE</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_CONNECTED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_CONNECTION_FAILING</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_STATE_CONNECTION_FAILED</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_state_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This reflects the state of the security session. It is an enumeration of the following values:</p>
<dl>
<dt>SECURITY_STATE_DISCONNECTED</dt>
<dd>The security session is disconnected.</dd>
<dt>SECURITY_STATE_DISCONNECTING</dt>
<dd>The security session is currently disconnecting.</dd>
<dt>SECURITY_STATE_INIT_HANDSHAKE</dt>
<dd>The security session is starting the handshake with the peer.</dd>
<dt>SECURITY_STATE_HANDSHAKING</dt>
<dd>The security session is in the middle of the handshake with the peer.</dd>
<dt>SECURITY_STATE_HANDSHAKE_DONE</dt>
<dd>The handshake with the peer is done.</dd>
<dt>SECURITY_STATE_CONNECTED</dt>
<dd>The security session is connected to the peer.</dd>
<dt>SECURITY_STATE_CONNECTION_FAILING</dt>
<dd>An error occurred during the security session connection to the peer.</dd>
<dt>SECURITY_STATE_CONNECTION_FAILED</dt>
<dd>The security session failed to connect to the peer.</dd>
</dl>
<h3 id="securityapi-iowa_security_event_t">iowa_security_event_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_EVENT_UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_EVENT_DISCONNECTED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_EVENT_CONNECTED</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_EVENT_DATA_AVAILABLE</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_event_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible events to report to the upper layers. It is an enumeration of the following values:</p>
<dl>
<dt>SECURITY_EVENT_UNDEFINED</dt>
<dd>No specific event. This should never be used and only serves as a non default event.</dd>
<dt>SECURITY_EVENT_DISCONNECTED</dt>
<dd>The security session disconnected.</dd>
<dt>SECURITY_EVENT_CONNECTED</dt>
<dd>The security session is now connected.</dd>
<dt>SECURITY_EVENT_DATA_AVAILABLE</dt>
<dd>Decrypted data are available to read on the security session.</dd>
</dl>
<h3 id="securityapi-iowa_security_hash_t">iowa_security_hash_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_HMAC_UNDEFINED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_HMAC_SHA256_64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_HMAC_SHA256</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_HMAC_SHA384</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_HMAC_SHA512</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_hash_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible HMAC algorithms used by OSCORE. See table 7 of <a href="https://tools.ietf.org/html/rfc8152">RFC 8152</a>.</p>
<dl>
<dt>SECURITY_HMAC_UNDEFINED</dt>
<dd>No specific algorithm. This should never be used and only serves as a non default value.</dd>
<dt>SECURITY_HMAC_SHA256_64</dt>
<dd>HMAC with SHA-256 truncated to 64 bits.</dd>
<dt>SECURITY_HMAC_SHA256</dt>
<dd>HMAC with SHA-256.</dd>
<dt>SECURITY_HMAC_SHA384</dt>
<dd>HMAC with SHA-384.</dd>
<dt>SECURITY_HMAC_SHA512</dt>
<dd>HMAC with SHA-512.</dd>
</dl>
<h3 id="securityapi-iowa_security_aead_t">iowa_security_aead_t</h3>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_UNDEFINED</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_16_64_128</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_16_64_256</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_64_64_128</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_64_64_256</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_16_128_128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_16_128_256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_64_128_128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">SECURITY_AEAD_AES_CCM_64_128_256</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">33</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">iowa_security_aead_t</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This contains the possible AEAD algorithms used by OSCORE. See table 10 of <a href="https://tools.ietf.org/html/rfc8152">RFC 8152</a>.</p>
<dl>
<dt>SECURITY_AEAD_UNDEFINED</dt>
<dd>No specific algorithm. This should never be used and only serves as a non default value.</dd>
<dt>SECURITY_AEAD_AES_CCM_16_64_128</dt>
<dd>AES-CCM mode 128-bit key, 64-bit tag, 13-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_16_64_256</dt>
<dd>AES-CCM mode 256-bit key, 64-bit tag, 13-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_64_64_128</dt>
<dd>AES-CCM mode 128-bit key, 64-bit tag, 7-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_64_64_256</dt>
<dd>AES-CCM mode 256-bit key, 64-bit tag, 7-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_16_128_128</dt>
<dd>AES-CCM mode 128-bit key, 128-bit tag, 13-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_16_128_256</dt>
<dd>AES-CCM mode 256-bit key, 128-bit tag, 13-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_64_128_128</dt>
<dd>AES-CCM mode 128-bit key, 128-bit tag, 7-byte nonce.</dd>
<dt>SECURITY_AEAD_AES_CCM_64_128_256</dt>
<dd>AES-CCM mode 256-bit key, 128-bit tag, 7-byte nonce.</dd>
</dl>
<hr />
<h2 id="securityapi-helper-functions">Helper Functions</h2>
<h3 id="securityapi-iowa_security_session_set_user_internals">iowa_security_session_set_user_internals</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_security_session_set_user_internals</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                              </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">internalsP</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_set_user_internals()</code> stores opaque data in a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session where to store the opaque data.</dd>
<dt><em>internalsP</em></dt>
<dd>A pointer to the opaque data to store.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_user_internals">iowa_security_session_get_user_internals</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_security_session_get_user_internals</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_user_internals()</code> retrieves the opaque data stored in a security session with <a href="#securityapi-iowa_security_session_set_user_internals"><code>iowa_security_session_set_user_internals()</code></a>.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to the security session where to store the opaque data.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>A pointer to the stored opaque data.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_state">iowa_security_session_get_state</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_security_state_t</span><span class="w"></span>
<span class="nf">iowa_security_session_get_state</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_state()</code> retrieves the state of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The state of the security session.</p>
<hr />
<h3 id="securityapi-iowa_security_session_set_state">iowa_security_session_set_state</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_security_session_set_state</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">iowa_security_state_t</span><span class="w"> </span><span class="n">state</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_set_state()</code> sets the state of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
<dt><em>state</em></dt>
<dd>The new state of the security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<hr />
<h3 id="securityapi-iowa_security_get_server_session">iowa_security_get_server_session</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="nf">iowa_security_get_server_session</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">shortServerId</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_get_server_session()</code> retrieves the security session associated to a Server.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>shortServerId</em></dt>
<dd>The Short ID assigned to the server.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The security session if found, otherwise NULL.</p>
<hr />
<h3 id="securityapi-iowa_security_get_client_session">iowa_security_get_client_session</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="nf">iowa_security_get_client_session</span><span class="p">(</span><span class="n">iowa_context_t</span><span class="w"> </span><span class="n">contextP</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                         </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">clientId</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_get_client_session()</code> retrieves the security session associated to a Client.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>contextP</em></dt>
<dd>An <a href="#commonapi-iowa_context_t"><code>iowa_context_t</code></a> as returned by <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>. Not checked at runtime.</dd>
<dt><em>clientId</em></dt>
<dd>The ID assigned to the Client.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The security session if found, otherwise NULL.</p>
<hr />
<h3 id="securityapi-iowa_security_session_generate_event">iowa_security_session_generate_event</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_security_session_generate_event</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">iowa_security_event_t</span><span class="w"> </span><span class="n">event</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_generate_event()</code> calls the event callback of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
<dt><em>event</em></dt>
<dd>The event to be passed as parameter to the event callback.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_connection_type">iowa_security_session_get_connection_type</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_connection_type_t</span><span class="w"></span>
<span class="nf">iowa_security_session_get_connection_type</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_connection_type()</code> retrieves the type of the underlying connection of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The type of the underlying connection as an <a href="#abstractionlayer-iowa_connection_type_t"><code>iowa_connection_type_t</code></a>.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_connection">iowa_security_session_get_connection</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_security_session_get_connection</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_connection()</code> retrieves the underlying connection of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The underlying connection as returned by <a href="#abstractionlayer-iowa_system_connection_open"><code>iowa_system_connection_open()</code></a>.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_security_mode">iowa_security_session_get_security_mode</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_security_mode_t</span><span class="w"></span>
<span class="nf">iowa_security_session_get_security_mode</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_security_mode()</code> retrieves the security mode of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The security mode as an <a href="#securityapi-iowa_security_mode_t"><code>iowa_security_mode_t</code></a>.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_uri">iowa_security_session_get_uri</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_security_session_get_uri</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_uri()</code> retrieves the URI of the peer of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The URI of the peer.</p>
<hr />
<h3 id="securityapi-iowa_security_session_set_step_delay">iowa_security_session_set_step_delay</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">iowa_security_session_set_step_delay</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">delay</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_set_step_delay()</code> sets the delay before the next scheduled operation on a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
<dt><em>securityS</em></dt>
<dd>the time in seconds before <a href="#securityapi-iowa_user_security_step"><code>iowa_user_security_step()</code></a> needs to be call again for this security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>None.</p>
<p><strong>Notes</strong></p>
<p>If <em>delay</em> is a negative number, it is ignored.</p>
<p>As IOWA maintains only one global delay, <a href="#securityapi-iowa_user_security_step"><code>iowa_user_security_step()</code></a> may be called before the delay expires. The delay must be updated at each call.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_context">iowa_security_session_get_context</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">iowa_context_t</span><span class="w"> </span><span class="nf">iowa_security_session_get_context</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_context()</code> retrieves the IOWA context in which a security session exists.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The IOWA context.</p>
<hr />
<h3 id="securityapi-iowa_security_session_get_context_user_data">iowa_security_session_get_context_user_data</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">iowa_security_session_get_context_user_data</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_session_get_context_user_data()</code> retrieves the pointer to application-specific data of the IOWA context in which a security session exists.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The pointer to application-specific data as passed to <a href="#commonapi-iowa_init"><code>iowa_init()</code></a>.</p>
<hr />
<h3 id="securityapi-iowa_security_connection_send">iowa_security_connection_send</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_security_connection_send</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_connection_send()</code> sends data on the underlying connection of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
<dt><em>buffer</em></dt>
<dd>The data to send.</dd>
<dt><em>length</em></dt>
<dd>The length of the data in bytes.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of bytes sent or a negative number in case of error.</p>
<hr />
<h3 id="securityapi-iowa_security_connection_recv">iowa_security_connection_recv</h3>
<p><strong>Prototype</strong></p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">iowa_security_connection_recv</span><span class="p">(</span><span class="n">iowa_security_session_t</span><span class="w"> </span><span class="n">securityS</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>Description</strong></p>
<p><code>iowa_security_connection_recv()</code> reads data on the underlying connection of a security session.</p>
<p><strong>Arguments</strong></p>
<dl>
<dt><em>securityS</em></dt>
<dd>An iowa_security_session_t pointing to a security session.</dd>
<dt><em>buffer</em></dt>
<dd>A buffer to store the received data.</dd>
<dt><em>length</em></dt>
<dd>The number of bytes to read.</dd>
</dl>
<p><strong>Return Value</strong></p>
<p>The number of bytes read or a negative number in case of error.</p></section><h1 class='nav-section-title-end'>Ended: API Reference</h1>
                        <h1 class='nav-section-title' id='section-licenses'>
                            Licenses <a class='headerlink' href='#section-licenses' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="license"><h1 id="license-iowa-license">IOWA License</h1>
<p>Any user of the software is presumed to have read his license before using it and to have accepted its terms. By using this software, you acknowledge that you are fully aware that its use is strictly regulated by the license agreement to which it is subject by SAS IOTEROP.</p>
<p>The license associated with this version of the software is an evaluation license allowing only internal exploration and prototyping. Any commercial use of the software is strictly subject to the prior obtaining of a different and specific license (commercial license), the terms and conditions of which are defined by SAS IOTEROP. Any use of the software not expressly authorized by SAS IOTEROP may constitute a counterfeit punishable under French and international laws directly engaging the responsibility of its author (Article L335-3 of the French Intellectual Property Code - Berne Convention).</p></section><section class="print-page" id="opensourcelicenses"><h1 id="opensourcelicenses-open-source-licenses">Open Source Licenses</h1>
<p>IOWA reuses code from various open source projects.</p>
<ul>
<li>wakaama is copyrighted by Intel Corporation and others and reused under the Eclipse Distribution License 1.0.</li>
</ul>
<blockquote>
<p>Copyright (c) 2013, 2014 Intel Corporation</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of Intel Corporation nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p><em>Eclipse Distribution License - v 1.0</em></p>
<p>Copyright (c) 2007, Eclipse Foundation, Inc. and its licensors.</p>
<p>All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the Eclipse Foundation, Inc. nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</blockquote>
<ul>
<li>
<p>mbed TLS is copyrighted by ARM Limited under the Apache License, Version 2.0.</p>
</li>
<li>
<p>tinydtls is copyrighted by Olaf Bergmann and others and reused under the Eclipse Distribution License 1.0.</p>
</li>
</ul>
<blockquote>
<p>Copyright (c) 2011, 2012, 2013, 2014, 2015, 2016 Olaf Bergmann (TZI) and others.
All rights reserved. This program and the accompanying materials are made available under the terms of the Eclipse Public License v1.0 and Eclipse Distribution License v. 1.0 which accompanies this distribution.
The Eclipse Public License is available at <a href="http://www.eclipse.org/legal/epl-v10.html">http://www.eclipse.org/legal/epl-v10.html</a> and the Eclipse Distribution License is available at <a href="http://www.eclipse.org/org/documents/edl-v10.php">http://www.eclipse.org/org/documents/edl-v10.php</a>.</p>
<p>Contributors:
  *    Olaf Bergmann  - initial API and implementation
  *    Hauke Mehrtens - memory optimization, ECC integration
</p>
</blockquote>
<ul>
<li>OMA LwM2M objects are copyrighted by Open Mobile Alliance.</li>
</ul>
<blockquote>
<p>Copyright 2017 Open Mobile Alliance All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>The above license is used as a license under copyright only. Please reference the OMA IPR Policy for patent licensing terms: <a href="http://www.openmobilealliance.org/ipr.html">http://www.openmobilealliance.org/ipr.html</a></p>
</blockquote>
<ul>
<li>AT Command LwM2M object is copyrighted by Cisco.</li>
</ul>
<blockquote>
<p>BSD 3-Clause License</p>
<p>Copyright (c) 2017, Cisco
All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</blockquote></section><h1 class='nav-section-title-end'>Ended: Licenses</h1></div>

              

            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020-2022 IoTerop
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://ioterop.com/" target="_blank" rel="noopener" title="Website" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"/></svg>
    </a>
  
    
    
    <a href="https://github.com/IOTEROP" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    <a href="https://twitter.com/ioteropcompany" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "/", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.ca141e46.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.6baa0517.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
    
  </body>
</html>